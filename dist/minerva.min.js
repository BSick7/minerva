function radToDegrees(a){return 180*a/Math.PI}var minerva;!function(a){a.version="0.4.10"}(minerva||(minerva={}));var minerva;!function(a){!function(a){a[a.Left=0]="Left",a[a.Center=1]="Center",a[a.Right=2]="Right",a[a.Stretch=3]="Stretch"}(a.HorizontalAlignment||(a.HorizontalAlignment={}));a.HorizontalAlignment;!function(a){a[a.Top=0]="Top",a[a.Center=1]="Center",a[a.Bottom=2]="Bottom",a[a.Stretch=3]="Stretch"}(a.VerticalAlignment||(a.VerticalAlignment={}));a.VerticalAlignment}(minerva||(minerva={}));var minerva;!function(a){var b=function(){function a(a,b,c,d){this.topLeft=null==a?0:a,this.topRight=null==b?0:b,this.bottomRight=null==c?0:c,this.bottomLeft=null==d?0:d}return a.isEmpty=function(a){return 0===a.topLeft&&0===a.topRight&&0===a.bottomRight&&0===a.bottomLeft},a.isEqual=function(a,b){return a.topLeft===b.topLeft&&a.topRight===b.topRight&&a.bottomRight===b.bottomRight&&a.bottomLeft===b.bottomLeft},a.clear=function(a){a.topLeft=a.topRight=a.bottomRight=a.bottomLeft=0},a.copyTo=function(a,b){b.topLeft=a.topLeft,b.topRight=a.topRight,b.bottomRight=a.bottomRight,b.bottomLeft=a.bottomLeft},a}();a.CornerRadius=b}(minerva||(minerva={}));var minerva;!function(a){!function(a){a[a.Horizontal=0]="Horizontal",a[a.Vertical=1]="Vertical"}(a.Orientation||(a.Orientation={}));a.Orientation;!function(a){a[a.Miter=0]="Miter",a[a.Bevel=1]="Bevel",a[a.Round=2]="Round"}(a.PenLineJoin||(a.PenLineJoin={}));a.PenLineJoin;!function(a){a[a.Flat=0]="Flat",a[a.Square=1]="Square",a[a.Round=2]="Round",a[a.Triangle=3]="Triangle"}(a.PenLineCap||(a.PenLineCap={}));a.PenLineCap;!function(a){a[a.EvenOdd=0]="EvenOdd",a[a.NonZero=1]="NonZero"}(a.FillRule||(a.FillRule={}));a.FillRule;!function(a){a[a.None=0]="None",a[a.Fill=1]="Fill",a[a.Uniform=2]="Uniform",a[a.UniformToFill=3]="UniformToFill"}(a.Stretch||(a.Stretch={}));a.Stretch;!function(a){a[a.LeftToRight=0]="LeftToRight",a[a.RightToLeft=1]="RightToLeft"}(a.FlowDirection||(a.FlowDirection={}));a.FlowDirection;!function(a){a[a.MaxHeight=0]="MaxHeight",a[a.BlockLineHeight=1]="BlockLineHeight"}(a.LineStackingStrategy||(a.LineStackingStrategy={}));a.LineStackingStrategy;!function(a){a[a.Left=0]="Left",a[a.Center=1]="Center",a[a.Right=2]="Right",a[a.Justify=3]="Justify"}(a.TextAlignment||(a.TextAlignment={}));a.TextAlignment;!function(a){a[a.None=0]="None"}(a.TextTrimming||(a.TextTrimming={}));a.TextTrimming;!function(a){a[a.NoWrap=0]="NoWrap",a[a.Wrap=1]="Wrap",a[a.WrapWithOverflow=2]="WrapWithOverflow"}(a.TextWrapping||(a.TextWrapping={}));a.TextWrapping;!function(a){a[a.None=0]="None",a[a.Underline=1]="Underline"}(a.TextDecorations||(a.TextDecorations={}));a.TextDecorations;!function(a){a[a.Thin=100]="Thin",a[a.ExtraLight=200]="ExtraLight",a[a.Light=300]="Light",a[a.Normal=400]="Normal",a[a.Medium=500]="Medium",a[a.SemiBold=600]="SemiBold",a[a.Bold=700]="Bold",a[a.ExtraBold=800]="ExtraBold",a[a.Black=900]="Black",a[a.ExtraBlack=950]="ExtraBlack"}(a.FontWeight||(a.FontWeight={}));a.FontWeight;!function(a){a[a.Counterclockwise=0]="Counterclockwise",a[a.Clockwise=1]="Clockwise"}(a.SweepDirection||(a.SweepDirection={}));a.SweepDirection}(minerva||(minerva={}));var minerva;!function(a){!function(a){a[a.Transform=1]="Transform",a[a.LocalTransform=2]="LocalTransform",a[a.Clip=8]="Clip",a[a.LocalClip=16]="LocalClip",a[a.LayoutClip=32]="LayoutClip",a[a.RenderVisibility=64]="RenderVisibility",a[a.HitTestVisibility=128]="HitTestVisibility",a[a.ImageMetrics=256]="ImageMetrics",a[a.Measure=512]="Measure",a[a.Arrange=1024]="Arrange",a[a.Bounds=1048576]="Bounds",a[a.NewBounds=2097152]="NewBounds",a[a.Invalidate=4194304]="Invalidate",a[a.InUpDirtyList=1073741824]="InUpDirtyList",a[a.InDownDirtyList=-2147483648]="InDownDirtyList",a[a.DownDirtyState=507]="DownDirtyState",a[a.UpDirtyState=7340032]="UpDirtyState",a[a.PropagateDown=225]="PropagateDown"}(a.DirtyFlags||(a.DirtyFlags={}));a.DirtyFlags;!function(a){a[a.None=0]="None",a[a.RenderVisible=2]="RenderVisible",a[a.HitTestVisible=4]="HitTestVisible",a[a.TotalRenderVisible=8]="TotalRenderVisible",a[a.TotalHitTestVisible=16]="TotalHitTestVisible",a[a.MeasureHint=2048]="MeasureHint",a[a.ArrangeHint=4096]="ArrangeHint",a[a.SizeHint=8192]="SizeHint",a[a.Hints=14336]="Hints"}(a.UIFlags||(a.UIFlags={}));a.UIFlags;!function(a){a[a.None=0]="None",a[a.Empty=1]="Empty",a[a.Normal=2]="Normal",a[a.Degenerate=4]="Degenerate",a[a.Radii=8]="Radii"}(a.ShapeFlags||(a.ShapeFlags={}));a.ShapeFlags}(minerva||(minerva={}));var minerva;!function(a){function b(a){var b="";return b+=a.style.toString()+" ",b+="normal ",b+=a.weight.toString()+" ",b+=a.size+"px ",b+=a.family.toString()}a.FontStyle={Normal:"normal",Italic:"italic",Oblique:"oblique"},a.FontStretch={UltraCondensed:"ultra-condensed",ExtraCondensed:"extra-condensed",Condensed:"condensed",SemiCondensed:"semi-condensed",Normal:"normal",SemiExpanded:"semi-expanded",Expanded:"expanded",ExtraExpanded:"extra-expanded",UltraExpanded:"ultra-expanded"};var c=function(){function c(){this.family=c.DEFAULT_FAMILY,this.size=c.DEFAULT_SIZE,this.stretch=c.DEFAULT_STRETCH,this.style=c.DEFAULT_STYLE,this.weight=c.DEFAULT_WEIGHT,this.$$cachedObj=null,this.$$cachedHeight=null}return c.mergeInto=function(a,b,c,d,e,f){var g=a.family!==b||a.size!==c||a.stretch!==d||a.style!==e||a.weight!==f;return a.family=b,a.size=c,a.stretch=d,a.style=e,a.weight=f,g&&(a.$$cachedObj=null,a.$$cachedHeight=null),g},c.prototype.toHtml5Object=function(){return this.$$cachedObj=this.$$cachedObj||b(this)},c.prototype.getHeight=function(){return null==this.$$cachedHeight&&(this.$$cachedHeight=a.fontHeight.get(this)),this.$$cachedHeight},c.prototype.getAscender=function(){return 0},c.prototype.getDescender=function(){return 0},c.DEFAULT_FAMILY="Segoe UI, Lucida Grande, Verdana",c.DEFAULT_STRETCH=a.FontStretch.Normal,c.DEFAULT_STYLE=a.FontStyle.Normal,c.DEFAULT_WEIGHT=a.FontWeight.Normal,c.DEFAULT_SIZE=14,c}();a.Font=c}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){function b(b){var e=b.toHtml5Object(),f=d[e];return null==f?(d[e]=f=c(e),a.cache.misses++):a.cache.hits++,f}function c(a){perfex.timer.start("MeasureFontHeight",a),e||(e=document.createElement("div"),e.appendChild(document.createTextNode("M")),document.body.appendChild(e)),e.style.display="",e.style.font=a;var b=e.offsetHeight;return e.style.display="none",perfex.timer.stop(),b}var d=[];a.cache={hits:0,misses:0},a.get=b;var e}(b=a.fontHeight||(a.fontHeight={}))}(minerva||(minerva={}));var minerva;!function(a){var b=function(){function a(a){this.raw=a}return a.prototype.isTransparent=function(){return!1},a.prototype.setupBrush=function(a,b){},a.prototype.toHtml5Object=function(){return this.raw},a}();a.FakeBrush=b}(minerva||(minerva={}));var minerva;!function(a){a.NO_SIZE_UPDATER={setActualWidth:function(a){},setActualHeight:function(a){},onSizeChanged:function(a,b){}}}(minerva||(minerva={}));var minerva;!function(a){!function(a){a[a.Forward=0]="Forward",a[a.Reverse=1]="Reverse",a[a.ZForward=2]="ZForward",a[a.ZReverse=3]="ZReverse"}(a.WalkDirection||(a.WalkDirection={}));a.WalkDirection}(minerva||(minerva={}));var minerva;!function(a){var b=function(){function a(a,b){this.x=null==a?0:a,this.y=null==b?0:b}return a.isEqual=function(a,b){return a.x===b.x&&a.y===b.y},a.copyTo=function(a,b){b.x=a.x,b.y=a.y},a}();a.Point=b}(minerva||(minerva={}));var minerva;!function(a){var b;b="undefined"!=typeof Float32Array?function(a){return new Float32Array(a)}:function(a){return new Array(a)},a.vec2={create:function(a,c){var d=b(2);return d[0]=a,d[1]=c,d},init:function(a,c,d){return d||(d=b(2)),d[0]=a,d[1]=c,d}}}(minerva||(minerva={}));var vec2=minerva.vec2,minerva;!function(a){!function(a){a[a.Out=0]="Out",a[a.In=1]="In",a[a.Part=2]="Part"}(a.RectOverlap||(a.RectOverlap={}));var b=a.RectOverlap,c=a.vec2.create(0,0),d=a.vec2.create(0,0),e=a.vec2.create(0,0),f=a.vec2.create(0,0),g=function(){function g(a,b,c,d){this.x=null==a?0:a,this.y=null==b?0:b,this.width=null==c?0:c,this.height=null==d?0:d}return g.getBottom=function(a){return a.y+a.height},g.getRight=function(a){return a.x+a.width},g.isEqual=function(a,b){return a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height},g.isEmpty=function(a){return 0===a.width||0===a.height},g.copyTo=function(a,b){b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},g.roundOut=function(a){var b=Math.floor(a.x),c=Math.floor(a.y);a.width=Math.ceil(a.x+a.width)-b,a.height=Math.ceil(a.y+a.height)-c,a.x=b,a.y=c},g.roundIn=function(a){var b=Math.ceil(a.x),c=Math.ceil(a.y);return a.width=Math.floor(a.x+a.width)-Math.ceil(a.x),a.height=Math.floor(a.y+a.height)-Math.ceil(a.y),a.x=b,a.y=c,a},g.intersection=function(a,b){var c=Math.max(a.x,b.x),d=Math.max(a.y,b.y);a.width=Math.max(0,Math.min(a.x+a.width,b.x+b.width)-c),a.height=Math.max(0,Math.min(a.y+a.height,b.y+b.height)-d),a.x=c,a.y=d},g.union=function(a,b){if(!(b.width<=0||b.height<=0)){if(a.width<=0||a.height<=0)return void g.copyTo(b,a);var c=Math.min(a.x,b.x),d=Math.min(a.y,b.y);a.width=Math.max(a.x+a.width,b.x+b.width)-c,a.height=Math.max(a.y+a.height,b.y+b.height)-d,a.x=c,a.y=d}},g.isContainedIn=function(a,b){var c=a.x,d=a.y,e=a.x+a.width,f=a.y+a.height,g=b.x,h=b.y,i=b.x+b.width,j=b.y+b.height;return g>c||h>d||c>i||d>j?!1:g>e||h>f||e>i||f>j?!1:!0},g.containsPoint=function(a,b){return a.x<=b.x&&a.y<=b.y&&a.x+a.width>=b.x&&a.y+a.height>=b.y},g.extendTo=function(a,b,c){var d=a.x,e=a.y,f=a.width,g=a.height;(d>b||b>d+f)&&(f=Math.max(Math.abs(b-d),Math.abs(b-d-f))),(e>c||c>e+g)&&(g=Math.max(Math.abs(c-e),Math.abs(c-e-g))),a.x=Math.min(d,b),a.y=Math.min(e,c),a.width=f,a.height=g},g.grow=function(a,b,c,d,e){return a.x-=b,a.y-=c,a.width+=b+d,a.height+=c+e,a.width<0&&(a.width=0),a.height<0&&(a.height=0),a},g.shrink=function(a,b,c,d,e){a.x+=b,a.y+=c,a.width-=b+d,a.height-=c+e,a.width<0&&(a.width=0),a.height<0&&(a.height=0)},g.rectIn=function(a,c){var d=new g;return g.copyTo(a,d),g.intersection(d,c),g.isEmpty(d)?b.Out:g.isEqual(d,c)?b.In:b.Part},g.transform=function(b,g){if(!g)return b;var h=b.x,i=b.y,j=b.width,k=b.height;a.vec2.init(h,i,c),a.vec2.init(h+j,i,d),a.vec2.init(h+j,i+k,e),a.vec2.init(h,i+k,f),a.mat3.transformVec2(g,c),a.mat3.transformVec2(g,d),a.mat3.transformVec2(g,e),a.mat3.transformVec2(g,f);var l=Math.min(c[0],d[0],e[0],f[0]),m=Math.min(c[1],d[1],e[1],f[1]),n=Math.max(c[0],d[0],e[0],f[0]),o=Math.max(c[1],d[1],e[1],f[1]);return b.x=l,b.y=m,b.width=n-l,b.height=o-m,b},g.transform4=function(a,b){},g}();a.Rect=g}(minerva||(minerva={}));var minerva;!function(a){var b=function(){function a(a,b){this.width=null==a?0:a,this.height=null==b?0:b}return a.copyTo=function(a,b){b.width=a.width,b.height=a.height},a.isEqual=function(a,b){return a.width===b.width&&a.height===b.height},a.min=function(a,b){a.width=Math.min(a.width,b.width),a.height=Math.min(a.height,b.height)},a.isUndef=function(a){return isNaN(a.width)&&isNaN(a.height)},a.undef=function(a){a.width=NaN,a.height=NaN},a}();a.Size=b}(minerva||(minerva={}));var minerva;!function(a){var b=function(){function a(a,b,c,d){this.left=null==a?0:a,this.top=null==b?0:b,this.right=null==c?0:c,this.bottom=null==d?0:d}return a.add=function(a,b){a.left+=b.left,a.top+=b.top,a.right+=b.right,a.bottom+=b.bottom},a.copyTo=function(a,b){b.left=a.left,b.top=a.top,b.right=a.right,b.bottom=a.bottom},a.isEmpty=function(a){return 0===a.left&&0===a.top&&0===a.right&&0===a.bottom},a.isBalanced=function(a){return a.left===a.top&&a.left===a.right&&a.left===a.bottom},a.shrinkSize=function(a,b){var c=b.width,d=b.height;return c!=Number.POSITIVE_INFINITY&&(c-=a.left+a.right),d!=Number.POSITIVE_INFINITY&&(d-=a.top+a.bottom),b.width=c>0?c:0,b.height=d>0?d:0,b},a.shrinkRect=function(a,b){b.x+=a.left,b.y+=a.top,b.width-=a.left+a.right,b.height-=a.top+a.bottom,b.width<0&&(b.width=0),b.height<0&&(b.height=0)},a.shrinkCornerRadius=function(a,b){b.topLeft=Math.max(b.topLeft-.5*Math.max(a.left,a.top),0),b.topRight=Math.max(b.topRight-.5*Math.max(a.right,a.top),0),b.bottomRight=Math.max(b.bottomRight-.5*Math.max(a.right,a.bottom),0),b.bottomLeft=Math.max(b.bottomLeft-.5*Math.max(a.left,a.bottom),0)},a.growSize=function(a,b){var c=b.width,d=b.height;return c!=Number.POSITIVE_INFINITY&&(c+=a.left+a.right),d!=Number.POSITIVE_INFINITY&&(d+=a.top+a.bottom),b.width=c>0?c:0,b.height=d>0?d:0,b},a.growRect=function(a,b){b.x-=a.left,b.y-=a.top,b.width+=a.left+a.right,b.height+=a.top+a.bottom,b.width<0&&(b.width=0),b.height<0&&(b.height=0)},a.growCornerRadius=function(a,b){b.topLeft=b.topLeft?Math.max(b.topLeft+.5*Math.max(a.left,a.top),0):0,b.topRight=b.topRight?Math.max(b.topRight+.5*Math.max(a.right,a.top),0):0,b.bottomRight=b.bottomRight?Math.max(b.bottomRight+.5*Math.max(a.right,a.bottom),0):0,b.bottomLeft=b.bottomLeft?Math.max(b.bottomLeft+.5*Math.max(a.left,a.bottom),0):0},a}();a.Thickness=b}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){function b(a,b){return[a,b]}function c(a){return a[0]=-a[0],a[1]=-a[1],a}function d(a){var b=a[0],c=a[1];return a[0]=-c,a[1]=b,a}function e(a){var b=a[0],c=a[1],d=Math.sqrt(b*b+c*c);return a[0]=b/d,a[1]=c/d,a}function f(a,b){var c=Math.cos(b),d=Math.sin(b),e=a[0],f=a[1];return a[0]=e*c-f*d,a[1]=e*d+f*c,a}function g(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],g=c*e+d*f,h=Math.sqrt(c*c+d*d)*Math.sqrt(e*e+f*f);return Math.acos(g/h)}function h(a,b){var c=g(a,b),d=e(a.slice(0)),h=e(b.slice(0));f(d,c);var i=Math.abs(d[0]-h[0]),k=Math.abs(d[1]-h[1]);return j>i&&j>k}function i(a,b,c,d){var e=a[0],f=a[1],g=e+b[0],h=f+b[1],i=c[0],j=c[1],k=i+d[0],l=j+d[1],m=(e-g)*(j-l)-(f-h)*(i-k);if(0===m)return null;var n=(e*h-f*g)*(i-k)-(e-g)*(i*l-j*k),o=(e*h-f*g)*(j-l)-(f-h)*(i*l-j*k);return[n/m,o/m]}var j=1e-10;a.create=b,a.reverse=c,a.orthogonal=d,a.normalize=e,a.rotate=f,a.angleBetween=g,a.isClockwiseTo=h,a.intersection=i}(b=a.Vector||(a.Vector={}))}(minerva||(minerva={}));var minerva;!function(a){!function(a){a[a.Visible=0]="Visible",a[a.Collapsed=1]="Collapsed"}(a.Visibility||(a.Visibility={}));a.Visibility}(minerva||(minerva={}));var minerva;!function(a){function b(b,d){c=c||new a.core.render.RenderContext(document.createElement("canvas").getContext("2d"));var e=a.mat3.inverse(d.assets.renderXform,a.mat3.create());c.save(),c.pretransformMatrix(e);var f=[];return d.hitTest(b,f,c,!0),c.restore(),f}var c=null;a.findElementsInHostSpace=b}(minerva||(minerva={}));var minerva;!function(a){function b(b,c,d){a.errors.push({tree:b,pipedef:c,message:d})}a.errors=[],a.layoutError=b}(minerva||(minerva={}));var minerva;!function(a){function b(a){var b=a;return b.$$instance||Object.defineProperty(b,"$$instance",{value:new b,enumerable:!1}),b.$$instance}a.singleton=b}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){function b(a){return{def:a,state:a.createState(),output:a.createOutput()}}var c=function(){function a(){}return a}();a.ITriPipe=c,a.createTriPipe=b}(b=a.pipe||(a.pipe={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b=function(){function a(){this.$$names=[],this.$$tapins=[]}return a.prototype.addTapin=function(a,b){return this.$$names.push(a),this.$$tapins.push(b),this},a.prototype.addTapinBefore=function(a,b,c){var d=this.$$names,e=this.$$tapins,f=a?d.indexOf(a):-1;return-1===f?(d.unshift(b),e.unshift(c)):(d.splice(f,0,b),e.splice(f,0,c)),this},a.prototype.addTapinAfter=function(a,b,c){var d=this.$$names,e=this.$$tapins,f=a?d.indexOf(a):-1;return-1===f||f===d.length-1?(d.push(b),e.push(c)):(d.splice(f+1,0,b),e.splice(f+1,0,c)),this},a.prototype.replaceTapin=function(a,b){var c=this.$$names,d=this.$$tapins,e=c.indexOf(a);if(-1===e)throw new Error("Could not replace pipe tap-in. No pipe tap-in named `"+a+"`.");return d[e]=b,this},a.prototype.removeTapin=function(a){var b=this.$$names,c=b.indexOf(a);if(-1===c)throw new Error("Could not replace pipe tap-in. No pipe tap-in named `"+a+"`.");return b.splice(c,1),this.$$tapins.splice(c,1),this},a.prototype.run=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];b.unshift(a),this.prepare.apply(this,b);for(var d=!0,e=0,f=this.$$tapins,g=f.length;g>e;e++)if(!f[e].apply(this,b)){d=!1;break}return this.flush.apply(this,b),d},a.prototype.prepare=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c]},a.prototype.flush=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c]},a}();a.PipeDef=b}(b=a.pipe||(a.pipe={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b=function(){function a(){this.$$names=[],this.$$tapins=[]}return a.prototype.addTapin=function(a,b){return this.$$names.push(a),this.$$tapins.push(b),this},a.prototype.addTapinBefore=function(a,b,c){var d=this.$$names,e=this.$$tapins,f=a?d.indexOf(a):-1;return-1===f?(d.unshift(b),e.unshift(c)):(d.splice(f,0,b),e.splice(f,0,c)),this},a.prototype.addTapinAfter=function(a,b,c){var d=this.$$names,e=this.$$tapins,f=a?d.indexOf(a):-1;return-1===f||f===d.length-1?(d.push(b),e.push(c)):(d.splice(f+1,0,b),e.splice(f+1,0,c)),this},a.prototype.replaceTapin=function(a,b){var c=this.$$names,d=this.$$tapins,e=c.indexOf(a);if(-1===e)throw new Error("Could not replace pipe tap-in. No pipe tap-in named `"+a+"`.");return d[e]=b,this},a.prototype.removeTapin=function(a){var b=this.$$names,c=b.indexOf(a);if(-1===c)throw new Error("Could not replace pipe tap-in. No pipe tap-in named `"+a+"`.");return b.splice(c,1),this.$$tapins.splice(c,1),this},a.prototype.run=function(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e];d.unshift(c),d.unshift(b),d.unshift(a),this.prepare.apply(this,d);for(var f=!0,g=0,h=this.$$tapins,i=h.length;i>g;g++)if(!h[g].apply(this,d)){f=!1;break}return this.flush.apply(this,d),f},a.prototype.createState=function(){return null},a.prototype.createOutput=function(){return null},a.prototype.prepare=function(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e]},a.prototype.flush=function(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e]},a}();a.TriPipeDef=b}(b=a.pipe||(a.pipe={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c=function(){function c(){this.$$measure=null,this.$$measureBinder=null,this.$$arrange=null,this.$$arrangeBinder=null,this.$$sizing=null,this.$$processdown=null,this.$$processup=null,this.$$render=null,this.$$hittest=null,this.$$inDownDirty=!1,this.$$inUpDirty=!1,this.$$attached={},this.$$sizeupdater=a.NO_SIZE_UPDATER,this.assets={width:NaN,height:NaN,minWidth:0,minHeight:0,maxWidth:Number.POSITIVE_INFINITY,maxHeight:Number.POSITIVE_INFINITY,useLayoutRounding:!0,margin:new a.Thickness,horizontalAlignment:a.HorizontalAlignment.Stretch,verticalAlignment:a.VerticalAlignment.Stretch,clip:null,effect:null,visibility:a.Visibility.Visible,opacity:1,isHitTestVisible:!0,renderTransform:null,renderTransformOrigin:new a.Point,effectPadding:new a.Thickness,previousConstraint:new a.Size,desiredSize:new a.Size,hiddenDesire:new a.Size(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),renderSize:new a.Size,visualOffset:new a.Point,lastRenderSize:void 0,layoutSlot:new a.Rect,layoutClip:new a.Rect,compositeLayoutClip:new a.Rect,breakLayoutClip:!1,actualWidth:0,actualHeight:0,z:NaN,totalIsRenderVisible:!0,totalOpacity:1,totalIsHitTestVisible:!0,extents:new a.Rect,extentsWithChildren:new a.Rect,surfaceBoundsWithChildren:new a.Rect,globalBoundsWithChildren:new a.Rect,layoutXform:a.mat3.identity(),carrierXform:null,renderXform:a.mat3.identity(),absoluteXform:a.mat3.identity(),dirtyRegion:new a.Rect,dirtyFlags:0,uiFlags:a.UIFlags.RenderVisible|a.UIFlags.HitTestVisible,forceInvalidate:!1},this.tree=null,perfex.timer.start("CreateUpdater",null),this.setMeasureBinder().setArrangeBinder().init(),perfex.timer.stop()}return c.prototype.init=function(){this.setTree(this.tree),this.$$measure||this.setMeasurePipe(),this.$$arrange||this.setArrangePipe(),this.$$sizing||this.setSizingPipe(),this.$$processdown||this.setProcessDownPipe(),this.$$processup||this.setProcessUpPipe(),this.$$render||this.setRenderPipe(),this.$$hittest||this.setHitTestPipe(),this.$$hittest.data.tree||(this.$$hittest.data.tree=this.tree)},c.prototype.setTree=function(a){return this.tree=a||new b.UpdaterTree,this},c.prototype.getAttachedValue=function(a){return this.$$attached[a]},c.prototype.setAttachedValue=function(a,b){this.$$attached[a]=b},c.prototype.onDetached=function(){b.reactTo.helpers.invalidateParent(this),this.invalidateMeasure(),this.tree.visualParent&&this.tree.visualParent.invalidateMeasure();var a=this.assets.layoutSlot;a.x=a.y=a.width=a.height=0;var c=this.assets.layoutClip;c.x=c.y=c.width=c.height=0},c.prototype.onAttached=function(){var b=this.assets;a.Size.undef(b.previousConstraint),b.dirtyFlags|=a.DirtyFlags.RenderVisibility|a.DirtyFlags.HitTestVisibility|a.DirtyFlags.LocalTransform;var d=b.layoutClip;d.x=d.y=d.width=d.height=0;var e=b.renderSize;e.width=e.height=0,this.invalidateMeasure().invalidateArrange().invalidate().updateBounds(!0),c.$$addDownDirty(this),((b.uiFlags&a.UIFlags.SizeHint)>0||void 0!==b.lastRenderSize)&&c.$$propagateUiFlagsUp(this,a.UIFlags.SizeHint)},c.prototype.setVisualParent=function(a){return!a&&this.tree.visualParent&&(this.onDetached(),this.tree.visualParent.tree.onChildDetached(this)),this.tree.visualParent=a,this.setSurface(a?a.tree.surface:void 0),a&&(a.tree.onChildAttached(this),this.onAttached()),this},c.prototype.setSurface=function(b){for(var c,d=[],e=this.walkDeep();e.step();)c=e.current,c.tree.surface!==b?(c.tree.surface=b,b&&((c.assets.dirtyFlags&a.DirtyFlags.DownDirtyState)>0&&(c.$$inDownDirty=!0,b.addDownDirty(c)),(c.assets.dirtyFlags&a.DirtyFlags.UpDirtyState)>0&&d.push(c))):e.skipBranch();for(;null!=(c=d.pop());)c.$$inUpDirty=!0,b.addUpDirty(c);return this},c.prototype.walkDeep=function(b){var c=void 0,d=[this];b=b||a.WalkDirection.Forward;var e=b===a.WalkDirection.Forward||b===a.WalkDirection.ZForward?b+1:b-1;return{current:void 0,step:function(){if(c)for(var a=c.tree.walk(e);a.step();)d.unshift(a.current);return this.current=c=d.shift(),void 0!==this.current},skipBranch:function(){c=void 0}}},c.prototype.setMeasurePipe=function(c){if(this.$$measure)return this;var d=c||new b.measure.MeasurePipeDef;return this.$$measure=a.pipe.createTriPipe(d),this},c.prototype.setMeasureBinder=function(a){return this.$$measureBinder=a||new b.measure.MeasureBinder,this},c.prototype.setArrangePipe=function(c){if(this.$$arrange)return this;var d=c||new b.arrange.ArrangePipeDef;return this.$$arrange=a.pipe.createTriPipe(d),this},c.prototype.setArrangeBinder=function(a){return this.$$arrangeBinder=a||new b.arrange.ArrangeBinder,this},c.prototype.setSizingPipe=function(c){if(this.$$sizing)return this;var d=c;return d||(d=new b.sizing.SizingPipeDef),this.$$sizing=a.pipe.createTriPipe(d),this},c.prototype.setProcessDownPipe=function(c){var d=c;return d||(d=new b.processdown.ProcessDownPipeDef),this.$$processdown=a.pipe.createTriPipe(d),this},c.prototype.setProcessUpPipe=function(c){if(this.$$processup)return this;var d=c;return d||(d=new b.processup.ProcessUpPipeDef),this.$$processup=a.pipe.createTriPipe(d),this},c.prototype.setRenderPipe=function(c){if(this.$$render)return this;var d=c||new b.render.RenderPipeDef;return this.$$render=a.pipe.createTriPipe(d),this},c.prototype.setHitTestPipe=function(c){if(this.$$hittest)return this;var d=c||new b.hittest.HitTestPipeDef;return this.$$hittest={def:d,data:{updater:this,assets:this.assets,tree:this.tree,hitChildren:!1,bounds:new a.Rect,layoutClipBounds:new a.Rect}},this},c.prototype.doMeasure=function(){this.$$measureBinder.bind(this)},c.prototype.measure=function(a){var b=this.$$measure,d=b.output,e=b.def.run(this.assets,b.state,d,this.tree,a);return d.newUpDirty&&c.$$addUpDirty(this),d.newDownDirty&&c.$$addDownDirty(this),d.newUiFlags&&c.$$propagateUiFlagsUp(this,d.newUiFlags),e},c.prototype.doArrange=function(){this.$$arrangeBinder.bind(this)},c.prototype.arrange=function(a){var b=this.$$arrange,d=b.output,e=b.def.run(this.assets,b.state,d,this.tree,a);return d.newUpDirty&&c.$$addUpDirty(this),d.newDownDirty&&c.$$addDownDirty(this),d.newUiFlags&&c.$$propagateUiFlagsUp(this,d.newUiFlags),e},c.prototype.sizing=function(b,c){var d=this.$$sizing,e=this.assets;e.lastRenderSize&&a.Size.copyTo(e.lastRenderSize,b);var f=d.def.run(e,d.state,d.output,this.tree);return a.Size.copyTo(d.output.actualSize,c),this.$$sizeupdater.setActualWidth(c.width),this.$$sizeupdater.setActualHeight(c.height),e.lastRenderSize=void 0,f},c.prototype.processDown=function(){if(this.tree.surface||(this.$$inDownDirty=!1),!this.$$inDownDirty)return!0;var a=this.tree.visualParent;if(a&&a.$$inDownDirty)return!1;var b=this.$$processdown,d=b.def.run(this.assets,b.state,b.output,a?a.assets:null,this.tree);return this.$$inDownDirty=!1,b.output.newUpDirty&&c.$$addUpDirty(this),d},c.prototype.processUp=function(){if(this.tree.surface||(this.$$inUpDirty=!1),!this.$$inUpDirty)return!0;var a=this.$$processup,b=a.def.run(this.assets,a.state,a.output,this.tree);return this.$$inUpDirty=!1,b},c.prototype.render=function(a,b){var c=this.$$render;return c.def.run(this.assets,c.state,c.output,a,b,this.tree)},c.prototype.hitTest=function(a,b,c,d){var e=this.$$hittest;return e.def.run(e.data,a,b,c,d===!0)},c.prototype.onSizeChanged=function(a,b){this.$$sizeupdater.onSizeChanged(a,b)},c.prototype.setSizeUpdater=function(b){this.$$sizeupdater=b||a.NO_SIZE_UPDATER},c.prototype.invalidateMeasure=function(){return this.assets.dirtyFlags|=a.DirtyFlags.Measure,c.$$propagateUiFlagsUp(this,a.UIFlags.MeasureHint),this},c.prototype.invalidateArrange=function(){return this.assets.dirtyFlags|=a.DirtyFlags.Arrange,c.$$propagateUiFlagsUp(this,a.UIFlags.ArrangeHint),this},c.prototype.updateBounds=function(b){var d=this.assets;return d.dirtyFlags|=a.DirtyFlags.Bounds,c.$$addUpDirty(this),b===!0&&(d.forceInvalidate=!0),this},c.prototype.fullInvalidate=function(b){var d=this.assets;return this.invalidate(d.surfaceBoundsWithChildren),b&&(d.dirtyFlags|=a.DirtyFlags.LocalTransform,c.$$addDownDirty(this)),this.updateBounds(!0),this},c.prototype.invalidate=function(b){var d=this.assets;return!d.totalIsRenderVisible||255*d.totalOpacity<.5?this:(d.dirtyFlags|=a.DirtyFlags.Invalidate,c.$$addUpDirty(this),b||(b=d.surfaceBoundsWithChildren),a.Rect.union(d.dirtyRegion,b),this)},c.prototype.findChildInList=function(a){for(var b=0,c=a.length;c>b;b++)if(a[b].tree.visualParent===this)return b;return-1},c.$$addUpDirty=function(a){var b=a.tree.surface;b&&!a.$$inUpDirty&&(b.addUpDirty(a),a.$$inUpDirty=!0)},c.$$addDownDirty=function(a){var b=a.tree.surface;b&&!a.$$inDownDirty&&(b.addDownDirty(a),a.$$inDownDirty=!0)},c.$$propagateUiFlagsUp=function(a,b){a.assets.uiFlags|=b;for(var c=a;null!=(c=c.tree.visualParent)&&0===(c.assets.uiFlags&b);)c.assets.uiFlags|=b},c.transformToVisual=function(b,c){if(!b.tree.surface||c&&!c.tree.surface)return null;var d=a.mat3.create(),e=b.assets.absoluteXform;if(c){var f=a.mat3.inverse(c.assets.absoluteXform,a.mat3.create());a.mat3.multiply(e,f,d)}else a.mat3.copyTo(e,d);return d},c.transformPoint=function(b,c){var d=a.mat3.inverse(b.assets.absoluteXform,a.mat3.create());if(!d)return void console.warn("Could not get inverse of Absolute Transform for UIElement.");var e=a.vec2.create(c.x,c.y);a.mat3.transformVec2(d,e),c.x=e[0],c.y=e[1]},c}();b.Updater=c}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b={updateBounds:function(){},invalidate:function(a){}},c=function(){function a(){this.isTop=!1,this.surface=null,this.visualParent=null,this.isContainer=!1,this.isLayoutContainer=!1,this.subtree=null}return Object.defineProperty(a.prototype,"visualOwner",{get:function(){return this.visualParent?this.visualParent:this.isTop&&this.surface?this.surface:b},enumerable:!0,configurable:!0}),a.prototype.walk=function(a){var b=!1,c=this;return{current:void 0,step:function(){return b?!1:(b=!0,this.current=c.subtree,null!=this.current)}}},a.prototype.onChildAttached=function(a){this.subtree=a},a.prototype.onChildDetached=function(a){this.subtree=null},a.prototype.setTemplateApplier=function(a){this.applyTemplate=a},a.prototype.applyTemplate=function(){return!1},a}();a.UpdaterTree=c}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){function c(a,b){var c=Math.max(b.minWidth,a.width),d=Math.max(b.minHeight,a.height);isNaN(b.width)||(c=b.width),isNaN(b.height)||(d=b.height),c=Math.max(Math.min(c,b.maxWidth),b.minWidth),d=Math.max(Math.min(d,b.maxHeight),b.minHeight),b.useLayoutRounding&&(c=Math.round(c),d=Math.round(d)),a.width=c,a.height=d}function d(b,c,d,e,f,g){a.Rect.copyTo(c,b),a.Thickness.growRect(d,b),f&&a.Rect.intersection(b,f.GetBounds()),a.Rect.isEmpty(g)||a.Rect.intersection(b,g),e&&a.Rect.transform(b,e)}function e(b,c,d){var e;f.x=0,f.y=0;for(var g,h=b.raw;c&&(e=c.layoutClip,a.Rect.isEmpty(e)||(h.beginPath(),h.rect(e.x,e.y,e.width,e.height),h.clip()),!c.breakLayoutClip);){var i=c.visualOffset;if(f.x+=i.x,f.y+=i.y,b.translate(-i.x,-i.y),!d)break;g=d.visualParent,d=g?g.tree:null,c=g?g.assets:null}b.translate(f.x,f.y)}b.coerceSize=c,b.intersectBoundsWithClipPath=d;var f=new a.Point;b.renderLayoutClip=e}(c=b.helpers||(b.helpers={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){function d(c,d,e){c.assets.dirtyFlags|=a.DirtyFlags.HitTestVisibility,b.Updater.$$addDownDirty(c)}function e(a,b,c){a.invalidateMeasure(),a.invalidateArrange()}function f(c,d,e){c.assets.dirtyFlags|=a.DirtyFlags.RenderVisibility,b.Updater.$$addDownDirty(c),l.invalidateParent(c)}function g(c,d,e){c.assets.dirtyFlags|=a.DirtyFlags.RenderVisibility,b.Updater.$$addDownDirty(c),l.invalidateParent(c),c.invalidateMeasure();var f=c.tree.visualParent;f&&f.invalidateMeasure()}function h(c,d,e){l.invalidateParent(c);var f=e?e.GetPadding(c.assets.effectPadding):!1;f&&c.updateBounds(),d!==e&&c.tree.surface&&(c.assets.dirtyFlags|=a.DirtyFlags.LocalTransform,b.Updater.$$addDownDirty(c))}function i(c,d,e){var f=c.assets;l.invalidateParent(c),c.updateBounds(!0),f.dirtyFlags|=a.DirtyFlags.LocalClip,b.Updater.$$addDownDirty(c)}function j(c,d,e){c.assets.dirtyFlags|=a.DirtyFlags.LocalTransform,b.Updater.$$addDownDirty(c)}function k(c,d,e){c.assets.dirtyFlags|=a.DirtyFlags.LocalTransform,b.Updater.$$addDownDirty(c)}var l;!function(a){function b(a){a.tree.visualOwner.invalidate(a.assets.surfaceBoundsWithChildren)}function c(a){var b=a.tree.visualParent;b&&b.invalidateMeasure();var c=a.assets.renderTransformOrigin;a.fullInvalidate(0!==c.x||0!==c.y).invalidateMeasure().invalidateArrange()}function d(a){a.invalidateArrange(),a.fullInvalidate(!0)}a.invalidateParent=b,a.sizeChanged=c,a.alignmentChanged=d}(l=c.helpers||(c.helpers={})),c.isHitTestVisible=d,c.useLayoutRounding=e,c.opacity=f,c.visibility=g,c.effect=h,c.clip=i,c.renderTransform=j,c.renderTransformOrigin=k,c.width=l.sizeChanged,c.height=l.sizeChanged,c.minWidth=l.sizeChanged,c.minHeight=l.sizeChanged,c.maxWidth=l.sizeChanged,c.maxHeight=l.sizeChanged,c.margin=l.sizeChanged,c.flowDirection=l.sizeChanged,c.horizontalAlignment=l.alignmentChanged,c.verticalAlignment=l.alignmentChanged}(c=b.reactTo||(b.reactTo={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(){}return b.prototype.bind=function(b){var c=b.assets,d=b.tree,e=c.layoutSlot||void 0;return d.visualParent||(e=new a.Rect,this.expandViewport(e,c,d),this.shiftViewport(e,b)),e?b.arrange(e):(d.visualParent&&d.visualParent.invalidateArrange(),!1)},b.prototype.expandViewport=function(b,c,d){if(d.isLayoutContainer){if(a.Size.copyTo(c.desiredSize,b),d.surface){var e=c.previousConstraint;a.Size.isUndef(e)?(b.width=d.surface.width,b.height=d.surface.height):(b.width=Math.max(b.width,e.width),b.height=Math.max(b.height,e.height))}}else b.width=c.actualWidth,b.height=c.actualHeight},b.prototype.shiftViewport=function(a,b){a.x=b.getAttachedValue("Canvas.Left")||0,a.y=b.getAttachedValue("Canvas.Top")||0},b}();b.ArrangeBinder=c}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}));
}(minerva||(minerva={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("applyRounding",b.tapins.applyRounding).addTapin("validateFinalRect",b.tapins.validateFinalRect).addTapin("validateVisibility",b.tapins.validateVisibility).addTapin("checkNeedArrange",b.tapins.checkNeedArrange).addTapin("invalidateFuture",b.tapins.invalidateFuture).addTapin("calcStretched",b.tapins.calcStretched).addTapin("prepareOverride",b.tapins.prepareOverride).addTapin("doOverride",b.tapins.doOverride).addTapin("completeOverride",b.tapins.completeOverride).addTapin("calcFlip",b.tapins.calcFlip).addTapin("calcVisualOffset",b.tapins.calcVisualOffset).addTapin("buildLayoutClip",b.tapins.buildLayoutClip).addTapin("buildLayoutXform",b.tapins.buildLayoutXform).addTapin("buildRenderSize",b.tapins.buildRenderSize)}return __extends(d,c),d.prototype.createState=function(){return{arrangedSize:new a.Size,finalRect:new a.Rect,finalSize:new a.Size,childRect:new a.Rect,framework:new a.Size,stretched:new a.Size,constrained:new a.Size,flipHorizontal:!1}},d.prototype.createOutput=function(){return{dirtyFlags:0,uiFlags:0,layoutSlot:new a.Rect,layoutXform:a.mat3.identity(),layoutClip:new a.Rect,renderSize:new a.Size,lastRenderSize:void 0,visualOffset:new a.Point,origDirtyFlags:0,origUiFlags:0,newUpDirty:0,newDownDirty:0,newUiFlags:0}},d.prototype.prepare=function(b,c,d){d.origDirtyFlags=d.dirtyFlags=b.dirtyFlags,d.origUiFlags=d.uiFlags=b.uiFlags,a.Rect.copyTo(b.layoutSlot,d.layoutSlot),a.Rect.copyTo(b.layoutClip,d.layoutClip),a.Size.copyTo(b.renderSize,d.renderSize),d.lastRenderSize=b.lastRenderSize,a.mat3.copyTo(b.layoutXform,d.layoutXform),a.Point.copyTo(b.visualOffset,d.visualOffset)},d.prototype.flush=function(b,c,d){var e=(d.dirtyFlags|b.dirtyFlags)&~d.origDirtyFlags;d.newUpDirty=e&a.DirtyFlags.UpDirtyState,d.newDownDirty=e&a.DirtyFlags.DownDirtyState,d.newUiFlags=(d.uiFlags|b.uiFlags)&~d.origUiFlags,b.dirtyFlags=d.dirtyFlags,b.uiFlags=d.uiFlags,a.Rect.copyTo(d.layoutSlot,b.layoutSlot),a.Rect.copyTo(d.layoutClip,b.layoutClip),a.Size.copyTo(d.renderSize,b.renderSize),b.lastRenderSize=d.lastRenderSize,a.mat3.copyTo(d.layoutXform,b.layoutXform),a.Point.copyTo(d.visualOffset,b.visualOffset)},d}(a.pipe.TriPipeDef);b.ArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.applyRounding=function(b,c,d,e,f){var g=c.finalRect;return b.useLayoutRounding?(g.x=Math.round(f.x),g.y=Math.round(f.y),g.width=Math.round(f.width),g.height=Math.round(f.height)):a.Rect.copyTo(f,g),!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=new a.Rect,e=new a.Rect;c.buildLayoutClip=function(c,f,g,h,i){var j=g.layoutClip;a.Rect.copyTo(f.finalRect,j);var k=g.visualOffset;j.x=Math.max(j.x-k.x,0),j.y=Math.max(j.y-k.y,0),c.useLayoutRounding&&(j.x=Math.round(j.x),j.y=Math.round(j.y)),d.x=d.y=0;var l=f.arrangedSize;return a.Size.copyTo(l,d),(h.isTop||a.Rect.isContainedIn(d,j))&&a.Size.isEqual(f.constrained,l)?j.x=j.y=j.width=j.height=0:(e.x=e.y=0,e.width=e.height=Number.POSITIVE_INFINITY,b.helpers.coerceSize(e,c),a.Rect.intersection(j,e)),a.Rect.isEqual(g.layoutClip,c.layoutClip)||(g.dirtyFlags|=a.DirtyFlags.LayoutClip),!0}}(d=c.tapins||(c.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.buildLayoutXform=function(b,c,d,e,f){var g=d.visualOffset,h=a.mat3.createTranslate(g.x,g.y,d.layoutXform);return c.flipHorizontal&&(a.mat3.translate(h,c.arrangedSize.width,0),a.mat3.scale(h,-1,1)),a.mat3.equal(b.layoutXform,d.layoutXform)||(d.dirtyFlags|=a.DirtyFlags.LocalTransform),!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.buildRenderSize=function(b,c,d,e,f){return a.Size.copyTo(c.arrangedSize,d.renderSize),a.Size.isEqual(b.renderSize,d.renderSize)||d.lastRenderSize||(d.lastRenderSize=d.renderSize,d.uiFlags|=a.UIFlags.SizeHint),!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.calcFlip=function(a,b,c,d,e){return b.flipHorizontal=!1,!0}}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.calcStretched=function(c,d,e,f,g){a.Rect.copyTo(g,e.layoutSlot);var h=d.finalRect;a.Thickness.shrinkRect(c.margin,h);var i=d.stretched;return i.width=h.width,i.height=h.height,b.helpers.coerceSize(i,c),!0}}(d=c.tapins||(c.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.calcVisualOffset=function(b,c,d,e,f){var g=d.visualOffset,h=c.finalRect,i=c.constrained;if(g.x=h.x,g.y=h.y,!e.isTop){switch(b.horizontalAlignment){case a.HorizontalAlignment.Left:break;case a.HorizontalAlignment.Right:g.x+=h.width-i.width;break;case a.HorizontalAlignment.Center:g.x+=.5*(h.width-i.width);break;default:g.x+=Math.max(.5*(h.width-i.width),0)}switch(b.verticalAlignment){case a.VerticalAlignment.Top:break;case a.VerticalAlignment.Bottom:g.y+=h.height-i.height;break;case a.VerticalAlignment.Center:g.y+=.5*(h.height-i.height);break;default:g.y+=Math.max(.5*(h.height-i.height),0)}}return b.useLayoutRounding&&(g.x=Math.round(g.x),g.y=Math.round(g.y)),!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.checkNeedArrange=function(b,c,d,e,f){return(b.dirtyFlags&a.DirtyFlags.Arrange)>0?!0:!a.Rect.isEqual(d.layoutSlot,c.finalRect)}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.completeOverride=function(c,d,e,f,g){e.dirtyFlags&=~a.DirtyFlags.Arrange;var h=d.arrangedSize;c.horizontalAlignment===a.HorizontalAlignment.Stretch&&(h.width=Math.max(h.width,d.framework.width)),c.verticalAlignment===a.VerticalAlignment.Stretch&&(h.height=Math.max(h.height,d.framework.height)),c.useLayoutRounding&&(h.width=Math.round(h.width),h.height=Math.round(h.height));var i=d.constrained;return a.Size.copyTo(h,i),b.helpers.coerceSize(i,c),i.width=Math.min(i.width,h.width),i.height=Math.min(i.height,h.height),!0}}(d=c.tapins||(c.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.doOverride=function(b,c,d,e,f){var g=c.childRect;g.x=g.y=0,a.Size.copyTo(c.finalSize,g);for(var h=e.walk();h.step();){var i=h.current;i.arrange(c.childRect)}return a.Size.copyTo(g,c.arrangedSize),!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.invalidateFuture=function(b,c,d,e,f){var g=d.layoutClip;return g.x=g.y=g.width=g.height=0,d.dirtyFlags|=a.DirtyFlags.LocalTransform,d.dirtyFlags|=a.DirtyFlags.Bounds,!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.prepareOverride=function(c,d,e,f,g){var h=d.framework;h.width=0,h.height=0,b.helpers.coerceSize(h,c),c.horizontalAlignment===a.HorizontalAlignment.Stretch&&(h.width=Math.max(h.width,d.stretched.width)),c.verticalAlignment===a.VerticalAlignment.Stretch&&(h.height=Math.max(h.height,d.stretched.height));var i=d.finalSize,j=c.hiddenDesire;return i.width=Math.max(j.width,h.width),i.height=Math.max(j.height,h.height),!0}}(d=c.tapins||(c.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.validateFinalRect=function(b,c,d,e,f){var g=c.finalRect;return g.width<0||g.height<0||!isFinite(g.width)||!isFinite(g.height)||isNaN(g.width)||isNaN(g.height)?(a.layoutError(e,this,"Invalid arguments to Arrange."),!1):!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.validateVisibility=function(b,c,d,e,f){return b.visibility!==a.Visibility.Visible?(a.Rect.copyTo(c.finalRect,d.layoutSlot),!1):!0}}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.addTapin("flushPrevious",b.tapins.flushPrevious).addTapin("determinePhase",b.tapins.determinePhase).addTapin("prepareMeasure",b.tapins.prepareMeasure).addTapin("measure",b.tapins.measure).addTapin("prepareArrange",b.tapins.prepareArrange).addTapin("arrange",b.tapins.arrange).addTapin("prepareSizing",b.tapins.prepareSizing).addTapin("sizing",b.tapins.sizing).addTapin("notifyResize",b.tapins.notifyResize)}return __extends(c,a),c.prototype.prepare=function(a){},c.prototype.flush=function(a){},c}(a.pipe.PipeDef);b.DraftPipeDef=c}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.arrange=function(b){if(b.flag!==a.UIFlags.ArrangeHint)return!0;if(b.arrangeList.length<=0)return!1;for(var c;null!=(c=b.arrangeList.shift());)c.doArrange();return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.determinePhase=function(b){b.flag=a.UIFlags.None;var c=b.assets;if(c.visibility!==a.Visibility.Visible)return!0;if((c.uiFlags&a.UIFlags.MeasureHint)>0)b.flag=a.UIFlags.MeasureHint;else if((c.uiFlags&a.UIFlags.ArrangeHint)>0)b.flag=a.UIFlags.ArrangeHint;else{if(!((c.uiFlags&a.UIFlags.SizeHint)>0))return!1;b.flag=a.UIFlags.SizeHint}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.flushPrevious=function(c){for(var d;null!=(d=c.arrangeList.shift());)b.Updater.$$propagateUiFlagsUp(d,a.UIFlags.ArrangeHint);for(;null!=(d=c.sizingList.shift());)b.Updater.$$propagateUiFlagsUp(d,a.UIFlags.SizeHint);return!0}}(d=c.tapins||(c.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.measure=function(b){if(b.flag!==a.UIFlags.MeasureHint)return!0;if(b.measureList.length<=0)return!1;for(var c;null!=(c=b.measureList.shift());)c.doMeasure();return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.notifyResize=function(b){if(b.flag!==a.UIFlags.SizeHint)return!0;if(b.sizingUpdates.length<=0)return!0;for(var c;null!=(c=b.sizingUpdates.pop());)c.updater.onSizeChanged(c.oldSize,c.newSize);return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.prepareArrange=function(b){if(b.flag!==a.UIFlags.ArrangeHint)return!0;for(var c=b.updater.walkDeep();c.step();){var d=c.current.assets;d.visibility===a.Visibility.Visible&&0!==(d.uiFlags&a.UIFlags.ArrangeHint)?(d.uiFlags&=~a.UIFlags.ArrangeHint,(d.dirtyFlags&a.DirtyFlags.Arrange)>0&&b.arrangeList.push(c.current)):c.skipBranch()}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.prepareMeasure=function(b){if(b.flag!==a.UIFlags.MeasureHint)return!0;var c=b.assets.previousConstraint;!b.tree.isContainer||!a.Size.isUndef(c)&&a.Size.isEqual(c,b.surfaceSize)||(b.assets.dirtyFlags|=a.DirtyFlags.Measure,a.Size.copyTo(b.surfaceSize,b.assets.previousConstraint));for(var d=b.updater.walkDeep();d.step();){var e=d.current.assets;e.visibility===a.Visibility.Visible&&0!==(e.uiFlags&a.UIFlags.MeasureHint)?(e.uiFlags&=~a.UIFlags.MeasureHint,(e.dirtyFlags&a.DirtyFlags.Measure)>0&&b.measureList.push(d.current)):d.skipBranch()}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.prepareSizing=function(b){if(b.flag!==a.UIFlags.SizeHint)return!0;for(var c=b.updater.walkDeep();c.step();){var d=c.current.assets;d.visibility===a.Visibility.Visible&&0!==(d.uiFlags&a.UIFlags.SizeHint)?(d.uiFlags&=~a.UIFlags.SizeHint,void 0!==d.lastRenderSize&&b.sizingList.push(c.current)):c.skipBranch()}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.sizing=function(b){if(b.flag!==a.UIFlags.SizeHint)return!0;if(b.sizingList.length<=0)return!1;for(var c,d=new a.Size,e=new a.Size;null!=(c=b.sizingList.pop());)c.sizing(d,e),a.Size.isEqual(d,new a.Size)||(b.sizingUpdates.push({updater:c,oldSize:d,newSize:e}),d=new a.Size,e=new a.Size);return!0}}(c=b.tapins||(b.tapins={}))}(c=b.draft||(b.draft={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.addTapin("canHit",b.tapins.canHit).addTapin("prepareCtx",b.tapins.prepareCtx).addTapin("insideClip",b.tapins.insideClip).addTapin("insideChildren",b.tapins.insideChildren).addTapin("canHitInside",b.tapins.canHitInside).addTapin("insideObject",b.tapins.insideObject).addTapin("insideLayoutClip",b.tapins.insideLayoutClip).addTapin("completeCtx",b.tapins.completeCtx)}return __extends(c,a),c}(a.pipe.PipeDef);b.HitTestPipeDef=c}(c=b.hittest||(b.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=a.assets;return!!f.totalIsRenderVisible&&!!f.totalIsHitTestVisible}a.canHit=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return a.hitChildren?!0:(c.shift(),d.restore(),!1)}a.canHitInside=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return d.restore(),!0}a.completeCtx=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){d.unshift(b.updater);for(var g=!1,h=b.tree.walk(a.WalkDirection.ZReverse);h.step()&&(g=h.current.hitTest(c,d,e,f)||g,!g||f););return b.hitChildren=g,!0}b.insideChildren=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=b.assets.clip;if(!g)return!0;var h=g.GetBounds();return a.Rect.transform(h,e.currentTransform),a.Rect.containsPoint(h,c)?(g.Draw(e),e.raw.isPointInPath(c.x,c.y)?!0:(e.restore(),!1)):(e.restore(),!1)}b.insideClip=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.hitChildren)return!0;var g=b.assets.compositeLayoutClip;if(!g||a.Rect.isEmpty(g))return!0;var h=b.layoutClipBounds;return a.Rect.copyTo(g,h),a.Rect.transform(h,e.currentTransform),a.Rect.containsPoint(h,c)?!0:(d.shift(),e.restore(),!1)}b.insideLayoutClip=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.hitChildren)return!0;var g=b.bounds;return a.Rect.copyTo(b.assets.extents,g),a.Rect.transform(g,e.currentTransform),a.Rect.containsPoint(g,c)?!0:(d.shift(),e.restore(),!1)}b.insideObject=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return d.save(),d.pretransformMatrix(a.assets.renderXform),!0}a.prepareCtx=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(){}return b.prototype.bind=function(b){var c=b.assets,d=c.previousConstraint,e=new a.Size,f=b.tree;!f.surface&&a.Size.isUndef(d)&&!f.visualParent&&f.isLayoutContainer&&(d.width=d.height=Number.POSITIVE_INFINITY);var g=!1;return!a.Size.isUndef(d)&&(a.Size.copyTo(c.desiredSize,e),g=b.measure(d),a.Size.isEqual(e,c.desiredSize))?g:(f.visualParent&&f.visualParent.invalidateMeasure(),c.dirtyFlags&=~a.DirtyFlags.Measure,g)},b}();b.MeasureBinder=c}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("validate",b.tapins.validate).addTapin("validateVisibility",b.tapins.validateVisibility).addTapin("applyTemplate",b.tapins.applyTemplate).addTapin("checkNeedMeasure",b.tapins.checkNeedMeasure).addTapin("invalidateFuture",b.tapins.invalidateFuture).addTapin("prepareOverride",b.tapins.prepareOverride).addTapin("doOverride",b.tapins.doOverride).addTapin("completeOverride",b.tapins.completeOverride).addTapin("finishDesired",b.tapins.finishDesired)}return __extends(d,c),d.prototype.createState=function(){return{availableSize:new a.Size}},d.prototype.createOutput=function(){return{previousConstraint:new a.Size,desiredSize:new a.Size,hiddenDesire:new a.Size,dirtyFlags:0,uiFlags:0,origDirtyFlags:0,origUiFlags:0,newUpDirty:0,newDownDirty:0,newUiFlags:0}},d.prototype.prepare=function(b,c,d){a.Size.copyTo(b.previousConstraint,d.previousConstraint),a.Size.copyTo(b.desiredSize,d.desiredSize),a.Size.copyTo(b.hiddenDesire,d.hiddenDesire),d.origDirtyFlags=d.dirtyFlags=b.dirtyFlags,d.origUiFlags=d.uiFlags=b.uiFlags},d.prototype.flush=function(b,c,d){var e=(d.dirtyFlags|b.dirtyFlags)&~d.origDirtyFlags;d.newUpDirty=e&a.DirtyFlags.UpDirtyState,d.newDownDirty=e&a.DirtyFlags.DownDirtyState,d.newUiFlags=(d.uiFlags|b.uiFlags)&~d.origUiFlags,b.dirtyFlags=d.dirtyFlags,b.uiFlags=d.uiFlags,a.Size.copyTo(d.previousConstraint,b.previousConstraint),a.Size.copyTo(d.hiddenDesire,b.hiddenDesire),a.Size.copyTo(d.desiredSize,b.desiredSize)},d}(a.pipe.TriPipeDef);b.MeasurePipeDef=c}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.applyTemplate=function(a,b,c,d,e){return d.applyTemplate(),!0}}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.checkNeedMeasure=function(b,c,d,e,f){if((b.dirtyFlags&a.DirtyFlags.Measure)>0)return!0;var g=b.previousConstraint;return a.Size.isUndef(g)||g.width!==f.width||g.height!==f.height?(a.Size.copyTo(f,d.previousConstraint),!0):!1}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.completeOverride=function(b,c,d,e,f){return d.dirtyFlags&=~a.DirtyFlags.Measure,a.Size.copyTo(d.desiredSize,d.hiddenDesire),!0}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.doOverride=function(b,c,d,e,f){var g=d.desiredSize;g.width=g.height=0;for(var h=e.walk();h.step();){var i=h.current;i.measure(c.availableSize),a.Size.copyTo(i.assets.desiredSize,g)}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.finishDesired=function(c,d,e,f,g){var h=e.desiredSize;return b.helpers.coerceSize(h,c),a.Thickness.growSize(c.margin,h),h.width=Math.min(h.width,g.width),h.height=Math.min(h.height,g.height),c.useLayoutRounding&&(h.width=Math.round(h.width),h.height=Math.round(h.height)),!0}}(d=c.tapins||(c.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.invalidateFuture=function(b,c,d,e,f){return d.dirtyFlags|=a.DirtyFlags.Arrange,d.uiFlags|=a.UIFlags.ArrangeHint,d.dirtyFlags|=a.DirtyFlags.Bounds,!0}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.prepareOverride=function(c,d,e,f,g){return a.Size.copyTo(g,d.availableSize),a.Thickness.shrinkSize(c.margin,d.availableSize),b.helpers.coerceSize(d.availableSize,c),!0}}(d=c.tapins||(c.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.validate=function(b,c,d,e,f){return isNaN(f.width)||isNaN(f.height)?(a.layoutError(e,this,"Cannot call Measure using a size with NaN values."),!1):!0}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.validateVisibility=function(b,c,d,e,f){if(b.visibility!==a.Visibility.Visible){a.Size.copyTo(f,d.previousConstraint);var g=d.desiredSize;return g.width=g.height=0,!1}return!0}}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("processRenderVisibility",b.tapins.processRenderVisibility).addTapin("processHitTestVisibility",b.tapins.processHitTestVisibility).addTapin("calcXformOrigin",b.tapins.calcXformOrigin).addTapin("processLocalXform",b.tapins.processLocalXform).addTapin("calcRenderXform",b.tapins.calcRenderXform).addTapin("calcAbsoluteXform",b.tapins.calcAbsoluteXform).addTapin("processXform",b.tapins.processXform).addTapin("processLayoutClip",b.tapins.processLayoutClip).addTapin("propagateDirtyToChildren",b.tapins.propagateDirtyToChildren)}return __extends(d,c),d.prototype.createState=function(){return{xformOrigin:new a.Point,localXform:a.mat3.identity(),subtreeDownDirty:0}},d.prototype.createOutput=function(){return{totalIsRenderVisible:!1,totalOpacity:1,totalIsHitTestVisible:!1,z:NaN,compositeLayoutClip:new a.Rect,renderXform:a.mat3.identity(),absoluteXform:a.mat3.identity(),dirtyFlags:0,newUpDirty:0}},d.prototype.prepare=function(b,c,d,e,f){(b.dirtyFlags&a.DirtyFlags.LocalTransform)>0&&(b.dirtyFlags|=a.DirtyFlags.Transform),d.dirtyFlags=b.dirtyFlags,d.totalIsRenderVisible=b.totalIsRenderVisible,d.totalOpacity=b.totalOpacity,d.totalIsHitTestVisible=b.totalIsHitTestVisible,d.z=b.z,a.Rect.copyTo(b.compositeLayoutClip,d.compositeLayoutClip),a.mat3.copyTo(b.renderXform,d.renderXform),a.mat3.copyTo(b.absoluteXform,d.absoluteXform),c.subtreeDownDirty=0},d.prototype.flush=function(b,c,d,e,f){d.newUpDirty=d.dirtyFlags&~b.dirtyFlags&a.DirtyFlags.UpDirtyState,b.dirtyFlags=d.dirtyFlags&~a.DirtyFlags.DownDirtyState,b.totalIsRenderVisible=d.totalIsRenderVisible,b.totalOpacity=d.totalOpacity,b.totalIsHitTestVisible=d.totalIsHitTestVisible,b.z=d.z,a.Rect.copyTo(d.compositeLayoutClip,b.compositeLayoutClip),a.mat3.copyTo(d.renderXform,b.renderXform),a.mat3.copyTo(d.absoluteXform,b.absoluteXform)},d}(a.pipe.TriPipeDef);b.ProcessDownPipeDef=c}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.calcAbsoluteXform=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.Transform))return!0;var g=d.absoluteXform;return e?a.mat3.multiply(d.renderXform,e.absoluteXform,g):a.mat3.copyTo(d.renderXform,g),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.calcRenderXform=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.Transform))return!0;var g=d.renderXform;return b.carrierXform?a.mat3.multiply(b.carrierXform,b.layoutXform,g):a.mat3.copyTo(b.layoutXform,g),a.mat3.multiply(g,c.localXform,g),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.calcXformOrigin=function(a,b,c,d,e){var f=b.xformOrigin,g=a.renderTransformOrigin;return g?(f.x=a.actualWidth*g.x,f.y=a.actualHeight*g.y):(f.x=0,f.y=0),!0}}(b=a.tapins||(a.tapins={}))}(b=a.processdown||(a.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processHitTestVisibility=function(b,c,d,e,f){return 0===(b.dirtyFlags&a.DirtyFlags.HitTestVisibility)?!0:(e?d.totalIsHitTestVisible=e.totalIsHitTestVisible&&b.isHitTestVisible:d.totalIsHitTestVisible=b.isHitTestVisible,d.totalIsHitTestVisible!==b.totalIsHitTestVisible&&(c.subtreeDownDirty|=a.DirtyFlags.HitTestVisibility),!0)}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processLayoutClip=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.LayoutClip))return!0;var g=b.layoutClip,h=d.compositeLayoutClip;return!e||a.Rect.isEmpty(e.compositeLayoutClip)?a.Rect.copyTo(g,h):(a.Rect.copyTo(e.compositeLayoutClip,h),a.Rect.isEmpty(g)||a.Rect.intersection(h,g)),a.Rect.isEqual(b.compositeLayoutClip,d.compositeLayoutClip)||(c.subtreeDownDirty|=a.DirtyFlags.LayoutClip),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processLocalXform=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.LocalTransform))return!0;var g=a.mat3.identity(c.localXform),h=b.renderTransform;if(!h)return!0;var i=c.xformOrigin;return a.mat3.translate(g,i.x,i.y),a.mat3.multiply(g,h.getRaw(),g),a.mat3.translate(g,-i.x,-i.y),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processRenderVisibility=function(b,c,d,e,f){return 0===(b.dirtyFlags&a.DirtyFlags.RenderVisibility)?!0:(d.dirtyFlags|=a.DirtyFlags.Bounds,e?(d.totalOpacity=e.totalOpacity*b.opacity,d.totalIsRenderVisible=e.totalIsRenderVisible&&b.visibility===a.Visibility.Visible):(d.totalOpacity=b.opacity,d.totalIsRenderVisible=b.visibility===a.Visibility.Visible),b.totalIsRenderVisible!==d.totalIsRenderVisible&&(d.dirtyFlags|=a.DirtyFlags.NewBounds,c.subtreeDownDirty|=a.DirtyFlags.RenderVisibility),b.totalOpacity!==d.totalOpacity&&(c.subtreeDownDirty|=a.DirtyFlags.RenderVisibility),!0)}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processXform=function(b,c,d,e,f){return 0===(b.dirtyFlags&a.DirtyFlags.Transform)?!0:(a.mat3.equal(b.renderXform,d.renderXform)?a.mat3.equal(b.absoluteXform,d.absoluteXform)||(c.subtreeDownDirty|=a.DirtyFlags.Transform):(d.dirtyFlags|=a.DirtyFlags.NewBounds,c.subtreeDownDirty|=a.DirtyFlags.Transform),d.dirtyFlags|=a.DirtyFlags.Bounds,!0)}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.propagateDirtyToChildren=function(c,d,e,f,g){var h=d.subtreeDownDirty&a.DirtyFlags.PropagateDown;if(0===h)return!0;for(var i=g.walk();i.step();)i.current.assets.dirtyFlags|=h,b.Updater.$$addDownDirty(i.current);return!0}}(d=c.tapins||(c.tapins={}))}(c=b.processdown||(b.processdown={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("calcActualSize",b.tapins.calcActualSize).addTapin("calcExtents",b.tapins.calcExtents).addTapin("calcPaintBounds",b.tapins.calcPaintBounds).addTapin("processBounds",b.tapins.processBounds).addTapin("processNewBounds",b.tapins.processNewBounds).addTapin("processInvalidate",b.tapins.processInvalidate)}return __extends(d,c),d.prototype.createState=function(){return{invalidateSubtreePaint:!1,actualSize:new a.Size,hasNewBounds:!1,hasInvalidate:!1}},d.prototype.createOutput=function(){return{extents:new a.Rect,extentsWithChildren:new a.Rect,globalBoundsWithChildren:new a.Rect,surfaceBoundsWithChildren:new a.Rect,dirtyFlags:0,dirtyRegion:new a.Rect,forceInvalidate:!1}},d.prototype.prepare=function(b,c,d){d.dirtyFlags=b.dirtyFlags,a.Rect.copyTo(b.extents,d.extents),a.Rect.copyTo(b.extentsWithChildren,d.extentsWithChildren),a.Rect.copyTo(b.globalBoundsWithChildren,d.globalBoundsWithChildren),a.Rect.copyTo(b.surfaceBoundsWithChildren,d.surfaceBoundsWithChildren),a.Rect.copyTo(b.dirtyRegion,d.dirtyRegion),d.forceInvalidate=b.forceInvalidate},d.prototype.flush=function(b,c,d){b.dirtyFlags=d.dirtyFlags&~a.DirtyFlags.UpDirtyState,a.Rect.copyTo(d.extents,b.extents),a.Rect.copyTo(d.extentsWithChildren,b.extentsWithChildren),a.Rect.copyTo(d.globalBoundsWithChildren,b.globalBoundsWithChildren),a.Rect.copyTo(d.surfaceBoundsWithChildren,b.surfaceBoundsWithChildren),a.Rect.copyTo(d.dirtyRegion,b.dirtyRegion),b.forceInvalidate=d.forceInvalidate},d}(a.pipe.TriPipeDef);b.ProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.calcActualSize=function(c,d,e,f){if(0===(c.dirtyFlags&a.DirtyFlags.Bounds))return!0;var g=d.actualSize;return g.width=c.actualWidth,g.height=c.actualHeight,b.helpers.coerceSize(g,c),isNaN(g.width)&&(g.width=0),isNaN(g.height)&&(g.height=0),!0}}(d=c.tapins||(c.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.calcExtents=function(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;
var f=d.extents,g=d.extentsWithChildren;f.x=g.x=0,f.y=g.y=0;var h=c.actualSize;f.width=g.width=h.width,f.height=g.height=h.height;for(var i,j=e.walk();j.step();)i=j.current.assets,i.totalIsRenderVisible&&a.Rect.union(g,i.globalBoundsWithChildren);return!0}}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.calcPaintBounds=function(c,d,e,f){return 0===(c.dirtyFlags&a.DirtyFlags.Bounds)?!0:(b.helpers.intersectBoundsWithClipPath(e.globalBoundsWithChildren,e.extentsWithChildren,c.effectPadding,c.renderXform,c.clip,c.layoutClip),b.helpers.intersectBoundsWithClipPath(e.surfaceBoundsWithChildren,e.extentsWithChildren,c.effectPadding,c.absoluteXform,c.clip,c.layoutClip),!0)}}(d=c.tapins||(c.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processBounds=function(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;if(c.hasNewBounds=!1,a.Rect.isEqual(b.globalBoundsWithChildren,d.globalBoundsWithChildren))(!a.Rect.isEqual(b.extentsWithChildren,d.extentsWithChildren)||b.forceInvalidate)&&(c.hasNewBounds=!0);else{var f=e.visualOwner;f.updateBounds(),f.invalidate(b.surfaceBoundsWithChildren),c.hasNewBounds=!0}return d.forceInvalidate=!1,!0}}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processInvalidate=function(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Invalidate)&&!c.hasInvalidate)return!0;var f=d.dirtyRegion;return e.visualOwner.invalidate(f),f.x=f.y=f.width=f.height=0,!0}}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.processNewBounds=function(b,c,d,e){return 0!==(b.dirtyFlags&a.DirtyFlags.NewBounds)||c.hasNewBounds?(d.dirtyFlags|=a.DirtyFlags.Invalidate,c.hasInvalidate=!0,a.Rect.union(d.dirtyRegion,d.surfaceBoundsWithChildren),!0):!0}}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(b=a.core||(a.core={}))}(minerva||(minerva={})),CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b){return!1});var minerva;!function(a){var b;!function(b){var c;!function(b){function c(){var a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");return null!=a.exec(navigator.userAgent)?parseFloat(RegExp.$1):-1}var d=.55228475,e=["butt","square","round","butt"],f=["miter","bevel","round"],g=function(){function b(c){this.$$transforms=[],this.currentTransform=a.mat3.identity(),Object.defineProperty(this,"raw",{value:c,writable:!1}),Object.defineProperty(this,"currentTransform",{value:a.mat3.identity(),writable:!1}),Object.defineProperty(this,"hasFillRule",{value:b.hasFillRule,writable:!1})}return Object.defineProperty(b,"hasFillRule",{get:function(){if("Microsoft Internet Explorer"===navigator.appName){var a=c();return 0>a||a>10}return!0},enumerable:!0,configurable:!0}),b.prototype.resize=function(a,b){var c=this.raw.canvas;c.width=a,c.height=b},b.prototype.save=function(){this.$$transforms.push(a.mat3.create(this.currentTransform)),this.raw.save()},b.prototype.restore=function(){var b=this.$$transforms.pop();b&&a.mat3.copyTo(b,this.currentTransform),this.raw.restore()},b.prototype.setTransform=function(b,c,d,e,f,g){a.mat3.copyTo([b,c,d,e,f,g],this.currentTransform),this.raw.setTransform(b,c,d,e,f,g)},b.prototype.resetTransform=function(){a.mat3.identity(this.currentTransform);var b=this.raw;b.resetTransform&&b.resetTransform()},b.prototype.transform=function(b,c,d,e,f,g){var h=this.currentTransform;a.mat3.multiply(h,a.mat3.create([b,c,d,e,f,g]),h),this.raw.transform(b,c,d,e,f,g)},b.prototype.scale=function(b,c){a.mat3.scale(this.currentTransform,b,c),this.raw.scale(b,c)},b.prototype.rotate=function(b){var c=this.currentTransform,d=a.mat3.createRotate(b);a.mat3.multiply(c,d,c),this.raw.rotate(b)},b.prototype.translate=function(b,c){a.mat3.translate(this.currentTransform,b,c),this.raw.translate(b,c)},b.prototype.transformMatrix=function(b){var c=this.currentTransform;a.mat3.multiply(c,b,c),this.raw.setTransform(c[0],c[1],c[2],c[3],c[4],c[5])},b.prototype.pretransformMatrix=function(b){var c=this.currentTransform;a.mat3.multiply(b,c,c),this.raw.setTransform(c[0],c[1],c[2],c[3],c[4],c[5])},b.prototype.clipGeometry=function(a){a.Draw(this),this.raw.clip()},b.prototype.clipRect=function(a){var b=this.raw;b.beginPath(),b.rect(a.x,a.y,a.width,a.height),b.clip()},b.prototype.fillEx=function(b,c,d){var e=this.raw;if(b.setupBrush(e,c),e.fillStyle=b.toHtml5Object(),null==d)e.fillRule=e.msFillRule="nonzero",e.fill();else{var f=d===a.FillRule.EvenOdd?"evenodd":"nonzero";e.fillRule=e.msFillRule=f,e.fill(f)}},b.prototype.drawRectEx=function(b,c){var e=this.raw;if(!c||a.CornerRadius.isEmpty(c))return void e.rect(b.x,b.y,b.width,b.height);var f=Math.max(c.topLeft+c.topRight-b.width,0)/2,g=Math.max(c.bottomLeft+c.bottomRight-b.width,0)/2,h=Math.max(c.topLeft+c.bottomLeft-b.height,0)/2,i=Math.max(c.topRight+c.bottomRight-b.height,0)/2,j=c.topLeft-f;e.moveTo(b.x+j,b.y);var k=c.topRight-f,l=c.topRight-i;e.lineTo(b.x+b.width-k,b.y),e.bezierCurveTo(b.x+b.width-k+k*d,b.y,b.x+b.width,b.y+l-l*d,b.x+b.width,b.y+l);var m=c.bottomRight-i,n=c.bottomRight-g;e.lineTo(b.x+b.width,b.y+b.height-m),e.bezierCurveTo(b.x+b.width,b.y+b.height-m+m*d,b.x+b.width+n*d-n,b.y+b.height,b.x+b.width-n,b.y+b.height);var o=c.bottomLeft-g,p=c.bottomLeft-h;e.lineTo(b.x+o,b.y+b.height),e.bezierCurveTo(b.x+o-o*d,b.y+b.height,b.x,b.y+b.height-p+p*d,b.x,b.y+b.height-p);var q=c.topLeft-h;e.lineTo(b.x,b.y+q),e.bezierCurveTo(b.x,b.y+q-q*d,b.x+j-j*d,b.y,b.x+j,b.y)},b.prototype.isPointInStrokeEx=function(a,b,c){var d=this.raw;return d.lineWidth=a.strokeThickness,d.lineCap=e[a.strokeStartLineCap||a.strokeEndLineCap||0]||e[0],d.lineJoin=f[a.strokeLineJoin||0]||f[0],d.miterLimit=a.strokeMiterLimit,d.isPointInStroke(b,c)},b}();b.RenderContext=g}(c=b.render||(b.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("validate",b.tapins.validate).addTapin("validateRegion",b.tapins.validateRegion).addTapin("prepareContext",b.tapins.prepareContext).addTapin("applyClip",b.tapins.applyClip).addTapin("preRender",b.tapins.preRender).addTapin("doRender",b.tapins.doRender).addTapin("postRender",b.tapins.postRender).addTapin("renderChildren",b.tapins.renderChildren).addTapin("restoreContext",b.tapins.restoreContext)}return __extends(d,c),d.prototype.createState=function(){return{renderRegion:new a.Rect}},d.prototype.createOutput=function(){return{}},d}(a.pipe.TriPipeDef);b.RenderPipeDef=c}(c=b.render||(b.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.applyClip=function(a,b,c,d,e,f){var g=a.clip;return g&&d.clipGeometry(g),!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.doRender=function(a,b,c,d,e,f){return!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.postRender=function(a,b,c,d,e,f){var g=a.effect;return g?(g.PostRender(d),d.restore(),!0):!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.preRender=function(a,b,c,d,e,f){var g=a.effect;return g?(d.save(),g.PreRender(d),!0):!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.prepareContext=function(a,b,c,d,e,f){return d.save(),d.pretransformMatrix(a.renderXform),d.raw.globalAlpha=a.totalOpacity,!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.renderChildren=function(b,c,d,e,f,g){for(var h=g.walk(a.WalkDirection.ZForward);h.step();)h.current.render(e,c.renderRegion);return!0}}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.restoreContext=function(a,b,c,d,e,f){return d.restore(),!0}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.validate=function(a,b,c,d,e,f){return!!a.totalIsRenderVisible&&255*a.totalOpacity>=.5}}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){b.validateRegion=function(b,c,d,e,f,g){var h=c.renderRegion;return a.Rect.copyTo(b.surfaceBoundsWithChildren,h),a.Rect.roundOut(h),a.Rect.intersection(h,f),h.width>0&&h.height>0}}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapin("calcUseRender",b.tapins.calcUseRender).addTapin("computeActual",b.tapins.computeActual)}return __extends(d,c),d.prototype.createState=function(){return{useRender:!1}},d.prototype.createOutput=function(){return{actualSize:new a.Size}},d.prototype.prepare=function(a,b,c,d){},d.prototype.flush=function(a,b,c,d){var e=c.actualSize;a.actualWidth=e.width,a.actualHeight=e.height},d}(a.pipe.TriPipeDef);b.SizingPipeDef=c}(c=b.sizing||(b.sizing={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.calcUseRender=function(a,b,c,d){return b.useRender=!0,!0}}(b=a.tapins||(a.tapins={}))}(b=a.sizing||(a.sizing={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){c.computeActual=function(c,d,e,f){var g=e.actualSize;return g.width=g.height=0,c.visibility!==a.Visibility.Visible?!0:d.useRender?(a.Size.copyTo(c.renderSize,g),!0):(b.helpers.coerceSize(g,c),!0)}}(d=c.tapins||(c.tapins={}))}(c=b.sizing||(b.sizing={}))}(b=a.core||(a.core={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setTree(new b.BorderUpdaterTree).setMeasurePipe(a.singleton(b.measure.BorderMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.BorderArrangePipeDef)).setRenderPipe(a.singleton(a.core.render.RenderContext.hasFillRule?b.render.BorderRenderPipeDef:b.render.ShimBorderRenderPipeDef)).setHitTestPipe(a.singleton(b.hittest.BorderHitTestPipeDef));var d=this.assets;d.padding=new a.Thickness,d.borderThickness=new a.Thickness,d.cornerRadius=new a.CornerRadius,c.prototype.init.call(this)},d}(a.core.Updater);b.BorderUpdater=c}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.isLayoutContainer=!0,this.isContainer=!0}return __extends(b,a),b.prototype.walk=function(a){var b=!1,c=this;return{current:void 0,step:function(){return this.current=b?void 0:c.subtree,b=!0,null!=this.current}}},b}(a.core.UpdaterTree);b.BorderUpdaterTree=c}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(!e.subtree)return!0;var g=c.totalBorder;a.Thickness.copyTo(b.padding,g),a.Thickness.add(g,b.borderThickness);var h=c.childRect;return h.x=h.y=0,a.Size.copyTo(c.finalSize,h),a.Thickness.shrinkRect(g,h),!0}function d(b,c,d,e,f){return e.subtree&&e.subtree.arrange(c.childRect),a.Size.copyTo(c.finalSize,c.arrangedSize),!0}var e=function(b){function e(){b.call(this),this.addTapinBefore("doOverride","preOverride",c).replaceTapin("doOverride",d)}return __extends(e,b),e.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.totalBorder=new a.Thickness,c},e}(a.core.arrange.ArrangePipeDef);b.BorderArrangePipeDef=e,b.preOverride=c,b.doOverride=d}(c=b.arrange||(b.arrange={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("canHitInside",d.canHitInside)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.BorderHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return a.hitChildren?!0:a.assets.background||a.assets.borderBrush?!0:(c.shift(),d.restore(),!1)}a.canHitInside=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.totalBorder;return a.Thickness.copyTo(b.padding,g),a.Thickness.add(g,b.borderThickness),a.Thickness.shrinkSize(g,c.availableSize),!0}function d(b,c,d,e,f){var g=d.desiredSize;return e.subtree&&(e.subtree.measure(c.availableSize),a.Size.copyTo(e.subtree.assets.desiredSize,g)),!0}function e(b,c,d,e,f){return a.Thickness.growSize(c.totalBorder,d.desiredSize),a.Size.min(d.desiredSize,c.availableSize),!0}var f=function(b){function f(){b.call(this),this.addTapinBefore("doOverride","preOverride",c).replaceTapin("doOverride",d).addTapinAfter("doOverride","postOverride",e)}return __extends(f,b),f.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.totalBorder=new a.Thickness,c},f}(a.core.measure.MeasurePipeDef);b.BorderMeasurePipeDef=f,b.preOverride=c,b.doOverride=d,b.postOverride=e}(c=b.measure||(b.measure={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("doRender","calcShouldRender",b.tapins.calcShouldRender).addTapinBefore("doRender","calcInnerOuter",b.tapins.calcInnerOuter).replaceTapin("doRender",b.tapins.doRender)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.fillExtents=new a.Rect,b.innerCornerRadius=new a.CornerRadius,b.outerCornerRadius=new a.CornerRadius,b},d}(a.core.render.RenderPipeDef);b.BorderRenderPipeDef=c}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("doRender","calcBalanced",b.tapins.shim.calcBalanced).addTapinBefore("doRender","invalidatePattern",b.tapins.shim.invalidatePattern).addTapinBefore("doRender","createPattern",b.tapins.shim.createPattern).replaceTapin("doRender",b.tapins.shim.doRender)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.middleCornerRadius=new a.CornerRadius,b.strokeExtents=new a.Rect,b.pattern=null,b.oldMetrics=null,b},d}(b.BorderRenderPipeDef);b.ShimBorderRenderPipeDef=c}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){if(!c.shouldRender)return!0;a.Rect.copyTo(b.extents,c.fillExtents);var h=b.borderThickness;a.Thickness.shrinkRect(h,c.fillExtents);var i=c.innerCornerRadius;a.CornerRadius.copyTo(b.cornerRadius,i),a.Thickness.shrinkCornerRadius(h,i);var j=c.outerCornerRadius;return a.CornerRadius.copyTo(b.cornerRadius,j),a.Thickness.growCornerRadius(h,j),!0}b.calcInnerOuter=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){if(c.shouldRender=!1,!b.background&&!b.borderBrush)return!0;if(a.Rect.isEmpty(b.extents))return!0;var h=!b.borderBrush||!b.borderThickness||a.Thickness.isEmpty(b.borderThickness);return h&&!b.background?!0:(c.shouldRender=!0,!0)}b.calcShouldRender=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){if(!c.shouldRender)return!0;e.save(),a.core.helpers.renderLayoutClip(e,b,g);var h=b.borderBrush,i=b.extents,j=c.fillExtents,k=e.raw;h&&!a.Rect.isEmpty(i)&&(k.beginPath(),e.drawRectEx(i,c.outerCornerRadius),e.drawRectEx(j,c.innerCornerRadius),e.fillEx(h,i,a.FillRule.EvenOdd));var l=b.background;return l&&!a.Rect.isEmpty(j)&&(k.beginPath(),e.drawRectEx(j,c.innerCornerRadius),e.fillEx(l,j)),e.restore(),!0}b.doRender=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){if(!c.shouldRender||a.Thickness.isEmpty(b.borderThickness))return!0;if(a.Thickness.isBalanced(b.borderThickness)){var h=c.innerCornerRadius,i=c.outerCornerRadius,j=c.middleCornerRadius;j.topLeft=(h.topLeft+i.topLeft)/2,j.topRight=(h.topRight+i.topRight)/2,j.bottomRight=(h.bottomRight+i.bottomRight)/2,j.bottomLeft=(h.bottomLeft+i.bottomLeft)/2,a.Rect.copyTo(b.extents,c.strokeExtents);var k=b.borderThickness;a.Rect.shrink(c.strokeExtents,k.left/2,k.top/2,k.right/2,k.bottom/2)}return!0}b.calcBalanced=c}(c=b.shim||(b.shim={}))}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,e,f,g,h){return!c.shouldRender||a.Thickness.isBalanced(b.borderThickness)?!0:(c.pattern||(c.pattern=d(b.borderBrush,b.extents,c.fillExtents,c.outerCornerRadius,c.innerCornerRadius)),!0)}function d(b,c,d,f,g){e=e||new a.core.render.RenderContext(document.createElement("canvas").getContext("2d"));var h=e.raw;return a.Size.copyTo(c,h.canvas),h.beginPath(),e.drawRectEx(c,f),e.fillEx(b,c),h.globalCompositeOperation="xor",h.beginPath(),e.drawRectEx(d,g),h.fill(),h.createPattern(h.canvas,"no-repeat")}b.createPattern=c;var e}(c=b.shim||(b.shim={}))}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,g,h,i,j){return c.shouldRender?(h.save(),a.core.helpers.renderLayoutClip(h,b,j),b.background&&e(h,b,c),c.pattern?d(h,b,c):b.borderBrush&&f(h,b,c),h.restore(),!0):!0}function d(a,b,c){var d=a.raw;d.beginPath(),d.fillStyle=c.pattern,a.drawRectEx(b.extents,c.outerCornerRadius),d.fill()}function e(a,b,c){a.raw.beginPath(),a.drawRectEx(c.fillExtents,c.innerCornerRadius),a.fillEx(b.background,c.fillExtents)}function f(a,b,c){var d=a.raw;d.beginPath(),a.drawRectEx(c.strokeExtents,c.middleCornerRadius),d.lineWidth=b.borderThickness.left,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=0,b.borderBrush.setupBrush(d,c.strokeExtents),d.strokeStyle=b.borderBrush.toHtml5Object(),d.stroke()}b.doRender=c}(c=b.shim||(b.shim={}))}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,f,g,h,i){return c.shouldRender?a.Thickness.isEmpty(b.borderThickness)?(c.pattern=null,!0):c.oldMetrics?(e(b,c,c.oldMetrics)&&(c.pattern=null),d(b,c,c.oldMetrics),!0):(c.oldMetrics={},d(b,c,c.oldMetrics),c.pattern=null,!0):!0}function d(a,b,c){c.borderBrush=a.borderBrush,c.borderThickness=a.borderThickness,c.extents=a.extents,c.fillExtents=b.fillExtents,c.outerCornerRadius=b.outerCornerRadius,c.innerCornerRadius=b.innerCornerRadius}function e(b,c,d){return!(d.borderBrush===b.borderBrush&&a.Rect.isEqual(d.extents,b.extents)&&a.Rect.isEqual(d.fillExtents,c.fillExtents)&&a.CornerRadius.isEqual(d.outerCornerRadius,c.outerCornerRadius)&&a.CornerRadius.isEqual(d.innerCornerRadius,c.innerCornerRadius))}b.invalidatePattern=c}(c=b.shim||(b.shim={}))}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.border||(b.border={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){var d=this.assets;d.background=null,this.setTree(new b.PanelUpdaterTree).setMeasurePipe(a.singleton(b.measure.PanelMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.PanelArrangePipeDef)).setProcessUpPipe(a.singleton(b.processup.PanelProcessUpPipeDef)).setRenderPipe(a.singleton(b.render.PanelRenderPipeDef)).setHitTestPipe(a.singleton(b.hittest.PanelHitTestPipeDef)),c.prototype.init.call(this)},d.prototype.setChildren=function(a){return this.tree.children=a,this},d}(a.core.Updater);b.PanelUpdater=c;var d;!function(a){function b(a,b,c){var d=a.tree.visualParent;d&&(d.tree.zSorted=null)}a.zIndex=b}(d=b.reactTo||(b.reactTo={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.CanvasMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.CanvasArrangePipeDef)).setProcessDownPipe(a.singleton(c.processdown.CanvasProcessDownPipeDef)).setProcessUpPipe(a.singleton(c.processup.CanvasProcessUpPipeDef));var d=this.assets;d.breakLayoutClip=!0,b.prototype.init.call(this)},d}(b.panel.PanelUpdater);c.CanvasUpdater=d;var e;!function(b){function c(a,b,c){f(a)}function e(a,b,c){f(a)}function f(b){var c=b.tree.visualParent;if(b instanceof d&&!c&&(b.assets.dirtyFlags|=a.DirtyFlags.LocalTransform,a.core.Updater.$$addDownDirty(b),b.invalidateArrange()),c instanceof d){var e=b.assets.layoutSlot;a.Size.copyTo(b.assets.desiredSize,e),e.x=b.getAttachedValue("Canvas.Left"),e.y=b.getAttachedValue("Canvas.Top"),b.assets.useLayoutRounding&&(e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=Math.round(e.width),e.height=Math.round(e.height)),b.invalidateArrange()}}b.left=c,b.top=e}(e=c.reactTo||(c.reactTo={}))}(c=b.canvas||(b.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doOverride",b.tapins.doOverride)}return __extends(c,a),c}(a.core.arrange.ArrangePipeDef);b.PanelArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doOverride",b.tapins.doOverride).replaceTapin("buildLayoutClip",b.tapins.buildLayoutClip)}return __extends(c,a),c}(a.panel.arrange.PanelArrangePipeDef);b.CanvasArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(b=a.canvas||(a.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=c.layoutClip;return f.x=f.y=f.width=f.height=0,!0}a.buildLayoutClip=b}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.canvas||(a.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){for(var g,h=c.childRect,i=e.walk();i.step();)g=i.current,a.Size.copyTo(g.assets.desiredSize,h),h.x=g.getAttachedValue("Canvas.Left")||0,h.y=g.getAttachedValue("Canvas.Top")||0,g.arrange(h);return!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.canvas||(b.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(a,b,c,d,e){var f=c.desiredSize;f.width=f.height=0;for(var g=d.walk();g.step();){g.current.measure(b.availableSize);var h=g.current.assets.desiredSize;f.width=Math.max(f.width,h.width),f.height=Math.max(f.height,h.height)}return!0}var d=function(a){function b(){a.call(this),this.replaceTapin("doOverride",c)}return __extends(b,a),b}(a.core.measure.MeasurePipeDef);b.PanelMeasurePipeDef=d}(c=b.measure||(b.measure={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doOverride",b.tapins.doOverride)}return __extends(c,a),c}(a.panel.measure.PanelMeasurePipeDef);b.CanvasMeasurePipeDef=c}(c=b.measure||(b.measure={}))}(b=a.canvas||(a.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=b.availableSize;f.width=f.height=Number.POSITIVE_INFINITY;for(var g=d.walk();g.step();)g.current.measure(f);var h=c.desiredSize;return h.width=h.height=0,!0}a.doOverride=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.canvas||(a.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("processLayoutClip",d.processLayoutClip)}return __extends(b,a),b}(a.core.processdown.ProcessDownPipeDef);b.CanvasProcessDownPipeDef=c;var d;!function(b){function c(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.LayoutClip))return!0;var g=b.compositeLayoutClip;return g.x=g.y=g.width=g.height,!0}b.processLayoutClip=c}(d=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.canvas||(b.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("calcPaintBounds",b.tapins.calcPaintBounds)}return __extends(c,a),c}(a.core.processup.ProcessUpPipeDef);b.CanvasProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(c=b.canvas||(b.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){b.calcPaintBounds=function(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;a.core.helpers.intersectBoundsWithClipPath(d.globalBoundsWithChildren,d.extentsWithChildren,b.effectPadding,b.renderXform,b.clip,b.layoutClip);var f=d.surfaceBoundsWithChildren,g=e.surface;return g&&e.isTop?(f.x=f.y=0,f.width=g.width,f.height=g.height):a.core.helpers.intersectBoundsWithClipPath(f,d.extentsWithChildren,b.effectPadding,b.absoluteXform,b.clip,b.layoutClip),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.canvas||(b.canvas={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setTree(new b.ControlUpdaterTree).setHitTestPipe(a.singleton(b.hittest.ControlHitTestPipeDef)),this.assets.isEnabled=!0,c.prototype.init.call(this)},d}(a.core.Updater);b.ControlUpdater=c}(c=b.control||(b.control={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.isContainer=!0,this.isLayoutContainer=!0}return __extends(b,a),b}(a.core.UpdaterTree);b.ControlUpdaterTree=c}(c=b.control||(b.control={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.addTapinBefore("canHit","shouldSkip",d.shouldSkip).replaceTapin("canHitInside",d.canHitInside)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.ControlHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return!!a.assets.isEnabled}function c(a,b,c,d){return a.hitChildren?!0:(c.shift(),d.restore(),!1)}a.shouldSkip=b,a.canHitInside=c}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.control||(b.control={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){!function(a){a[a.Auto=0]="Auto",a[a.Pixel=1]="Pixel",a[a.Star=2]="Star"}(a.GridUnitType||(a.GridUnitType={}));a.GridUnitType}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.GridMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.GridArrangePipeDef)).setProcessUpPipe(a.singleton(c.processup.GridProcessUpPipeDef)).setRenderPipe(a.singleton(c.render.GridRenderPipeDef));var d=this.assets;d.showGridLines=!1,d.columnDefinitions=[],d.rowDefinitions=[],d.gridState=c.createGridState(),b.prototype.init.call(this)},d}(b.panel.PanelUpdater);c.GridUpdater=d;var e;!function(a){function b(a){var b=a.tree.visualParent;b instanceof d&&b.invalidateMeasure(),a.invalidateMeasure()}function c(a,b,c){a.invalidateMeasure(),a.invalidate()}function e(a,c,d){b(a)}function f(a,c,d){b(a)}function g(a,c,d){b(a)}function h(a,c,d){b(a)}a.showGridLines=c,a.column=e,a.columnSpan=f,a.row=g,a.rowSpan=h}(e=c.reactTo||(c.reactTo={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(){return{rowMatrix:[],colMatrix:[]}}a.createGridState=b}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(){this.desired=0,this.offered=0,this.original=0,this.min=0,this.max=Number.POSITIVE_INFINITY,this.stars=0,this.type=a.GridUnitType.Pixel}return b.prototype.clamp=function(a){return a<this.min?this.min:a>this.max?this.max:a},b.init=function(b,c,d,e,f){return b.desired=0,b.stars=0,b.offered=c||0,b.min=d||0,b.max=null!=e?e:Number.POSITIVE_INFINITY,b.type=null!=f?f:a.GridUnitType.Pixel,b.offered<d?b.offered=d:b.offered>e&&(b.offered=e),b},b}();a.Segment=b}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function d(){
b.call(this),this.addTapinBefore("doOverride","restoreMeasureResults",c.tapins.restoreMeasureResults).addTapinBefore("doOverride","calcConsumed",c.tapins.calcConsumed).addTapinBefore("doOverride","setActuals",c.tapins.setActuals).replaceTapin("doOverride",c.tapins.doOverride)}return __extends(d,b),d.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.consumed=new a.Size,c},d}(b.panel.arrange.PanelArrangePipeDef);c.GridArrangePipeDef=d}(d=c.arrange||(c.arrange={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.consumed;g.width=g.height=0;for(var h=c.finalSize,i=b.gridState.colMatrix,j=0;j<i.length;j++)g.width+=i[j][j].offered=i[j][j].desired;for(var k=b.gridState.rowMatrix,j=0;j<k.length;j++)g.height+=k[j][j].offered=k[j][j].desired;return g.width!==h.width&&a.helpers.expandStarCols(i,b.columnDefinitions,h),g.height!==h.height&&a.helpers.expandStarRows(k,b.rowDefinitions,h),!0}b.calcConsumed=c}(c=b.tapins||(b.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){for(var g=c.childRect,h=b.gridState.rowMatrix,i=b.gridState.colMatrix,j=e.walk();j.step();){var k=j.current,l=Math.min(k.getAttachedValue("Grid.Column"),i.length-1);isNaN(l)&&(l=0);var m=Math.min(k.getAttachedValue("Grid.Row"),h.length-1);isNaN(m)&&(m=0);var n=Math.min(k.getAttachedValue("Grid.ColumnSpan"),i.length-l);isNaN(n)&&(n=1);var o=Math.min(k.getAttachedValue("Grid.RowSpan"),h.length-m);isNaN(o)&&(o=1),g.x=g.y=g.width=g.height=0;for(var p=0;l>p;p++)g.x+=i[p][p].offered;for(var p=l;l+n>p;p++)g.width+=i[p][p].offered;for(var p=0;m>p;p++)g.y+=h[p][p].offered;for(var p=m;m+o>p;p++)g.height+=h[p][p].offered;k.arrange(g)}return a.Size.copyTo(c.finalSize,c.arrangedSize),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){for(var f=a.gridState.rowMatrix,g=0;g<f.length;g++)for(var h=0;g>=h;h++)f[g][h].offered=f[g][h].original;for(var i=a.gridState.colMatrix,g=0;g<i.length;g++)for(var h=0;g>=h;h++)i[g][h].offered=i[g][h].original;return!0}a.restoreMeasureResults=b}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){for(var f=a.columnDefinitions,g=a.gridState.colMatrix,h=0;h<f.length;h++)f[h].setActualWidth(g[h][h].offered);for(var i=a.rowDefinitions,j=a.gridState.rowMatrix,h=0;h<i.length;h++)i[h].setActualHeight(j[h][h].offered);return!0}a.setActuals=b}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(c,d){for(var e=0;2>e;e++)for(var f=0===e?c:d,g=f.length,h=g-1;h>=0;h--)for(var i=h;i>=0;i--){for(var j=!1,k=h;k>=i;k--)j=j||f[k][k].type===a.GridUnitType.Star;for(var l=f[h][i].desired,m=0,n=h;n>=i;n--)m+=f[n][n].desired;if(l>m){var o=l-m;j?o=b.assignSize(f,i,h,o,a.GridUnitType.Star,!0):(o=b.assignSize(f,i,h,o,a.GridUnitType.Pixel,!0),o=b.assignSize(f,i,h,o,a.GridUnitType.Auto,!0))}}for(var e=0;e<c.length;e++)c[e][e].offered=c[e][e].desired;for(var e=0;e<f.length;e++)d[e][e].offered=d[e][e].desired}b.allocateDesiredSize=c}(b=a.helpers||(a.helpers={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(b,c,d,e,f,g){for(var h=0,i=!1,j=0,k=c;d>=k;k++){var l=b[k][k];j=g?l.desired:l.offered,j<l.max&&(h+=f===a.GridUnitType.Star?l.stars:1)}do{i=!1;var m=e/h;for(k=c;d>=k;k++)if(l=b[k][k],j=g?l.desired:l.offered,l.type===f&&j<l.max){var n=j;n+=m*(f===a.GridUnitType.Star?l.stars:1),n=Math.min(n,l.max),i=i||n>j,e-=n-j,g?l.desired=n:l.offered=n}}while(i);return e}b.assignSize=c}(b=a.helpers||(a.helpers={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(c,d,e){for(var f=e.width,g=0;g<c.length;g++){var h=c[g][g];h.type===a.GridUnitType.Star?h.offered=0:f=Math.max(f-h.offered,0)}f=b.assignSize(c,0,c.length-1,f,a.GridUnitType.Star,!1);for(var g=0;g<d.length;g++){var h=c[g][g];h.type===a.GridUnitType.Star&&d[g].setActualWidth(h.offered)}}b.expandStarCols=c}(b=a.helpers||(a.helpers={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(c,d,e){for(var f=e.height,g=0;g<c.length;g++){var h=c[g][g];h.type===a.GridUnitType.Star?h.offered=0:f=Math.max(f-h.offered,0)}f=b.assignSize(c,0,c.length-1,f,a.GridUnitType.Star,!1);for(var g=0;g<d.length;g++){var h=c[g][g];h.type===a.GridUnitType.Star&&d[g].setActualHeight(h.offered)}}b.expandStarRows=c}(b=a.helpers||(a.helpers={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.matrix=a,this.row=b,this.col=c,this.size=d}return a.row=function(b,c,d){return new a(b,c.row+c.rowspan-1,c.row,d.assets.desiredSize.height)},a.col=function(b,c,d){return new a(b,c.col+c.colspan-1,c.col,d.assets.desiredSize.width)},a}();a.GridChildPlacement=b}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){!function(a){a[a.AutoAuto=0]="AutoAuto",a[a.StarAuto=1]="StarAuto",a[a.AutoStar=2]="AutoStar",a[a.StarAutoAgain=3]="StarAutoAgain",a[a.NonStar=4]="NonStar",a[a.RemainingStar=5]="RemainingStar"}(b.OverridePass||(b.OverridePass={}));var c=b.OverridePass,d=function(){function b(){}return b.prototype.init=function(b,c,d){var e=this.col=Math.min(b.getAttachedValue("Grid.Column"),d.length-1);isNaN(e)&&(this.col=e=0);var f=this.row=Math.min(b.getAttachedValue("Grid.Row"),c.length-1);isNaN(f)&&(this.row=f=0);var g=this.colspan=Math.min(b.getAttachedValue("Grid.ColumnSpan"),d.length-e);isNaN(g)&&(this.colspan=g=1);var h=this.rowspan=Math.min(b.getAttachedValue("Grid.RowSpan"),c.length-f);isNaN(h)&&(this.rowspan=h=1),this.starRow=this.autoRow=this.starCol=this.autoCol=!1;for(var i=f;f+h>i;i++)this.starRow=this.starRow||c[i][i].type===a.GridUnitType.Star,this.autoRow=this.autoRow||c[i][i].type===a.GridUnitType.Auto;for(var i=e;e+g>i;i++)this.starCol=this.starCol||d[i][i].type===a.GridUnitType.Star,this.autoCol=this.autoCol||d[i][i].type===a.GridUnitType.Auto;return this},b.prototype.shouldMeasurePass=function(a,b,d){return b.width=b.height=0,this.autoRow&&this.autoCol&&!this.starRow&&!this.starCol?d!==c.AutoAuto?!1:(b.width=Number.POSITIVE_INFINITY,b.height=Number.POSITIVE_INFINITY,!0):this.starRow&&this.autoCol&&!this.starCol?d!==c.StarAuto&&d!==c.StarAutoAgain?!1:(d===c.AutoAuto&&a.hasAutoStar&&(b.height=Number.POSITIVE_INFINITY),b.width=Number.POSITIVE_INFINITY,!0):this.autoRow&&this.starCol&&!this.starRow?d!==c.AutoStar?!1:(b.height=Number.POSITIVE_INFINITY,!0):!this.autoRow&&!this.autoCol||this.starRow||this.starCol?this.starRow||this.starCol?d===c.RemainingStar:d===c.NonStar:d!==c.NonStar?!1:(this.autoRow&&(b.height=Number.POSITIVE_INFINITY),this.autoCol&&(b.width=Number.POSITIVE_INFINITY),!0)},b.prototype.size=function(a,b,c){for(var d=this.row;d<this.row+this.rowspan;d++)a.height+=b[d][d].offered;for(var d=this.col;d<this.col+this.colspan;d++)a.width+=c[d][d].offered},b}();b.GridChildShape=d}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function d(){b.call(this),this.addTapinBefore("doOverride","ensureRowMatrix",c.tapins.ensureRowMatrix).addTapinBefore("doOverride","prepareRowMatrix",c.tapins.prepareRowMatrix).addTapinBefore("doOverride","ensureColMatrix",c.tapins.ensureColMatrix).addTapinBefore("doOverride","prepareColMatrix",c.tapins.prepareColMatrix).addTapinBefore("doOverride","buildShape",c.tapins.buildShape).addTapinBefore("doOverride","doOverrideAutoAuto",c.tapins.createDoOverridePass(c.OverridePass.AutoAuto)).addTapinBefore("doOverride","doOverrideStarAuto",c.tapins.createDoOverridePass(c.OverridePass.StarAuto)).addTapinBefore("doOverride","doOverrideAutoStar",c.tapins.createDoOverridePass(c.OverridePass.AutoStar)).addTapinBefore("doOverride","doOverrideStarAutoAgain",c.tapins.createDoOverridePass(c.OverridePass.StarAutoAgain)).addTapinBefore("doOverride","doOverrideNonStar",c.tapins.createDoOverridePass(c.OverridePass.NonStar)).addTapinBefore("doOverride","doOverrideRemainingStar",c.tapins.createDoOverridePass(c.OverridePass.RemainingStar)).replaceTapin("doOverride",c.tapins.doOverride).addTapinAfter("doOverride","saveMeasureResults",c.tapins.saveMeasureResults)}return __extends(d,b),d.prototype.createState=function(){var d=b.prototype.createState.call(this);return d.totalStars=new a.Size,d.gridShape=new c.GridShape,d.childShapes=[],d.childSize=new a.Size,d.placements=[],d.placementIndex=0,d},d}(b.panel.measure.PanelMeasurePipeDef);c.GridMeasurePipeDef=d}(d=c.measure||(c.measure={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.hasAutoAuto=!1,this.hasStarAuto=!1,this.hasAutoStar=!1}return a.prototype.init=function(a){this.hasAutoAuto=this.hasStarAuto=this.hasAutoStar=!1;for(var b=0;b<a.length;b++){var c=a[b];this.hasAutoAuto=this.hasAutoAuto||c.autoRow&&c.autoCol&&!c.starRow&&!c.starCol,this.hasStarAuto=this.hasStarAuto||c.starRow&&c.autoCol,this.hasAutoStar=this.hasAutoStar||c.autoRow&&c.starCol}},a}();a.GridShape=b}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(b,c,d,e,f){for(var g=c.childShapes,h=b.gridState.colMatrix,i=b.gridState.rowMatrix,j=e.walk(),k=0;j.step();k++)k>g.length?g.push((new a.GridChildShape).init(j.current,i,h)):(g[k]=g[k]||new a.GridChildShape).init(j.current,i,h);return k<g.length&&g.slice(k,g.length-k),c.gridShape.init(c.childShapes),c.placements.length=0,c.placements.push(new a.GridChildPlacement(null,0,0,0)),c.placementIndex=0,!0}b.buildShape=c}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){function d(c){return function(d,e,f,g,h){var i=d.gridState.rowMatrix,j=d.gridState.colMatrix;g.children.length>0&&(a.helpers.expandStarCols(j,d.columnDefinitions,e.availableSize),a.helpers.expandStarRows(i,d.rowDefinitions,e.availableSize));for(var k,l=e.placements,m=l[0],n=e.childShapes,o=e.childSize,p=g.walk(),q=0;p.step();q++){var r=p.current,s=n[q];s.shouldMeasurePass(e.gridShape,o,c)&&(s.size(o,i,j),r.measure(o),c!==b.OverridePass.StarAuto&&(k=b.GridChildPlacement.row(i,s,r),k.row===k.col?l.splice(e.placementIndex+1,0,k):(l.splice(e.placementIndex,0,k),e.placementIndex++)),k=b.GridChildPlacement.col(j,s,r),k.row===k.col?l.splice(e.placementIndex+1,0,k):(l.splice(e.placementIndex,0,k),e.placementIndex++))}for(l.splice(e.placementIndex,1),e.placementIndex=-1;k=l.pop();){var t=k.matrix[k.row][k.col];t.desired=Math.max(t.desired,k.size),a.helpers.allocateDesiredSize(i,j)}return e.placementIndex=l.push(m)-1,!0}}c.createDoOverridePass=d}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=c.desiredSize;f.width=f.height=0;for(var g=a.gridState.colMatrix,h=0;h<g.length;h++)f.width+=g[h][h].desired;for(var i=a.gridState.rowMatrix,h=0;h<i.length;h++)f.height+=i[h][h].desired;return!0}a.doOverride=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=b.columnDefinitions.length||1,h=b.gridState.colMatrix;h.length>g&&h.splice(g,h.length-g);for(var i=0;g>i;i++){h.length<=i&&h.push([]);var j=h[i];j.length>i&&j.splice(i,j.length-i);for(var k=0;i>=k;k++)j.length<=k?j.push(new a.Segment):a.Segment.init(j[k])}return!0}b.ensureColMatrix=c}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=b.rowDefinitions.length||1,h=b.gridState.rowMatrix;h.length>g&&h.splice(g,h.length-g);for(var i=0;g>i;i++){h.length<=i&&h.push([]);var j=h[i];j.length>i+1&&j.splice(i,j.length-i-1);for(var k=0;i>=k;k++)j.length<=k?j.push(new a.Segment):a.Segment.init(j[k])}return!0}b.ensureRowMatrix=c}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,e,f,g){var h=b.columnDefinitions,i=b.gridState.colMatrix,j=c.totalStars;if(j.width=0,0===h.length){var k=i[0][0];return k.type=a.GridUnitType.Star,k.stars=1,j.width+=1,!0}for(var l=0;l<h.length;l++){var m=h[l],n=m.Width||d;m.setActualWidth(Number.POSITIVE_INFINITY);var o=a.Segment.init(i[l][l],0,m.MinWidth,m.MaxWidth,n.Type);n.Type===a.GridUnitType.Pixel?(o.desired=o.offered=o.clamp(n.Value),m.setActualWidth(o.desired)):n.Type===a.GridUnitType.Star?(o.stars=n.Value,j.width+=n.Value):n.Type===a.GridUnitType.Auto&&(o.desired=o.offered=o.clamp(0))}return!0}var d={Value:1,Type:a.GridUnitType.Star};b.prepareColMatrix=c}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,e,f,g){var h=b.rowDefinitions,i=b.gridState.rowMatrix,j=c.totalStars;if(j.height=0,0===h.length){var k=i[0][0];return k.type=a.GridUnitType.Star,k.stars=1,j.height+=1,!0}for(var l=0;l<h.length;l++){var m=h[l],n=m.Height||d;m.setActualHeight(Number.POSITIVE_INFINITY);var o=a.Segment.init(i[l][l],0,m.MinHeight,m.MaxHeight,n.Type);n.Type===a.GridUnitType.Pixel?(o.desired=o.offered=o.clamp(n.Value),m.setActualHeight(o.desired)):n.Type===a.GridUnitType.Star?(o.stars=n.Value,j.height+=n.Value):n.Type===a.GridUnitType.Auto&&(o.desired=o.offered=o.clamp(0))}return!0}var d={Value:1,Type:a.GridUnitType.Star};b.prepareRowMatrix=c}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){for(var f=a.gridState.rowMatrix,g=0;g<f.length;g++)for(var h=0;g>=h;h++)f[g][h].original=f[g][h].offered;for(var i=a.gridState.colMatrix,g=0;g<i.length;g++)for(h=0;g>=h;h++)i[g][h].original=i[g][h].offered;return!0}a.saveMeasureResults=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.addTapinBefore("calcExtents","preCalcExtents",b.tapins.preCalcExtents)}return __extends(c,a),c}(a.core.processup.ProcessUpPipeDef);b.PanelProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("preCalcExtents",b.tapins.preCalcExtents).replaceTapin("calcExtents",b.tapins.calcExtents)}return __extends(c,a),c}(a.panel.processup.PanelProcessUpPipeDef);b.GridProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(b=a.grid||(a.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=d.extents,g=d.extentsWithChildren;f.x=g.x=0,f.y=g.y=0;var h=c.actualSize;if(f.width=g.width=h.width,f.height=g.height=h.height,b.showGridLines)return!0;for(var i,j=e.walk();j.step();)i=j.current.assets,i.totalIsRenderVisible&&a.Rect.union(g,i.globalBoundsWithChildren);return!0}b.calcExtents=c}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;if(!b.background&&!b.showGridLines){var f=c.actualSize;f.width=f.height=0}return!0}b.preCalcExtents=c}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){var h=b.background;if(!h||h.isTransparent())return!0;var i=b.extents;if(a.Rect.isEmpty(i))return!0;e.save(),a.core.helpers.renderLayoutClip(e,b,g);var j=e.raw;return j.beginPath(),j.rect(i.x,i.y,i.width,i.height),e.fillEx(h,i),e.restore(),!0}var d=function(a){function b(){a.call(this),this.replaceTapin("doRender",c)}return __extends(b,a),b}(a.core.render.RenderPipeDef);b.PanelRenderPipeDef=d}(c=b.render||(b.render={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function c(){b.call(this),this.addTapinAfter("doRender","renderGridLines",e.renderGridLines)}return __extends(c,b),c.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.framework=new a.Size,c},c}(b.panel.render.PanelRenderPipeDef);c.GridRenderPipeDef=d;var e;!function(b){function c(b,c,d,e,f,g){if(!b.showGridLines)return!0;var h=c.framework;h.width=b.actualWidth,h.height=b.actualHeight,a.core.helpers.coerceSize(h,b);var i=e.raw;i.save();for(var j=b.columnDefinitions,k=0,l=0;k<j.length;k++)l+=j[k].ActualWidth,i.beginPath(),i.setLineDash([5]),i.moveTo(l,0),i.lineTo(l,h.height),i.stroke();for(var m=b.rowDefinitions,k=0,n=0;k<m.length;k++)n+=m[k].ActualHeight,i.beginPath(),i.setLineDash([5]),i.moveTo(0,n),i.lineTo(h.width,n),i.stroke();return i.restore(),!0}b.renderGridLines=c}(e=c.tapins||(c.tapins={}))}(d=c.render||(c.render={}))}(c=b.grid||(b.grid={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setMeasurePipe(a.singleton(b.measure.ImageMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.ImageArrangePipeDef)).setProcessDownPipe(a.singleton(b.processdown.ImageProcessDownPipeDef)).setRenderPipe(a.singleton(b.render.ImageRenderPipeDef)).setHitTestPipe(a.singleton(b.hittest.ImageHitTestPipeDef));var d=this.assets;d.source=null,d.stretch=a.Stretch.Uniform,d.overlap=a.RectOverlap.In,d.imgXform=a.mat3.identity(),c.prototype.init.call(this)},d.prototype.invalidateMetrics=function(){return this.assets.dirtyFlags|=a.DirtyFlags.ImageMetrics,a.core.Updater.$$addDownDirty(this),this},d}(a.core.Updater);b.ImageUpdater=c}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinAfter("invalidateFuture","invalidateMetrics",b.tapins.invalidateMetrics).addTapinBefore("doOverride","calcImageBounds",b.tapins.calcImageBounds).addTapinBefore("doOverride","calcStretch",b.tapins.calcStretch).replaceTapin("doOverride",b.tapins.doOverride)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.imageBounds=new a.Rect,b.stretchX=0,b.stretchY=0,b},d}(a.core.arrange.ArrangePipeDef);b.ImageArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=b.imageBounds;f.x=f.y=f.width=f.height=0,a.source&&(f.width=a.source.pixelWidth,f.height=a.source.pixelHeight);var g=b.finalSize;return 0===f.width&&(f.width=g.width),0===f.height&&(f.height=g.height),!0}a.calcImageBounds=b}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.imageBounds,h=1,i=1,j=c.finalSize;switch(g.width!==j.width&&(h=j.width/g.width),g.height!==j.height&&(i=j.height/g.height),b.stretch){case a.Stretch.Uniform:h=i=Math.min(h,i);break;case a.Stretch.UniformToFill:h=i=Math.max(h,i);break;case a.Stretch.None:h=i=1;break;case a.Stretch.Fill:}return c.stretchX=h,c.stretchY=i,!0}b.calcStretch=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=b.arrangedSize;return f.width=b.imageBounds.width*b.stretchX,f.height=b.imageBounds.height*b.stretchY,!0}a.doOverride=b}(b=a.tapins||(a.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){return d.dirtyFlags|=a.DirtyFlags.ImageMetrics,!0}b.invalidateMetrics=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.replaceTapin("insideChildren",b.tapins.insideChildren).replaceTapin("canHitInside",b.tapins.canHitInside).addTapinAfter("insideObject","insideStretch",b.tapins.insideStretch)}return __extends(d,c),d.prototype.prepare=function(b){b.imgRect=b.imgRect||new a.Rect},d}(a.core.hittest.HitTestPipeDef);b.ImageHitTestPipeDef=c}(c=b.hittest||(b.hittest={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return!0}a.canHitInside=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return c.unshift(a.updater),a.hitChildren=!1,!0}a.insideChildren=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){var f=b.assets.source;if(!f||0===f.pixelWidth||0===f.pixelHeight)return d.shift(),e.restore(),!1;var g=b.assets.stretch;if(g===a.Stretch.Fill||g===a.Stretch.UniformToFill)return!0;var h=b.imgRect;return h.x=h.y=0,h.width=f.pixelWidth,h.height=f.pixelHeight,a.Rect.transform(h,b.assets.imgXform),a.Rect.transform(h,e.currentTransform),a.Rect.containsPoint(h,c)?!0:(d.shift(),e.restore(),!1)}b.insideStretch=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("doOverride","calcImageBounds",b.tapins.calcImageBounds).addTapinBefore("doOverride","calcStretch",b.tapins.calcStretch).replaceTapin("doOverride",b.tapins.doOverride)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.imageBounds=new a.Rect,b.stretchX=0,b.stretchY=0,b},d}(a.core.measure.MeasurePipeDef);b.ImageMeasurePipeDef=c}(c=b.measure||(b.measure={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=b.imageBounds;return f.x=f.y=f.width=f.height=0,a.source?(f.width=a.source.pixelWidth,f.height=a.source.pixelHeight,!0):!0}a.calcImageBounds=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.availableSize,h=g.width,i=g.height,j=c.imageBounds;isFinite(h)||(h=j.width),isFinite(i)||(i=j.height);var k=0,l=0;switch(j.width>0&&(k=h/j.width),j.height>0&&(l=i/j.height),isFinite(g.width)||(k=l),isFinite(g.height)||(l=k),b.stretch){default:case a.Stretch.Uniform:k=l=Math.min(k,l);break;case a.Stretch.UniformToFill:k=l=Math.max(k,l);break;case a.Stretch.Fill:isFinite(g.width)||(k=l),isFinite(g.height)||(l=k);break;case a.Stretch.None:k=l=1}return c.stretchX=k,c.stretchY=l,!0}b.calcStretch=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=c.desiredSize;return f.width=b.imageBounds.width*b.stretchX,f.height=b.imageBounds.height*b.stretchY,!0}a.doOverride=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.image||(a.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("processLayoutClip","checkNeedImageMetrics",b.tapins.checkNeedImageMetrics).addTapinAfter("checkNeedImageMetrics","prepareImageMetrics",b.tapins.prepareImageMetrics).addTapinAfter("prepareImageMetrics","calcImageTransform",b.tapins.calcImageTransform).addTapinAfter("calcImageTransform","calcOverlap",b.tapins.calcOverlap)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.imgRect=new a.Rect,b.paintRect=new a.Rect,b.calcImageMetrics=!1,b.imgAdjust=!1,b},d.prototype.createOutput=function(){var b=c.prototype.createOutput.call(this);return b.imgXform=a.mat3.identity(),b.overlap=a.RectOverlap.In,b},d.prototype.prepare=function(b,d,e,f,g){c.prototype.prepare.call(this,b,d,e,f,g),e.overlap=b.overlap,a.mat3.copyTo(b.imgXform,e.imgXform)},d.prototype.flush=function(b,d,e,f,g){c.prototype.flush.call(this,b,d,e,f,g),b.overlap=e.overlap,a.mat3.copyTo(e.imgXform,b.imgXform)},d}(a.core.processdown.ProcessDownPipeDef);b.ImageProcessDownPipeDef=c}(c=b.processdown||(b.processdown={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(!c.calcImageMetrics)return!0;var g=c.paintRect.width,h=c.paintRect.height,i=c.imgRect.width,j=c.imgRect.height,k=g/i,l=h/j;0===g&&(k=1),0===h&&(l=1);var m=d.imgXform;if(b.stretch===a.Stretch.Fill)return a.mat3.createScale(k,l,m),!0;var n=1;switch(b.stretch){case a.Stretch.Uniform:n=l>k?k:l;break;case a.Stretch.UniformToFill:n=l>k?l:k;break;case a.Stretch.None:}var o=(g-n*i)/2,p=(h-n*j)/2;return a.mat3.createScale(n,n,m),a.mat3.translate(m,o,p),!0}b.calcImageTransform=c}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(!c.calcImageMetrics)return!0;if(b.stretch===a.Stretch.UniformToFill||c.imgAdjust){var g=c.paintRect;a.Rect.roundOut(g);var h=c.imgRect;a.Rect.transform(h,d.imgXform),a.Rect.roundIn(h),d.overlap=a.Rect.rectIn(g,h)}return!0}b.calcOverlap=c}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(c.calcImageMetrics=!1,0===(b.dirtyFlags&a.DirtyFlags.ImageMetrics))return!0;a.mat3.identity(d.imgXform),d.overlap=a.RectOverlap.In;var g=c.imgRect;return g.x=g.y=g.width=g.height=0,c.calcImageMetrics=!!b.source,!0}b.checkNeedImageMetrics=c}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(!c.calcImageMetrics)return!0;var g=c.imgRect;g.x=g.y=0;var h=b.source;h.lock(),g.width=h.pixelWidth,g.height=h.pixelHeight,h.unlock();var i=c.paintRect;return i.x=i.y=0,i.width=b.actualWidth,i.height=b.actualHeight,c.imgAdjust=!a.Size.isEqual(i,b.renderSize),b.stretch===a.Stretch.None&&a.Rect.union(i,g),!0}b.prepareImageMetrics=c}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doRender",b.tapins.doRender)}return __extends(c,a),c}(a.core.render.RenderPipeDef);b.ImageRenderPipeDef=c}(c=b.render||(b.render={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){var h=b.source;return h&&0!==h.pixelWidth&&0!==h.pixelHeight?(h.lock(),e.save(),a.core.helpers.renderLayoutClip(e,b,g),e.pretransformMatrix(b.imgXform),e.raw.drawImage(h.image,0,0),e.restore(),h.unlock(),!0):!0}b.doRender=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.image||(b.image={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setTree(new b.OverlayUpdaterTree).setProcessUpPipe(a.singleton(b.processup.OverlayProcessUpPipeDef)).setHitTestPipe(a.singleton(b.hittest.OverlayHitTestPipeDef));
var d=this.assets;d.isVisible=!1,d.isOpen=!1,c.prototype.init.call(this)},d.prototype.setInitiator=function(a){this.tree.initiatorSurface=a.tree.surface},d.prototype.setLayer=function(a){this.hide(),this.tree.layer=a,this.assets.isOpen&&this.show()},d.prototype.hide=function(){var a=this.tree.layer;if(!this.assets.isVisible||!a)return!1;this.assets.isVisible=!1;var b=this.tree.initiatorSurface;return b?(b.detachLayer(a),!0):!1},d.prototype.show=function(){var a=this.tree.layer;if(this.assets.isVisible||!a)return!1;this.assets.isVisible=!0;var b=this.tree.initiatorSurface;return b?(b.attachLayer(a),!0):!1},d}(a.core.Updater);b.OverlayUpdater=c;var d;!function(a){function b(a,b,c){c===!0?a.show():a.hide()}a.isOpen=b}(d=b.reactTo||(b.reactTo={}))}(c=b.overlay||(b.overlay={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.layer=void 0,this.initiatorSurface=void 0}return __extends(b,a),b}(a.core.UpdaterTree);b.OverlayUpdaterTree=c}(c=b.overlay||(b.overlay={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.addTapinBefore("canHit","shouldSkip",d.shouldSkip)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.OverlayHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return!!a.assets.isVisible}a.shouldSkip=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.overlay||(b.overlay={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.removeTapin("calcActualSize").removeTapin("calcExtents").removeTapin("calcPaintBounds")}return __extends(b,a),b}(a.core.processup.ProcessUpPipeDef);b.OverlayProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(c=b.overlay||(b.overlay={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){function c(a,b){var c,d=a.length,e={step:void 0,current:void 0};return b?(c=d,e.step=function(){return c--,0>c?(e.current=void 0,!1):(e.current=a[c],!0)}):(c=-1,e.step=function(){return c++,c>=d?(e.current=void 0,!1):(e.current=a[c],!0)}),e}function d(a,b){var c=a.getAttachedValue("Panel.ZIndex")||0,d=b.getAttachedValue("Panel.ZIndex")||0;return c===d?0:d>c?-1:1}var e=function(b){function e(){b.call(this),this.children=null,this.zSorted=null,this.isContainer=!0,this.isLayoutContainer=!0}return __extends(e,b),e.prototype.walk=function(b){return b===a.WalkDirection.ZForward||b===a.WalkDirection.ZReverse?(this.zSort(),c(this.zSorted,b===a.WalkDirection.ZReverse)):c(this.children,b===a.WalkDirection.Reverse)},e.prototype.zSort=function(){var a=this.zSorted;if(!a){a=this.zSorted=[];for(var b=this.walk();b.step();)a.push(b.current);a.sort(d)}},e.prototype.onChildAttached=function(a){this.zSorted=null},e.prototype.onChildDetached=function(a){this.zSorted=null},e}(a.core.UpdaterTree);b.PanelUpdaterTree=e}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.childRect;g.x=g.y=0,a.Size.copyTo(c.finalSize,g);for(var h=e.walk();h.step();)h.current.arrange(g);return a.Size.copyTo(c.finalSize,c.arrangedSize),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("canHitInside",d.canHitInside)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.PanelHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return a.hitChildren?!0:a.assets.background?!0:(c.shift(),d.restore(),!1)}a.canHitInside=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;if(!b.background){var f=c.actualSize;f.width=f.height=0}return!0}b.preCalcExtents=c}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.panel||(b.panel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setTree(new b.PopupUpdaterTree).setProcessDownPipe(a.singleton(b.processdown.PopupProcessDownPipeDef)).setProcessUpPipe(a.singleton(b.processup.PopupProcessUpPipeDef)).setHitTestPipe(a.singleton(b.hittest.PopupHitTestPipeDef));var d=this.assets;d.horizontalOffset=0,d.verticalOffset=0,d.isVisible=!1,d.isOpen=!1,c.prototype.init.call(this)},d.prototype.setInitiator=function(a){this.tree.initiatorSurface=a.tree.surface},d.prototype.setChild=function(b){var c=this.tree.popupChild;c&&(c.assets.carrierXform=null),this.tree.popupChild=b,b&&(b.assets.carrierXform=a.mat3.identity())},d.prototype.setLayer=function(a){this.hide(),this.tree.layer=a,this.assets.isOpen&&this.show()},d.prototype.hide=function(){var a=this.tree.layer;if(!this.assets.isVisible||!a)return!1;this.assets.isVisible=!1;var b=this.tree.initiatorSurface;return b?(b.detachLayer(a),!0):!1},d.prototype.show=function(){var a=this.tree.layer;if(this.assets.isVisible||!a)return!1;this.assets.isVisible=!0;var b=this.tree.initiatorSurface;return b?(b.attachLayer(a),!0):!1},d}(a.core.Updater);b.PopupUpdater=c;var d;!function(b){function c(a,b,c){c===!0?a.show():a.hide()}function d(a,b,c){var d=a.tree,e=d.popupChild;if(e){var g=c-b;0!==g&&(f(e,g,0),d.layer&&d.layer.invalidateMeasure())}}function e(a,b,c){var d=a.tree,e=d.popupChild;if(e){var g=c-b;0!==g&&(f(e,0,g),d.layer&&d.layer.invalidateMeasure())}}function f(b,c,d){b.assets.carrierXform&&a.mat3.translate(b.assets.carrierXform,c,d)}b.isOpen=c,b.horizontalOffset=d,b.verticalOffset=e}(d=b.reactTo||(b.reactTo={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.popupChild=void 0,this.layer=void 0,this.initiatorSurface=void 0}return __extends(b,a),b}(a.core.UpdaterTree);b.PopupUpdaterTree=c}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.addTapinBefore("canHit","shouldSkip",d.shouldSkip)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.PopupHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return!!a.assets.isVisible}a.shouldSkip=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.addTapinBefore("processXform","preProcessXform",b.tapins.preProcessXform).addTapinAfter("processXform","postProcessXform",b.tapins.postProcessXform)}return __extends(c,a),c}(a.core.processdown.ProcessDownPipeDef);b.PopupProcessDownPipeDef=c}(c=b.processdown||(b.processdown={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){b.postProcessXform=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.Transform))return!0;var g=f.popupChild;if(!g)return!0;g.assets.dirtyFlags|=a.DirtyFlags.LocalTransform;var h=g.assets.carrierXform;return h||(h=g.assets.carrierXform||a.mat3.create()),a.mat3.copyTo(d.absoluteXform,h),a.mat3.translate(h,b.horizontalOffset,b.verticalOffset),a.core.Updater.$$addDownDirty(g),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){b.preProcessXform=function(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.Transform))return!0;var g=f.popupChild;return g&&(g.assets.dirtyFlags|=a.DirtyFlags.LocalTransform,a.core.Updater.$$addDownDirty(g)),!0}}(c=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.removeTapin("calcActualSize").removeTapin("calcExtents").removeTapin("calcPaintBounds")}return __extends(b,a),b}(a.core.processup.ProcessUpPipeDef);b.PopupProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(c=b.popup||(b.popup={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setMeasurePipe(a.singleton(b.measure.ScrollContentPresenterMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.ScrollContentPresenterArrangePipeDef)).setRenderPipe(a.singleton(b.render.ScrollContentPresenterRenderPipeDef));var d=this.assets;d.internalClip=new a.Rect,d.scrollData={canHorizontallyScroll:!1,canVerticallyScroll:!1,offsetX:0,offsetY:0,cachedOffsetX:0,cachedOffsetY:0,viewportWidth:0,viewportHeight:0,extentWidth:0,extentHeight:0,maxDesiredWidth:0,maxDesiredHeight:0,invalidate:function(){}},c.prototype.init.call(this)},d}(a.core.Updater);b.ScrollContentPresenterUpdater=c}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.replaceTapin("doOverride",b.tapins.doOverride).addTapinAfter("completeOverride","updateClip",b.tapins.updateClip).addTapinAfter("updateClip","updateExtents",b.tapins.updateExtents)}return __extends(d,c),d.prototype.createOutput=function(){var b=c.prototype.createOutput.call(this);return b.internalClip=new a.Rect,b},d.prototype.prepare=function(b,d,e){a.Rect.copyTo(b.internalClip,e.internalClip),c.prototype.prepare.call(this,b,d,e)},d.prototype.flush=function(b,d,e){c.prototype.flush.call(this,b,d,e),a.Rect.copyTo(e.internalClip,b.internalClip)},d}(a.core.arrange.ArrangePipeDef);b.ScrollContentPresenterArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.arrangedSize;if(!e.subtree)return g.width=g.height=0,!0;var h=b.scrollData;a.helpers.clampOffsets(h)&&h.invalidate();var i=e.subtree.assets.desiredSize,j=c.childRect;return j.x=-h.offsetX,j.y=-h.offsetY,j.width=Math.max(c.finalSize.width,i.width),j.height=Math.max(c.finalSize.height,i.height),e.subtree.arrange(j),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.scrollcontentpresenter||(a.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=d.internalClip;return g.x=g.y=0,a.Size.copyTo(c.arrangedSize,g),!0}b.updateClip=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=b.scrollData,h=c.finalSize,i=g.viewportWidth!==h.width||g.viewportHeight!==h.height;return g.viewportWidth=h.width,g.viewportHeight=h.height,(a.helpers.clampOffsets(g)||i)&&g.invalidate(),!0}b.updateExtents=c}(c=b.tapins||(b.tapins={}))}(b=a.arrange||(a.arrange={}))}(b=a.scrollcontentpresenter||(a.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a){var b=!1,f=c(a,a.cachedOffsetX);e(f,a.offsetX)||(a.offsetX=f,b=!0);var g=d(a,a.cachedOffsetY);return e(g,a.offsetY)||(a.offsetY=g,b=!0),b}function c(a,b){return a.canHorizontallyScroll?Math.max(0,Math.min(b,a.extentWidth-a.viewportWidth)):0}function d(a,b){return a.canVerticallyScroll?Math.max(0,Math.min(b,a.extentHeight-a.viewportHeight)):0}function e(a,b){if(a===b)return!0;var c=(Math.abs(a)+Math.abs(b)+g)*f,d=a-b;return d>-c&&c>d}a.clampOffsets=b;var f=1.192093e-7,g=10}(b=a.helpers||(a.helpers={}))}(b=a.scrollcontentpresenter||(a.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.replaceTapin("doOverride",b.tapins.doOverride).addTapinAfter("doOverride","updateExtents",b.tapins.updateExtents).addTapinAfter("updateExtents","finishDoOverride",b.tapins.finishDoOverride)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.idealSize=new a.Size,b},d}(a.core.measure.MeasurePipeDef);b.ScrollContentPresenterMeasurePipeDef=c}(c=b.measure||(b.measure={}))}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.doOverride=function(a,b,c,d,e){var f=c.desiredSize;if(f.width=f.height=0,!d.subtree)return!0;var g=a.scrollData,h=b.idealSize;return h.width=g.canHorizontallyScroll?Number.POSITIVE_INFINITY:b.availableSize.width,h.height=g.canVerticallyScroll?Number.POSITIVE_INFINITY:b.availableSize.height,d.subtree.measure(h),!0}}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.scrollcontentpresenter||(a.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=d.desiredSize,h=b.scrollData;return a.Size.copyTo(c.availableSize,g),g.width=Math.min(g.width,h.extentWidth),g.height=Math.min(g.height,h.extentHeight),!0}b.finishDoOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=b.scrollData,h=c.availableSize,i=e.subtree.assets.desiredSize,j=g.viewportWidth!==h.width||g.viewportHeight!==h.height||g.extentWidth!==i.width||g.extentHeight!==i.height;return g.viewportWidth=h.width,g.viewportHeight=h.height,g.extentWidth=i.width,g.extentHeight=i.height,(a.helpers.clampOffsets(g)||j)&&g.invalidate(),!0}b.updateExtents=c}(c=b.tapins||(b.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.scrollcontentpresenter||(a.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.addTapinAfter("applyClip","applyInternalClip",d.applyInternalClip)}return __extends(b,a),b}(a.core.render.RenderPipeDef);b.ScrollContentPresenterRenderPipeDef=c;var d;!function(b){function c(b,c,d,e,f,g){return a.Rect.isEmpty(b.internalClip)?!0:(e.clipRect(b.internalClip),!0)}b.applyInternalClip=c}(d=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.scrollcontentpresenter||(b.scrollcontentpresenter={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.StackPanelMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.StackPanelArrangePipeDef)),this.assets.orientation=a.Orientation.Vertical,b.prototype.init.call(this)},d}(b.panel.PanelUpdater);c.StackPanelUpdater=d}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doOverride",b.tapins.doOverride).addTapinAfter("doOverride","doHorizontal",b.tapins.doHorizontal).addTapinAfter("doOverride","doVertical",b.tapins.doVertical)}return __extends(c,a),c}(a.panel.arrange.PanelArrangePipeDef);b.StackPanelArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(b=a.stackpanel||(a.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Horizontal)return!0;var g=c.finalSize,h=c.arrangedSize;h.width=0;for(var i,j,k=c.childRect,l=e.walk();l.step();)i=l.current,j=i.assets.desiredSize,j.height=g.height,a.Size.copyTo(j,k),k.x=h.width,a.Rect.isEmpty(k)&&(k.x=k.y=k.width=k.height=0),i.arrange(k),h.width+=j.width,h.height=Math.max(h.height,j.height);return h.width=Math.max(h.width,c.finalSize.width),!0}b.doHorizontal=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.childRect;return g.x=g.y=0,a.Size.copyTo(c.finalSize,g),a.Size.copyTo(c.finalSize,c.arrangedSize),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Vertical)return!0;var g=c.finalSize,h=c.arrangedSize;h.height=0;for(var i,j,k=c.childRect,l=e.walk();l.step();)i=l.current,j=i.assets.desiredSize,j.width=g.width,a.Size.copyTo(j,k),k.y=h.height,a.Rect.isEmpty(k)&&(k.x=k.y=k.width=k.height=0),i.arrange(k),h.width=Math.max(h.width,j.width),h.height+=j.height;return h.height=Math.max(h.height,c.finalSize.height),!0}b.doVertical=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function d(){b.call(this),this.replaceTapin("doOverride",c.tapins.doOverride).addTapinAfter("doOverride","doHorizontal",c.tapins.doHorizontal).addTapinAfter("doOverride","doVertical",c.tapins.doVertical)}return __extends(d,b),d.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.childAvailable=new a.Size,c},d}(b.panel.measure.PanelMeasurePipeDef);c.StackPanelMeasurePipeDef=d}(d=c.measure||(c.measure={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Horizontal)return!0;var g=c.childAvailable;g.height=c.availableSize.height;var h=b.height;isNaN(h)||(g.height=h),g.height=Math.max(Math.min(g.height,b.maxHeight),b.minHeight);for(var i,j,k=d.desiredSize,l=e.walk();l.step();)i=l.current,i.measure(g),j=i.assets.desiredSize,k.width+=j.width,k.height=Math.max(k.height,j.height);return!0}b.doHorizontal=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=b.childAvailable;f.width=f.height=Number.POSITIVE_INFINITY;var g=c.desiredSize;return g.width=g.height=0,!0}a.doOverride=b}(b=a.tapins||(a.tapins={}))}(b=a.measure||(a.measure={}))}(b=a.stackpanel||(a.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Vertical)return!0;var g=c.childAvailable;g.width=c.availableSize.width;var h=b.width;isNaN(h)||(g.width=h),g.width=Math.max(Math.min(g.width,b.maxWidth),b.minWidth);for(var i,j,k=d.desiredSize,l=e.walk();l.step();)i=l.current,i.measure(g),j=i.assets.desiredSize,k.height+=j.height,k.width=Math.max(k.width,j.width);return!0}b.doVertical=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.stackpanel||(b.stackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setTree(new b.TextBlockUpdaterTree).setMeasurePipe(a.singleton(b.measure.TextBlockMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.TextBlockArrangePipeDef)).setProcessUpPipe(a.singleton(b.processup.TextBlockProcessUpPipeDef)).setRenderPipe(a.singleton(b.render.TextBlockRenderPipeDef)).setHitTestPipe(a.singleton(b.hittest.TextBlockHitTestPipeDef)),this.setDocument();var d=this.assets;d.padding=new a.Thickness,d.selectionStart=0,d.selectionLength=0,d.textWrapping=a.TextWrapping.NoWrap,d.textAlignment=a.TextAlignment.Left,d.lineStackingStrategy=a.LineStackingStrategy.MaxHeight,d.lineHeight=NaN,c.prototype.init.call(this)},d.prototype.setDocument=function(b){return this.tree.doc?this:(this.tree.doc=a.text.createDocumentLayout(b||new a.text.DocumentLayoutDef),this)},d.prototype.invalidateFont=function(a){a===!0&&(this.invalidateMeasure(),this.invalidateArrange(),this.updateBounds(!0)),this.invalidate()},d.prototype.invalidateTextMetrics=function(){this.invalidateMeasure(),this.invalidateArrange(),this.updateBounds(!0),this.invalidate();var a=this.tree.doc.assets;a.actualWidth=NaN,a.actualHeight=NaN},d}(a.core.Updater);b.TextBlockUpdater=c}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.children=[]}return __extends(c,b),c.prototype.layout=function(b,c){var d=this.doc;return d.def.layout(c,d.assets,b,this.walkText()),new a.Size(d.assets.actualWidth,d.assets.actualHeight)},c.prototype.render=function(a,b){var c=this.doc;c.def.render(a,b,c.assets)},c.prototype.setAvailableWidth=function(a){this.doc.assets.availableWidth=a},c.prototype.getHorizontalOffset=function(a){var b=this.doc;return b.def.getHorizontalAlignmentX(a,b.assets,b.assets.actualWidth)},c.prototype.clearText=function(){this.children.length=0},c.prototype.walkText=function(){var a=-1,b=this.children;return{current:void 0,step:function(){return a++,this.current=b[a],void 0!==this.current}}},c.prototype.onTextAttached=function(a,b){null==b||0>b||b>=this.children.length?this.children.push(a):this.children.splice(b,0,a)},c.prototype.onTextDetached=function(a){var b=this.children.indexOf(a);b>-1&&this.children.splice(b,1)},c}(a.core.UpdaterTree);b.TextBlockUpdaterTree=c}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doOverride",d.doOverride)}return __extends(b,a),b}(a.core.arrange.ArrangePipeDef);b.TextBlockArrangePipeDef=c;var d;!function(b){function c(b,c,d,e,f){var g=c.finalSize,h=c.arrangedSize;return a.Thickness.shrinkSize(b.padding,g),a.Size.copyTo(e.layout(g,b),h),h.width=Math.max(h.width,g.width),h.height=Math.max(h.height,g.height),e.setAvailableWidth(g.width),a.Thickness.growSize(b.padding,h),!0}b.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("canHitInside",d.canHitInside)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.TextBlockHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return!0}a.canHitInside=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doOverride",d.doOverride)}return __extends(b,a),b}(a.core.measure.MeasurePipeDef);b.TextBlockMeasurePipeDef=c;var d;!function(b){function c(b,c,d,e,f){var g=d.desiredSize;return a.Thickness.shrinkSize(b.padding,c.availableSize),a.Size.copyTo(e.layout(c.availableSize,b),g),a.Thickness.growSize(b.padding,g),!0}b.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("calcActualSize",d.calcActualSize).replaceTapin("calcExtents",d.calcExtents)}return __extends(b,a),b}(a.core.processup.ProcessUpPipeDef);b.TextBlockProcessUpPipeDef=c;var d;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=c.actualSize;return f.width=Number.POSITIVE_INFINITY,f.height=Number.POSITIVE_INFINITY,a.core.helpers.coerceSize(f,b),a.Thickness.shrinkSize(b.padding,f),a.Size.copyTo(e.layout(f,b),f),a.Thickness.growSize(b.padding,f),!0}function d(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=d.extents;f.x=e.getHorizontalOffset(b),f.y=0,a.Size.copyTo(c.actualSize,f);var g=b.padding;return f.x+=g.left,f.y+=g.top,a.Rect.copyTo(f,d.extentsWithChildren),!0}b.calcActualSize=c,b.calcExtents=d}(d=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doRender",d.doRender)}return __extends(b,a),b}(a.core.render.RenderPipeDef);b.TextBlockRenderPipeDef=c;var d;!function(b){function c(b,c,d,e,f,g){e.save(),a.core.helpers.renderLayoutClip(e,b,g);var h=b.padding;return h&&e.translate(h.left,h.top),g.render(e,b),e.restore(),!0}b.doRender=c}(d=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.textblock||(b.textblock={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b=3,c=2,d=3,e=4,f=900,g=function(){function a(a){this.isEnabled=!0,this.isVisible=!1,this.$$blink_delay=f,this.$$timeout=0,this.$$onChange=a}return a.prototype.delay=function(){this.$disconnect(),this.$connect(d),this.$show()},a.prototype.begin=function(){0===this.$$timeout&&(this.$connect(e),this.$show())},a.prototype.end=function(){this.$disconnect(),this.$hide()},a.prototype.$connect=function(a){var c=this,d=this.$$blink_delay*a/b;this.$$timeout=window.setTimeout(function(){return c.$blink()},d)},a.prototype.$disconnect=function(){0!==this.$$timeout&&(window.clearTimeout(this.$$timeout),this.$$timeout=0)},a.prototype.$blink=function(){this.isVisible?(this.$hide(),this.$connect(c)):(this.$show(),this.$connect(e))},a.prototype.$show=function(){this.isVisible||(this.isVisible=!0,this.$$onChange&&this.$$onChange(!0))},a.prototype.$hide=function(){this.isVisible&&(this.isVisible=!1,this.$$onChange&&this.$$onChange(!1))},a}();a.Blinker=g}(b=a.textboxview||(a.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){var d=this;this.setTree(new b.TextBoxViewUpdaterTree).setMeasurePipe(a.singleton(b.measure.TextBoxViewMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.TextBoxViewArrangePipeDef)).setProcessUpPipe(a.singleton(b.processup.TextBoxViewProcessUpPipeDef)).setRenderPipe(a.singleton(b.render.TextBoxViewRenderPipeDef)).setHitTestPipe(a.singleton(b.hittest.TextBoxViewHitTestPipeDef)),this.setDocument();var e=this.assets;e.selectionStart=0,e.selectionLength=0,e.textWrapping=a.TextWrapping.NoWrap,e.textAlignment=a.TextAlignment.Left,e.lineStackingStrategy=a.LineStackingStrategy.MaxHeight,e.lineHeight=NaN,e.isCaretVisible=!1,e.caretBrush=null,e.caretRegion=new a.Rect,e.isReadOnly=!1,this.blinker=new b.Blinker(function(a){d.assets.isCaretVisible=a,d.invalidateCaret()}),c.prototype.init.call(this)},d.prototype.setDocument=function(b){return this.tree.doc?this:(this.tree.doc=a.text.createDocumentLayout(b||new a.text.DocumentLayoutDef),this)},d.prototype.getCursorFromPoint=function(a){var b=this.tree.doc;return b.def.getCursorFromPoint(a,this.assets,b.assets)},d.prototype.invalidateFont=function(a){a===!0&&(this.invalidateMeasure(),this.invalidateArrange(),this.updateBounds(!0)),this.invalidate()},d.prototype.invalidateTextMetrics=function(){return this.invalidateMeasure().invalidateArrange().updateBounds(!0).invalidate(),this},d.prototype.invalidateMeasure=function(){c.prototype.invalidateMeasure.call(this);var a=this.tree.doc.assets;return a.actualWidth=NaN,a.actualHeight=NaN,this},d.prototype.invalidateCaret=function(){var b=this.assets,c=new a.Rect;a.Rect.copyTo(b.caretRegion,c),a.Rect.transform(c,b.absoluteXform),this.invalidate(c)},d.prototype.invalidateSelectionStart=function(){this.tree.doc.assets.selCached=!1,this.invalidateCaretRegion(),this.resetCaretBlinker(!0)},d.prototype.invalidateSelectionLength=function(a){this.tree.doc.assets.selCached=!1,this.invalidate(),this.resetCaretBlinker(a),a&&this.invalidateCaretRegion()},d.prototype.invalidateCaretRegion=function(){this.invalidateCaret();var a=this.assets.caretRegion;a.x=a.y=a.width=a.height=0},d.prototype.resetCaretBlinker=function(a){var b=this.assets,c=this.blinker;return b.selectionLength>0||b.isReadOnly||!b.isFocused?c.end():a?c.delay():c.begin()},d}(a.core.Updater);b.TextBoxViewUpdater=c}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.children=[]}return __extends(c,b),c.prototype.layout=function(b,c){var d=this.doc;return d.def.layout(c,d.assets,b,this.walkText()),new a.Size(d.assets.actualWidth,d.assets.actualHeight)},c.prototype.render=function(a,b){var c=this.doc;c.def.render(a,b,c.assets)},c.prototype.setAvailableWidth=function(a){this.doc.assets.availableWidth=a},c.prototype.getHorizontalOffset=function(a){var b=this.doc;return b.def.getHorizontalAlignmentX(a,b.assets,b.assets.actualWidth)},c.prototype.getCaretRegion=function(a){var b=this.doc;return b.def.getCaretFromCursor(a,b.assets)},c.prototype.clearText=function(){this.children.length=0},c.prototype.walkText=function(){var a=-1,b=this.children;return{current:void 0,step:function(){return a++,this.current=b[a],void 0!==this.current}}},c.prototype.onTextAttached=function(a,b){null==b||0>b||b>=this.children.length?this.children.push(a):this.children.splice(b,0,a);
},c.prototype.onTextDetached=function(a){var b=this.children.indexOf(a);b>-1&&this.children.splice(b,1)},c}(a.core.UpdaterTree);b.TextBoxViewUpdaterTree=c}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doOverride",d.doOverride)}return __extends(b,a),b}(a.core.arrange.ArrangePipeDef);b.TextBoxViewArrangePipeDef=c;var d;!function(b){function c(b,c,d,e,f){var g=c.finalSize,h=c.arrangedSize;return a.Size.copyTo(e.layout(g,b),h),h.width=Math.max(h.width,g.width),h.height=Math.max(h.height,g.height),e.setAvailableWidth(g.width),!0}b.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("canHitInside",d.canHitInside)}return __extends(b,a),b}(a.core.hittest.HitTestPipeDef);b.TextBoxViewHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){return!0}a.canHitInside=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doOverride",d.doOverride)}return __extends(b,a),b}(a.core.measure.MeasurePipeDef);b.TextBoxViewMeasurePipeDef=c;var d;!function(b){function c(b,c,d,e,f){var g=d.desiredSize,h=c.availableSize;return a.Size.copyTo(e.layout(h,b),g),isFinite(h.width)||(g.width=Math.max(g.width,11)),g.width=Math.min(g.width,h.width),g.height=Math.min(g.height,h.height),!0}b.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("calcActualSize",d.calcActualSize).replaceTapin("calcExtents",d.calcExtents)}return __extends(b,a),b}(a.core.processup.ProcessUpPipeDef);b.TextBoxViewProcessUpPipeDef=c;var d;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=c.actualSize;return f.width=Number.POSITIVE_INFINITY,f.height=Number.POSITIVE_INFINITY,a.core.helpers.coerceSize(f,b),a.Size.copyTo(e.layout(f,b),f),!0}function d(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=d.extents;return f.x=f.y=0,a.Size.copyTo(c.actualSize,f),a.Rect.copyTo(f,d.extentsWithChildren),d.extentsWithChildren.width++,!0}b.calcActualSize=c,b.calcExtents=d}(d=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(){b.call(this),this.replaceTapin("doRender",d.doRender).addTapinAfter("doRender","calcCaretRegion",d.calcCaretRegion).addTapinAfter("calcCaretRegion","renderCaret",d.renderCaret)}return __extends(c,b),c.prototype.createOutput=function(){var c=b.prototype.createOutput.call(this);return c.caretRegion=new a.Rect,c},c.prototype.prepare=function(c,d,e){a.Rect.copyTo(c.caretRegion,e.caretRegion),b.prototype.prepare.call(this,c,d,e)},c.prototype.flush=function(c,d,e){b.prototype.flush.call(this,c,d,e),a.Rect.copyTo(e.caretRegion,c.caretRegion)},c}(a.core.render.RenderPipeDef);b.TextBoxViewRenderPipeDef=c;var d;!function(b){function c(b,c,d,e,f,g){return e.save(),a.core.helpers.renderLayoutClip(e,b,g),g.render(e,b),e.restore(),!0}function d(b,c,d,e,f,g){return!a.Rect.isEmpty(d.caretRegion)||b.selectionLength>0?!0:(a.Rect.copyTo(g.getCaretRegion(b),d.caretRegion),!0)}function e(a,b,c,d,e,f){if(!a.isCaretVisible||a.selectionLength>0)return!0;var e=c.caretRegion,g=a.caretBrush,h=d.raw;return h.beginPath(),h.moveTo(e.x+.5,e.y),h.lineTo(e.x+.5,e.y+e.height),h.lineWidth=1,g?(g.setupBrush(h,e),h.strokeStyle=g.toHtml5Object()):h.strokeStyle="#000000",h.stroke(),!0}b.doRender=c,b.calcCaretRegion=d,b.renderCaret=e}(d=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.textboxview||(b.textboxview={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.UserControlMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.UserControlArrangePipeDef)).setProcessDownPipe(a.singleton(c.processdown.UserControlProcessDownPipeDef));var d=this.assets;d.breakLayoutClip=!0,d.padding=new a.Thickness,d.borderThickness=new a.Thickness,b.prototype.init.call(this)},d}(b.control.ControlUpdater);c.UserControlUpdater=d}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("doOverride","preOverride",b.tapins.preOverride).replaceTapin("doOverride",b.tapins.doOverride)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.totalBorder=new a.Thickness,b},d}(a.core.arrange.ArrangePipeDef);b.UserControlArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){return e.subtree&&e.subtree.arrange(c.childRect),a.Size.copyTo(c.finalSize,c.arrangedSize),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(!e.subtree)return!0;var g=c.totalBorder;a.Thickness.copyTo(b.padding,g),a.Thickness.add(g,b.borderThickness);var h=c.childRect;return h.x=h.y=0,a.Size.copyTo(c.finalSize,h),a.Thickness.shrinkSize(g,h),!0}b.preOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.addTapinBefore("doOverride","preOverride",b.tapins.preOverride).replaceTapin("doOverride",b.tapins.doOverride).addTapinAfter("doOverride","postOverride",b.tapins.postOverride)}return __extends(d,c),d.prototype.createState=function(){var b=c.prototype.createState.call(this);return b.totalBorder=new a.Thickness,b},d}(a.core.measure.MeasurePipeDef);b.UserControlMeasurePipeDef=c}(c=b.measure||(b.measure={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=d.desiredSize,h=e.subtree;return h&&(h.measure(c.availableSize),a.Size.copyTo(h.assets.desiredSize,g)),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){return a.Thickness.growSize(c.totalBorder,d.desiredSize),a.Size.min(d.desiredSize,c.availableSize),!0}b.postOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.totalBorder;return a.Thickness.copyTo(b.padding,g),a.Thickness.add(g,b.borderThickness),a.Thickness.shrinkSize(g,c.availableSize),!0}b.preOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("processLayoutClip",d.processLayoutClip)}return __extends(b,a),b}(a.core.processdown.ProcessDownPipeDef);b.UserControlProcessDownPipeDef=c;var d;!function(b){function c(b,c,d,e,f){if(0===(b.dirtyFlags&a.DirtyFlags.LayoutClip))return!0;var g=b.compositeLayoutClip;return g.x=g.y=g.width=g.height,!0}b.processLayoutClip=c}(d=b.tapins||(b.tapins={}))}(c=b.processdown||(b.processdown={}))}(c=b.usercontrol||(b.usercontrol={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function c(){a.apply(this,arguments)}return __extends(c,a),c.prototype.init=function(){this.setTree(new b.VirtualizingPanelUpdaterTree),a.prototype.init.call(this)},c}(a.panel.PanelUpdater);b.VirtualizingPanelUpdater=c}(b=a.virtualizingpanel||(a.virtualizingpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){b.NO_CONTAINER_OWNER={itemCount:0,createGenerator:function(){return{current:void 0,generate:function(){return!1}}},remove:function(a,b){}};var c=function(a){function c(){a.apply(this,arguments),this.containerOwner=b.NO_CONTAINER_OWNER}return __extends(c,a),c}(a.panel.PanelUpdaterTree);b.VirtualizingPanelUpdaterTree=c}(b=a.virtualizingpanel||(a.virtualizingpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.VirtualizingStackPanelMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.VirtualizingStackPanelArrangePipeDef));var d=this.assets;d.orientation=a.Orientation.Vertical,d.scrollData={canHorizontallyScroll:!1,canVerticallyScroll:!1,offsetX:0,offsetY:0,cachedOffsetX:0,cachedOffsetY:0,viewportWidth:0,viewportHeight:0,extentWidth:0,extentHeight:0,maxDesiredWidth:0,maxDesiredHeight:0,invalidate:function(){}},b.prototype.init.call(this)},d}(b.virtualizingpanel.VirtualizingPanelUpdater);c.VirtualizingStackPanelUpdater=d}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doOverride",b.tapins.doOverride).addTapinAfter("doOverride","doHorizontal",b.tapins.doHorizontal).addTapinAfter("doOverride","doVertical",b.tapins.doVertical)}return __extends(c,a),c}(a.panel.arrange.PanelArrangePipeDef);b.VirtualizingStackPanelArrangePipeDef=c}(c=b.arrange||(b.arrange={}))}(b=a.virtualizingstackpanel||(a.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Horizontal)return!0;var g=c.finalSize,h=c.arrangedSize;h.width=0;for(var i,j,k=c.childRect,l=b.scrollData,m=e.walk();m.step();)i=m.current,j=i.assets.desiredSize,j.height=g.height,a.Size.copyTo(j,k),k.x=h.width,k.y=-l.offsetY,a.Rect.isEmpty(k)&&(k.x=k.y=k.width=k.height=0),i.arrange(k),h.width+=j.width,h.height=Math.max(h.height,j.height);return h.width=Math.max(h.width,g.width),!0}b.doHorizontal=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.childRect;return g.x=g.y=0,a.Size.copyTo(c.finalSize,g),a.Size.copyTo(c.finalSize,c.arrangedSize),!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Vertical)return!0;var g=c.finalSize,h=c.arrangedSize;h.height=0;for(var i,j,k=c.childRect,l=b.scrollData,m=e.walk();m.step();)i=m.current,j=i.assets.desiredSize,j.width=g.width,a.Size.copyTo(j,k),k.x=-l.offsetX,k.y=h.height,a.Rect.isEmpty(k)&&(k.x=k.y=k.width=k.height=0),i.arrange(k),h.width=Math.max(h.width,j.width),h.height+=j.height;return h.height=Math.max(h.height,g.height),!0}b.doVertical=c}(c=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function d(){b.call(this),this.replaceTapin("doOverride",c.tapins.doOverride).addTapinAfter("doOverride","doHorizontal",c.tapins.doHorizontal).addTapinAfter("doOverride","doVertical",c.tapins.doVertical)}return __extends(d,b),d.prototype.createState=function(){var c=b.prototype.createState.call(this);return c.childAvailable=new a.Size,c},d}(b.panel.measure.PanelMeasurePipeDef);c.VirtualizingStackPanelMeasurePipeDef=d}(d=c.measure||(c.measure={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Horizontal)return!0;var g=c.childAvailable,h=b.scrollData;h.canVerticallyScroll&&(g.height=Number.POSITIVE_INFINITY);var i=Math.floor(h.offsetX),j=e.containerOwner.itemCount;e.containerOwner.remove(0,i);for(var k=0,l=d.desiredSize,m=e.containerOwner.createGenerator(i,j);m.generate();){k++;var n=m.current;n.measure(g);var o=n.assets.desiredSize;if(l.height=Math.max(l.height,o.height),l.width+=o.width,l.width>g.width)break}e.containerOwner.remove(i+k,j-(i+k));var p=h.extentHeight!==l.height||h.extentWidth!==j||h.viewportHeight!==g.height||h.viewportWidth!==k;return h.extentHeight=l.height,h.extentWidth=j,h.viewportHeight=g.height,h.viewportWidth=k,p&&h.invalidate(),!0}b.doHorizontal=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){var g=c.childAvailable;a.Size.copyTo(c.availableSize,g);var h=d.desiredSize;return h.width=h.height=0,!0}b.doOverride=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){if(b.orientation!==a.Orientation.Vertical)return!0;var g=c.childAvailable,h=b.scrollData;h.canHorizontallyScroll&&(g.width=Number.POSITIVE_INFINITY);var i=Math.floor(h.offsetY),j=e.containerOwner.itemCount;e.containerOwner.remove(0,i);for(var k=0,l=d.desiredSize,m=e.containerOwner.createGenerator(i,j);m.generate();){k++;var n=m.current;n.measure(g);var o=n.assets.desiredSize;if(l.width=Math.max(l.width,o.width),l.height+=o.height,l.height>g.height)break}e.containerOwner.remove(i+k,j-(i+k));var p=h.extentHeight!==j||h.extentWidth!==l.width||h.viewportHeight!==k||h.viewportWidth!==g.width;return h.extentHeight=j,h.extentWidth=l.width,h.viewportHeight=k,h.viewportWidth=g.width,p&&h.invalidate(),!0}b.doVertical=c}(c=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.virtualizingstackpanel||(b.virtualizingstackpanel={}))}(b=a.controls||(a.controls={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c=null,d=null,e=function(){function e(){this.$$layout=new a.core.draft.DraftPipeDef,this.$$canvas=null,this.$$ctx=null,this.$$layers=[],this.$$downDirty=[],this.$$upDirty=[],this.$$dirtyRegion=null,this.$$width=0,this.$$height=0,this.$$sizechanged=!1}return Object.defineProperty(e.prototype,"width",{get:function(){return this.$$width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.$$height},enumerable:!0,configurable:!0}),e.prototype.init=function(b){this.$$canvas=b,this.$$ctx=new a.core.render.RenderContext(b.getContext("2d",{alpha:!1})),this.$$width=b.offsetWidth,this.$$height=b.offsetHeight},e.prototype.attachLayer=function(a,b){b===!0?this.$$layers.unshift(a):this.$$layers.push(a),a.tree.isTop=!0,a.invalidateMeasure(),a.fullInvalidate(),a.setSurface(this)},e.prototype.detachLayer=function(a){a.tree.isTop=!1,a.setSurface(null);var b=this.$$layers.indexOf(a);b>-1&&this.$$layers.splice(b,1),this.invalidate(a.assets.surfaceBoundsWithChildren)},e.prototype.walkLayers=function(a){var b=this.$$layers,c=-1;return a===!0?(c=b.length,{current:void 0,step:function(){return c--,this.current=b[c],void 0!==this.current}}):{current:void 0,step:function(){return c++,this.current=b[c],void 0!==this.current}}},e.prototype.updateBounds=function(){},e.prototype.invalidate=function(b){b=b||new a.Rect(0,0,this.$$canvas.offsetWidth,this.$$canvas.offsetHeight),this.$$dirtyRegion?a.Rect.union(this.$$dirtyRegion,b):this.$$dirtyRegion=new a.Rect(b.x,b.y,b.width,b.height)},e.prototype.render=function(){var b=this.$$dirtyRegion;if(b&&!a.Rect.isEmpty(b)){this.$$dirtyRegion=null,a.Rect.roundOut(b);var c=this.$$ctx;this.$$sizechanged&&(this.$$sizechanged=!1,c.resize(this.$$width,this.$$height)),c.raw.fillStyle="#ffffff",c.raw.fillRect(b.x,b.y,b.width,b.height),c.save(),c.clipRect(b);for(var d=this.$$layers,e=0,f=d.length;f>e;e++)d[e].render(c,b);c.restore()}},e.prototype.addUpDirty=function(a){this.$$upDirty.push(a)},e.prototype.addDownDirty=function(a){this.$$downDirty.push(a)},e.prototype.updateLayout=function(){for(var c={count:0,maxCount:250,updater:null,assets:null,tree:null,flag:a.UIFlags.None,measureList:[],arrangeList:[],sizingList:[],surfaceSize:new a.Size(this.$$width,this.$$height),sizingUpdates:[]},d=!1,e=!0;c.count<c.maxCount&&e;)e=b.draft(this.$$layers,this.$$layout,c),d=b.process(this.$$downDirty,this.$$upDirty)||e||d;return c.count>=c.maxCount&&console.error("[MINERVA] Aborting infinite update loop"),d},e.prototype.resize=function(b,c){this.$$width=b,this.$$height=c,this.$$sizechanged=!0,this.invalidate(new a.Rect(0,0,b,c));for(var d=this.$$layers,e=0;e<d.length;e++)d[e].invalidateMeasure()},e.prototype.hitTest=function(b){if(this.$$layers.length<1)return null;d=d||new a.core.render.RenderContext(document.createElement("canvas").getContext("2d")),d.resize(this.$$canvas.width,this.$$canvas.height);for(var c=[],e=this.$$layers,f=e.length-1;f>=0&&0===c.length;f--)e[f].hitTest(b,c,d,!1);return c},e.measureWidth=function(a,b){return c=c||document.createElement("canvas").getContext("2d"),c.font=b.toHtml5Object(),c.measureText(a).width},e}();b.Surface=e}(b=a.engine||(a.engine={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){function c(b,c,d){for(var e=!1,f=0,g=b.length;g>f;f++)if(d.updater=b[f],0!==(d.updater.assets.uiFlags&a.UIFlags.Hints))for(d.tree=d.updater.tree,d.assets=d.updater.assets;d.count<d.maxCount&&c.run(d);)e=!0,d.count++;return e}b.draft=c}(b=a.engine||(a.engine={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){function b(a,b){var e=a.length>0||b.length>0;return c(a),d(b),e}function c(a){for(var b;null!=(b=a[0]);)b.processDown()?a.shift():a.push(a.shift());a.length>0&&console.warn("[MINERVA] Finished DownDirty pass, not empty.")}function d(a){for(var b;null!=(b=a[0]);){var c=b.findChildInList(a);c>-1?a.splice(c+1,0,a.shift()):b.processUp()&&a.shift()}a.length>0&&console.warn("[MINERVA] Finished UpDirty pass, not empty.")}a.process=b}(b=a.engine||(a.engine={}))}(minerva||(minerva={}));var minerva;!function(a){function b(a,b){var c=a[0];if(Math.abs(c)<e)return null;var d=a[3];if(Math.abs(d)<e)return null;b?(b[1]=a[1],b[2]=a[2]):b=a;var f=-a[4],g=-a[5];return Math.abs(c-1)<e&&(c=1/c,f*=c),Math.abs(d-1)<e&&(d=1/d,g*=d),b[0]=c,b[3]=d,b[4]=f,b[5]=g,b}function c(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=c*f-d*e;if(0===g||!isFinite(g))return null;var h=1/g,i=a[4],j=a[5];return b[0]=f*h,b[1]=-d*h,b[2]=-e*h,b[3]=c*h,b[4]=(e*j-f*i)*h,b[5]=(d*i-c*j)*h,b}var d,e=1e-6;d="undefined"!=typeof Float32Array?function(a){return new Float32Array(a)}:function(a){return new Array(a)},a.mat3={create:function(a){var b=d(6);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=0,b},copyTo:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},init:function(a,b,c,d,e,f,g){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a},identity:function(b){return b||(b=a.mat3.create()),b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=0,b[5]=0,b},equal:function(a,b){return a===b||Math.abs(a[0]-b[0])<e&&Math.abs(a[1]-b[1])<e&&Math.abs(a[2]-b[2])<e&&Math.abs(a[3]-b[3])<e&&Math.abs(a[4]-b[4])<e&&Math.abs(a[5]-b[5])<e},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=b[0],k=b[1],l=b[2],m=b[3],n=b[4],o=b[5];return c[0]=d*j+e*l,c[1]=d*k+e*m,c[2]=f*j+g*l,c[3]=f*k+g*m,c[4]=h*j+i*l+n,c[5]=h*k+i*m+o,c},inverse:function(a,d){return Math.abs(a[1])<e&&Math.abs(a[2])<e?b(a,d):c(a,d)},transformVec2:function(a,b,c){c||(c=b);var d=b[0],e=b[1];return c[0]=a[0]*d+a[2]*e+a[4],c[1]=a[1]*d+a[3]*e+a[5],c},createTranslate:function(b,c,d){return d||(d=a.mat3.create()),d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=b,d[5]=c,d},translate:function(a,b,c){return a[4]+=b,a[5]+=c,a},createScale:function(b,c,d){return d||(d=a.mat3.create()),d[0]=b,d[1]=0,d[2]=0,d[3]=c,d[4]=0,d[5]=0,d},scale:function(a,b,c){return a[0]*=b,a[2]*=b,a[4]*=b,a[1]*=c,a[3]*=c,a[5]*=c,a},createRotate:function(b,c){c||(c=a.mat3.create());var d=Math.cos(b),e=Math.sin(b);return c[0]=d,c[1]=e,c[2]=-e,c[3]=d,c[4]=0,c[5]=0,c},createSkew:function(b,c,d){return d||(d=a.mat3.create()),d[0]=1,d[1]=Math.tan(c),d[2]=Math.tan(b),d[3]=1,d[4]=0,d[5]=0,d}}}(minerva||(minerva={}));var mat3=minerva.mat3,minerva;!function(a){var b;!function(a){a[a.M11=0]="M11",a[a.M12=1]="M12",a[a.M13=2]="M13",a[a.M14=3]="M14",a[a.M21=4]="M21",a[a.M22=5]="M22",a[a.M23=6]="M23",a[a.M24=7]="M24",a[a.M31=8]="M31",a[a.M32=9]="M32",a[a.M33=10]="M33",a[a.M34=11]="M34",a[a.OffsetX=12]="OffsetX",a[a.OffsetY=13]="OffsetY",a[a.OffsetZ=14]="OffsetZ",a[a.M44=15]="M44"}(b||(b={}));var c,d=1e-6;c="undefined"!=typeof Float32Array?function(a){return new Float32Array(a)}:function(a){return new Array(a)},a.mat4={create:function(a){var d=c(16);return a&&(d[b.M11]=a[b.M11],d[b.M12]=a[b.M12],d[b.M13]=a[b.M13],d[b.M14]=a[b.M14],d[b.M21]=a[b.M21],d[b.M22]=a[b.M22],d[b.M23]=a[b.M23],d[b.M24]=a[b.M24],d[b.M31]=a[b.M31],d[b.M32]=a[b.M32],d[b.M33]=a[b.M33],d[b.M34]=a[b.M34],d[b.OffsetX]=a[b.OffsetX],d[b.OffsetY]=a[b.OffsetY],d[b.OffsetZ]=a[b.OffsetZ],d[b.M44]=a[b.M44]),d},copyTo:function(a,c){return c[b.M11]=a[b.M11],c[b.M12]=a[b.M12],c[b.M13]=a[b.M13],c[b.M14]=a[b.M14],c[b.M21]=a[b.M21],c[b.M22]=a[b.M22],c[b.M23]=a[b.M23],c[b.M24]=a[b.M24],c[b.M31]=a[b.M31],c[b.M32]=a[b.M32],c[b.M33]=a[b.M33],c[b.M34]=a[b.M34],c[b.OffsetX]=a[b.OffsetX],c[b.OffsetY]=a[b.OffsetY],c[b.OffsetZ]=a[b.OffsetZ],c[b.M44]=a[b.M44],c},identity:function(c){return c||(c=a.mat4.create()),c[b.M11]=1,c[b.M12]=0,c[b.M13]=0,c[b.M14]=0,c[b.M21]=0,c[b.M22]=1,c[b.M23]=0,c[b.M24]=0,c[b.M31]=0,c[b.M32]=0,c[b.M33]=1,c[b.M34]=0,c[b.OffsetX]=0,c[b.OffsetY]=0,c[b.OffsetZ]=0,c[b.M44]=1,c},equal:function(a,c){return a===c||Math.abs(a[b.M11]-c[b.M11])<d&&Math.abs(a[b.M12]-c[b.M12])<d&&Math.abs(a[b.M13]-c[b.M13])<d&&Math.abs(a[b.M14]-c[b.M14])<d&&Math.abs(a[b.M21]-c[b.M21])<d&&Math.abs(a[b.M22]-c[b.M22])<d&&Math.abs(a[b.M23]-c[b.M23])<d&&Math.abs(a[b.M24]-c[b.M24])<d&&Math.abs(a[b.M31]-c[b.M31])<d&&Math.abs(a[b.M32]-c[b.M32])<d&&Math.abs(a[b.M33]-c[b.M33])<d&&Math.abs(a[b.M34]-c[b.M34])<d&&Math.abs(a[b.OffsetX]-c[b.OffsetX])<d&&Math.abs(a[b.OffsetY]-c[b.OffsetY])<d&&Math.abs(a[b.OffsetZ]-c[b.OffsetZ])<d&&Math.abs(a[b.M44]-c[b.M44])<d},multiply:function(a,c,d){d||(d=a);var e=a[b.M11],f=a[b.M12],g=a[b.M13],h=a[b.M14],i=a[b.M21],j=a[b.M22],k=a[b.M23],l=a[b.M24],m=a[b.M31],n=a[b.M32],o=a[b.M33],p=a[b.M34],q=a[b.OffsetX],r=a[b.OffsetY],s=a[b.OffsetZ],t=a[b.M44],u=c[b.M11],v=c[b.M12],w=c[b.M13],x=c[b.M14],y=c[b.M21],z=c[b.M22],A=c[b.M23],B=c[b.M24],C=c[b.M31],D=c[b.M32],E=c[b.M33],F=c[b.M34],G=c[b.OffsetX],H=c[b.OffsetY],I=c[b.OffsetZ],J=c[b.M44];return d[b.M11]=e*u+f*y+g*C+h*G,d[b.M12]=e*v+f*z+g*D+h*H,d[b.M13]=e*w+f*A+g*E+h*I,d[b.M14]=e*x+f*B+g*F+h*J,d[b.M21]=i*u+j*y+k*C+l*G,d[b.M22]=i*v+j*z+k*D+l*H,d[b.M23]=i*w+j*A+k*E+l*I,d[b.M24]=i*x+j*B+k*F+l*J,d[b.M31]=m*u+n*y+o*C+p*G,d[b.M32]=m*v+n*z+o*D+p*H,d[b.M33]=m*w+n*A+o*E+p*I,d[b.M34]=m*x+n*B+o*F+p*J,d[b.OffsetX]=q*u+r*y+s*C+t*G,d[b.OffsetY]=q*v+r*z+s*D+t*H,d[b.OffsetZ]=q*w+r*A+s*E+t*I,d[b.M44]=q*x+r*B+s*F+t*J,d},inverse:function(a,c){c||(c=a);var d=a[b.M11],e=a[b.M12],f=a[b.M13],g=a[b.M14],h=a[b.M21],i=a[b.M22],j=a[b.M23],k=a[b.M24],l=a[b.M31],m=a[b.M32],n=a[b.M33],o=a[b.M34],p=a[b.OffsetX],q=a[b.OffsetY],r=a[b.OffsetZ],s=a[b.M44],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,F=t*E-u*D+v*C+w*B-x*A+y*z;if(!isFinite(F)||!F)return null;var G=1/F;return c[b.M11]=(i*E-j*D+k*C)*G,c[b.M12]=(-e*E+f*D-g*C)*G,c[b.M13]=(q*y-r*x+s*w)*G,c[b.M14]=(-m*y+n*x-o*w)*G,c[b.M21]=(-h*E+j*B-k*A)*G,c[b.M22]=(d*E-f*B+g*A)*G,c[b.M23]=(-p*y+r*v-s*u)*G,c[b.M24]=(l*y-n*v+o*u)*G,c[b.M31]=(h*D-i*B+k*z)*G,c[b.M32]=(-d*D+e*B-g*z)*G,c[b.M33]=(p*x-q*v+s*t)*G,c[b.M34]=(-l*x+m*v-o*t)*G,c[b.OffsetX]=(-h*C+i*A-j*z)*G,c[b.OffsetY]=(d*C-e*A+f*z)*G,c[b.OffsetZ]=(-p*w+q*u-r*t)*G,c[b.M44]=(l*w-m*u+n*t)*G,c},transformVec4:function(a,c,d){d||(d=c);var e=c[0],f=c[1],g=c[2],h=c[3],i=a[b.M11],j=a[b.M12],k=a[b.M13],l=a[b.M14],m=a[b.M21],n=a[b.M22],o=a[b.M23],p=a[b.M24],q=a[b.M31],r=a[b.M32],s=a[b.M33],t=a[b.M34],u=a[b.OffsetX],v=a[b.OffsetY],w=a[b.OffsetZ],x=a[b.M44];return d[0]=i*e+j*f+k*g+l*h,d[1]=m*e+n*f+o*g+p*h,d[2]=q*e+r*f+s*g+t*h,d[3]=u*e+v*f+w*g+x*h,d},createTranslate:function(c,d,e,f){return f||(f=a.mat4.create()),f[b.M11]=1,f[b.M12]=0,f[b.M13]=0,f[b.M14]=0,f[b.M21]=0,f[b.M22]=1,f[b.M23]=0,f[b.M24]=0,f[b.M31]=0,f[b.M32]=0,f[b.M33]=1,f[b.M34]=0,f[b.OffsetX]=c,f[b.OffsetY]=d,f[b.OffsetZ]=e,f[b.M44]=1,f},createScale:function(c,d,e,f){return f||(f=a.mat4.create()),f[b.M11]=c,f[b.M12]=0,f[b.M13]=0,f[b.M14]=0,f[b.M11]=0,f[b.M12]=d,f[b.M13]=0,f[b.M14]=0,f[b.M31]=0,f[b.M32]=0,f[b.M33]=e,f[b.M34]=0,f[b.OffsetX]=0,f[b.OffsetY]=0,f[b.OffsetZ]=0,f[b.M44]=1,f},createRotateX:function(c,d){d||(d=a.mat4.create());var e=Math.sin(c),f=Math.cos(c);return d[b.M11]=1,d[b.M12]=0,d[b.M13]=0,d[b.M14]=0,d[b.M21]=0,d[b.M22]=f,d[b.M23]=e,d[b.M24]=0,d[b.M31]=0,d[b.M32]=-e,d[b.M33]=f,d[b.M34]=0,d[b.OffsetX]=0,d[b.OffsetY]=0,d[b.OffsetZ]=0,d[b.M44]=1,d},createRotateY:function(c,d){d||(d=a.mat4.create());var e=Math.sin(c),f=Math.cos(c);return d[b.M11]=f,d[b.M12]=0,d[b.M13]=-e,d[b.M14]=0,d[b.M21]=0,d[b.M22]=1,d[b.M23]=0,d[b.M24]=0,d[b.M31]=e,d[b.M32]=0,d[b.M33]=f,d[b.M34]=0,d[b.OffsetX]=0,d[b.OffsetY]=0,d[b.OffsetZ]=0,d[b.M44]=1,d},createRotateZ:function(c,d){d||(d=a.mat4.create());var e=Math.sin(c),f=Math.cos(c);return d[b.M11]=f,d[b.M12]=e,d[b.M13]=0,d[b.M14]=0,d[b.M21]=-e,d[b.M22]=f,d[b.M23]=0,d[b.M24]=0,d[b.M31]=0,d[b.M32]=0,d[b.M33]=1,d[b.M34]=0,d[b.OffsetX]=0,d[b.OffsetY]=0,d[b.OffsetZ]=0,d[b.M44]=1,d},createPerspective:function(c,d,e,f,g){g||(g=a.mat4.create());var h=1/Math.tan(c/2),i=h/d,j=e-f;return g[b.M11]=i,g[b.M12]=0,g[b.M13]=0,g[b.M14]=0,g[b.M21]=0,g[b.M22]=h,g[b.M23]=0,g[b.M24]=0,g[b.M31]=0,g[b.M32]=0,g[b.M33]=f/j,g[b.M34]=-1,g[b.OffsetX]=0,g[b.OffsetY]=0,g[b.OffsetZ]=e*f/j,g[b.M44]=0,g},createViewport:function(c,d,e){return e||(e=a.mat4.create()),e[b.M11]=c/2,e[b.M12]=0,e[b.M13]=0,e[b.M14]=0,e[b.M21]=0,e[b.M22]=-d/2,e[b.M23]=0,e[b.M24]=0,e[b.M31]=0,e[b.M32]=0,e[b.M33]=1,e[b.M34]=0,e[b.OffsetX]=c/2,e[b.OffsetY]=d/2,e[b.OffsetZ]=0,e[b.M44]=1,e}}}(minerva||(minerva={}));var mat4=minerva.mat4,minerva;!function(a){a.Rect.transform4=function(a,b){console.warn("[Rect.transform4] Not implemented")}}(minerva||(minerva={}));var minerva;!function(a){var b;b="undefined"!=typeof Float32Array?function(a){return new Float32Array(a)}:function(a){return new Array(a)},a.vec4={create:function(a,c,d,e){var f=b(4);return f[0]=a,f[1]=c,f[2]=d,f[3]=e,f},init:function(a,c,d,e,f){return f||(f=b(4)),f[0]=a,f[1]=c,f[2]=d,f[3]=e,f}}}(minerva||(minerva={}));var vec4=minerva.vec4,minerva;!function(a){var b;!function(b){function c(b,c,d){var e,f=d.strokeThickness/2,g=d.strokeStartLineCap||d.strokeEndLineCap||0;switch(g){case a.PenLineCap.Round:b.l=Math.min(b.l,c.sx-f),b.r=Math.max(b.r,c.sx+f),b.t=Math.min(b.t,c.sy-f),b.b=Math.max(b.b,c.sy+f);break;case a.PenLineCap.Square:if(!(e=c.getStartVector()))return;if(!e[0]||!e[1])return;var h=a.Vector.reverse(a.Vector.normalize(e.slice(0))),i=a.Vector.orthogonal(h.slice(0)),j=c.sx+f*(h[0]+i[0]),k=c.sx+f*(h[0]-i[0]),l=c.sy+f*(h[1]+i[1]),m=c.sy+f*(h[1]-i[1]);b.l=Math.min(b.l,j,k),b.r=Math.max(b.r,j,k),b.t=Math.min(b.t,l,m),b.b=Math.max(b.b,l,m);break;case a.PenLineCap.Flat:default:if(!(e=c.getStartVector()))return;if(!e[0]||!e[1])return;var i=a.Vector.orthogonal(a.Vector.normalize(e.slice(0))),j=c.sx+f*i[0],k=c.sx+f*-i[0],l=c.sy+f*i[1],m=c.sy+f*-i[1];b.l=Math.min(b.l,j,k),b.r=Math.max(b.r,j,k),b.t=Math.min(b.t,l,m),b.b=Math.max(b.b,l,m)}}function d(b,c,d){var e,f=c.ex,g=c.ey,h=d.strokeThickness/2,i=d.strokeStartLineCap||d.strokeEndLineCap||0;switch(i){case a.PenLineCap.Round:b.l=Math.min(b.l,f-h),b.r=Math.max(b.r,f+h),b.t=Math.min(b.t,g-h),b.b=Math.max(b.b,g+h);break;case a.PenLineCap.Square:if(!(e=c.getEndVector()))return;var j=a.Vector.normalize(e.slice(0)),k=a.Vector.orthogonal(j.slice(0)),l=f+h*(j[0]+k[0]),m=f+h*(j[0]-k[0]),n=g+h*(j[1]+k[1]),o=g+h*(j[1]-k[1]);b.l=Math.min(b.l,l,m),b.r=Math.max(b.r,l,m),b.t=Math.min(b.t,n,o),b.b=Math.max(b.b,n,o);break;case a.PenLineCap.Flat:default:if(!(e=c.getEndVector()))return;var k=a.Vector.orthogonal(a.Vector.normalize(e.slice(0))),l=f+h*k[0],m=f+h*-k[0],n=g+h*k[1],o=g+h*-k[1];b.l=Math.min(b.l,l,m),b.r=Math.max(b.r,l,m),b.t=Math.min(b.t,n,o),b.b=Math.max(b.b,n,o)}}function e(b,c,d,e){var f=e.strokeThickness/2;e.strokeLineJoin===a.PenLineJoin.Round&&(b.l=Math.min(b.l,d.sx-f),b.r=Math.max(b.r,d.sx+f),b.t=Math.min(b.t,d.sy-f),b.b=Math.max(b.b,d.sy+f));var i=e.strokeLineJoin===a.PenLineJoin.Miter?g(c,d,f,e.strokeMiterLimit):h(c,d,f);if(i){var j=i[0].x,k=i[1].x,l=i[0].y,m=i[1].y;b.l=Math.min(b.l,j,k),b.r=Math.max(b.r,j,k),b.t=Math.min(b.t,l,m),b.b=Math.max(b.b,l,m)}}function f(a,b,f){function g(b,d){b.sx=j,b.sy=k,b.isSingle||(!b.isMove&&n&&(l=b.sx,m=b.sy,c(a,b,f)),!n&&d>0&&e(a,i,b,f)),b.extendStrokeBox(a,f),j=b.ex||0,k=b.ey||0,n=!!b.isMove,i=b}for(var h=b.length,i=null,j=null,k=null,l=null,m=null,n=!1,o=0;h>o;o++)g(b[o],o);var p=b[h-1];p&&!p.isSingle&&d(a,p,f)}function g(b,c,d,e){var f=c.sx,g=c.sy,i=b.getEndVector(),j=c.getStartVector();if(!i||!j)return null;a.Vector.reverse(i);var k=a.Vector.angleBetween(i,j)/2;if(isNaN(k))return null;var l=1/Math.sin(k);if(l>e)return h(b,c,d);var m=a.Vector.isClockwiseTo(i,j)?i.slice(0):j.slice(0);a.Vector.normalize(a.Vector.reverse(a.Vector.rotate(m,k)));var n=d*l,o={x:f+n*m[0],y:g+n*m[1]};return[o,o]}function h(b,c,d){var e=c.sx,f=c.sy,g=b.getEndVector(),h=c.getStartVector();if(g&&h){
a.Vector.normalize(a.Vector.reverse(g)),a.Vector.normalize(h);var i,j;return a.Vector.isClockwiseTo(g,h)?(i=a.Vector.orthogonal(g.slice(0)),j=a.Vector.reverse(a.Vector.orthogonal(h.slice(0)))):(i=a.Vector.reverse(a.Vector.orthogonal(g.slice(0))),j=a.Vector.orthogonal(h.slice(0))),[{x:e-d*i[0],y:f-d*i[1]},{x:e-d*j[0],y:f-d*j[1]}]}}var i=function(){function c(){this.$$entries=[],this.$$endX=0,this.$$endY=0}return Object.defineProperty(c.prototype,"endX",{get:function(){return this.$$endX},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"endY",{get:function(){return this.$$endY},enumerable:!0,configurable:!0}),c.prototype.reset=function(){this.$$entries.length=0,this.$$endX=0,this.$$endY=0},c.prototype.move=function(a,c){this.$$entries.push(b.segments.move(a,c)),this.$$endX=a,this.$$endY=c},c.prototype.line=function(a,c){this.$$entries.push(b.segments.line(a,c)),this.$$endX=a,this.$$endY=c},c.prototype.quadraticBezier=function(a,c,d,e){this.$$entries.push(b.segments.quadraticBezier(a,c,d,e)),this.$$endX=d,this.$$endY=e},c.prototype.cubicBezier=function(a,c,d,e,f,g){this.$$entries.push(b.segments.cubicBezier(a,c,d,e,f,g)),this.$$endX=f,this.$$endY=g},c.prototype.ellipse=function(a,c,d,e){this.$$entries.push(b.segments.ellipse(a,c,d,e)),this.$$endX=a,this.$$endY=c},c.prototype.ellipticalArc=function(a,c,d,e,f,g,h){this.$$entries.push(b.segments.ellipticalArc(a,c,d,e,f,g,h)),this.$$endX=g,this.$$endY=h},c.prototype.arc=function(a,c,d,e,f,g){this.$$entries.push(b.segments.arc(a,c,d,e,f,g))},c.prototype.arcTo=function(a,c,d,e,f){var g=b.segments.arcTo(a,c,d,e,f);this.$$entries.push(g),this.$$endX=g.ex,this.$$endY=g.ey},c.prototype.rect=function(a,c,d,e){this.$$entries.push(b.segments.rect(a,c,d,e))},c.prototype.roundedRect=function(a,c,d,e,f,g){this.$$entries.push(b.segments.roundedRect(a,c,d,e,f,g)),this.$$endX=a,this.$$endY=c},c.prototype.close=function(){this.$$entries.push(b.segments.close())},c.prototype.draw=function(a){a.beginPath();for(var b=this.$$entries,c=b.length,d=0;c>d;d++)b[d].draw(a)},c.prototype.calcBounds=function(b){if(this.$$entries.length<=0)return new a.Rect;var c=b&&b.strokeThickness>1?this.$$calcStrokeBox(b):this.$$calcFillBox();return new a.Rect(c.l,c.t,Math.max(0,c.r-c.l),Math.max(0,c.b-c.t))},c.prototype.$$calcFillBox=function(){for(var a,b=this.$$entries,c=b.length,d={l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY},e=null,f=null,g=0;c>g;g++)a=b[g],a.sx=e,a.sy=f,a.extendFillBox(d),e=a.ex||0,f=a.ey||0;return d},c.prototype.$$calcStrokeBox=function(a){var b={l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY};return f(b,this.$$entries,a),b},c.Merge=function(a,b){a.$$entries.push.apply(a.$$entries,b.$$entries),a.$$endX+=b.$$endX,a.$$endY+=b.$$endY},c.prototype.Serialize=function(){for(var a=this.$$entries,b=a.length,c="",d=0;b>d;d++)d>0&&(c+=" "),c+=a[d].toString();return c},c}();b.Path=i,b.findMiterTips=g,b.findBevelTips=h}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){function c(a,b,c,f,g,h){function i(){v||(j=a+c*Math.cos(f),k=b+c*Math.sin(f),l=a+c*Math.cos(g),m=b+c*Math.sin(g),n=a-c,r=d(j,k,l,m,n,b,h),o=a+c,s=d(j,k,l,m,o,b,h),p=b-c,t=d(j,k,l,m,a,p,h),q=b+c,u=d(j,k,l,m,a,q,h),v=!0)}var j,k,l,m,n,o,p,q,r,s,t,u,v=!1;return{sx:null,sy:null,isSingle:!0,x:a,y:b,ex:a,ey:b,radius:c,sAngle:f,eAngle:g,aClockwise:h,draw:function(d){d.arc(a,b,c,f,g,h)},extendFillBox:function(a){g!==f&&(i(),this.ex=l,this.ey=m,a.l=Math.min(a.l,j,l),a.r=Math.max(a.r,j,l),a.t=Math.min(a.t,k,m),a.b=Math.max(a.b,k,m),r&&(a.l=Math.min(a.l,n)),s&&(a.r=Math.max(a.r,o)),t&&(a.t=Math.min(a.t,p)),u&&(a.b=Math.max(a.b,q)))},extendStrokeBox:function(a,b){if(g!==f){i(),this.ex=l,this.ey=m,a.l=Math.min(a.l,j,l),a.r=Math.max(a.r,j,l),a.t=Math.min(a.t,k,m),a.b=Math.max(a.b,k,m);var c=b.strokeThickness/2;r&&(a.l=Math.min(a.l,n-c)),s&&(a.r=Math.max(a.r,o+c)),t&&(a.t=Math.min(a.t,p-c)),u&&(a.b=Math.max(a.b,q+c));var d=b.strokeStartLineCap||b.strokeEndLineCap||0,h=this.getStartVector();h[0]=-h[0],h[1]=-h[1];var v=e(j,k,b.strokeThickness,d,h),w=this.getEndVector(),x=e(l,m,b.strokeThickness,d,w);a.l=Math.min(a.l,v.x1,v.x2,x.x1,x.x2),a.r=Math.max(a.r,v.x1,v.x2,x.x1,x.x2),a.t=Math.min(a.t,v.y1,v.y2,x.y1,x.y2),a.b=Math.max(a.b,v.y1,v.y2,x.y1,x.y2)}},toString:function(){return""},getStartVector:function(){var c=[j-a,k-b];return h?[c[1],-c[0]]:[-c[1],c[0]]},getEndVector:function(){var c=[l-a,m-b];return h?[c[1],-c[0]]:[-c[1],c[0]]}}}function d(a,b,c,d,e,f,g){var h=(c-a)*(f-b)-(e-a)*(d-b);return 0===h?!0:h>0&&g?!0:0>h&&!g?!0:!1}function e(b,c,d,e,h){var i=d/2;switch(e){case a.PenLineCap.Round:return{x1:b-i,x2:b+i,y1:c-i,y2:c+i};case a.PenLineCap.Square:var j=f(h),k=g(j);return{x1:b+i*(j[0]+k[0]),x2:b+i*(j[0]-k[0]),y1:c+i*(j[1]+k[1]),y2:c+i*(j[1]-k[1])};case a.PenLineCap.Flat:default:var j=f(h),k=g(j);return{x1:b+i*k[0],x2:b+i*-k[0],y1:c+i*k[1],y2:c+i*-k[1]}}}function f(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return[a[0]/b,a[1]/b]}function g(a){return[-a[1],a[0]]}b.arc=c}(c=b.segments||(b.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){function c(c,f,g,h,i){function j(j,n){if(!m){if(k&&l)return l;var o=[c-j,f-n],p=[g-c,h-f],q=Math.PI-a.Vector.angleBetween(o,p),r=d(q,i,[j,n],o,!0),s=d(q,i,[c,f],p,!1),t=e(r,o,s,p),u=!a.Vector.isClockwiseTo(o,p),v=Math.atan2(r[1]-t[1],r[0]-t[0]);0>v&&(v=2*Math.PI+v);var w=Math.atan2(s[1]-t[1],s[0]-t[0]);0>w&&(w=2*Math.PI+w),k=b.line(r[0],r[1]),k.sx=j,k.sy=n,l=b.arc(t[0],t[1],i,v,w,u),m=!0}}var k,l,m=!1;return{sx:null,sy:null,isSingle:!1,cpx:c,cpy:f,x:g,y:h,ex:g,ey:h,radius:i,draw:function(a){a.arcTo(c,f,g,h,i)},extendFillBox:function(a){j(this.sx,this.sy),this.ex=l.ex,this.ey=l.ey,a.l=Math.min(a.l,this.sx),a.r=Math.max(a.r,this.sx),a.t=Math.min(a.t,this.sy),a.b=Math.max(a.b,this.sy),k.extendFillBox(a),l.extendFillBox(a)},extendStrokeBox:function(a,b){j(this.sx,this.sy),this.ex=l.ex,this.ey=l.ey;var c=b.strokeThickness/2;a.l=Math.min(a.l,this.sx-c),a.r=Math.max(a.r,this.sx+c),a.t=Math.min(a.t,this.sy-c),a.b=Math.max(a.b,this.sy+c),k.extendStrokeBox(a,b),l.extendStrokeBox(a,b)},toString:function(){return""},getStartVector:function(){return j(this.sx,this.sy),k.getStartVector()},getEndVector:function(){return l.getEndVector()}}}function d(a,b,c,d,e){var f=Math.sqrt(d[0]*d[0]+d[1]*d[1]),g=b/Math.tan(a/2),h=g/f;return e&&(h=1-h),[c[0]+h*d[0],c[1]+h*d[1]]}function e(b,c,d,e){return a.Vector.intersection(b,a.Vector.orthogonal(c.slice(0)),d,a.Vector.orthogonal(e.slice(0)))}b.arcTo=c}(c=b.segments||(b.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(){return{sx:null,sy:null,ex:null,ey:null,isSingle:!1,isClose:!0,draw:function(a){a.closePath()},extendFillBox:function(a){},extendStrokeBox:function(a,b){},toString:function(){return"Z"},getStartVector:function(){return null},getEndVector:function(){return null}}}a.close=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b,d,e,f,g){return{sx:null,sy:null,ex:f,ey:g,isSingle:!1,cp1x:a,cp1y:b,cp2x:d,cp2y:e,x:f,y:g,draw:function(c){c.bezierCurveTo(a,b,d,e,f,g)},extendFillBox:function(h){var i=c(this.sx,a,d,f,this.sy,b,e,g);null!=i.x[0]&&(h.l=Math.min(h.l,i.x[0]),h.r=Math.max(h.r,i.x[0])),null!=i.x[1]&&(h.l=Math.min(h.l,i.x[1]),h.r=Math.max(h.r,i.x[1])),null!=i.y[0]&&(h.t=Math.min(h.t,i.y[0]),h.b=Math.max(h.b,i.y[0])),null!=i.y[1]&&(h.t=Math.min(h.t,i.y[1]),h.b=Math.max(h.b,i.y[1])),h.l=Math.min(h.l,f),h.r=Math.max(h.r,f),h.t=Math.min(h.t,g),h.b=Math.max(h.b,g)},extendStrokeBox:function(h,i){var j=i.strokeThickness/2,k=c(this.sx,a,d,f,this.sy,b,e,g);null!=k.x[0]&&(h.l=Math.min(h.l,k.x[0]-j),h.r=Math.max(h.r,k.x[0]+j)),null!=k.x[1]&&(h.l=Math.min(h.l,k.x[1]-j),h.r=Math.max(h.r,k.x[1]+j)),null!=k.y[0]&&(h.t=Math.min(h.t,k.y[0]-j),h.b=Math.max(h.b,k.y[0]+j)),null!=k.y[1]&&(h.t=Math.min(h.t,k.y[1]-j),h.b=Math.max(h.b,k.y[1]+j)),h.l=Math.min(h.l,f),h.r=Math.max(h.r,f),h.t=Math.min(h.t,g),h.b=Math.max(h.b,g)},toString:function(){return"C"+a.toString()+","+b.toString()+" "+d.toString()+","+e.toString()+" "+f.toString()+","+g.toString()},getStartVector:function(){return[3*(a-this.sx),3*(b-this.sy)]},getEndVector:function(){return[3*(f-d),3*(g-e)]}}}function c(a,b,c,e,f,g,h,i){return{x:d(a,b,c,e),y:d(f,g,h,i)}}function d(a,b,c,d){var e=2*a-4*b+2*c,f=b-a,g=-a+3*b+d-3*c,h=Math.sqrt(e*e-4*f*g),i=[null,null];if(isNaN(h))return i;var j,k;return j=(-e+h)/(2*g),j>=0&&1>=j&&(k=1-j,i[0]=a*k*k*k+3*b*j*k*k+3*c*k*j*j+d*j*j*j),j=(-e-h)/(2*g),j>=0&&1>=j&&(k=1-j,i[1]=a*k*k*k+3*b*j*k*k+3*c*k*j*j+d*j*j*j),i}a.cubicBezier=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){var e=c/2,f=d/2,g=a+c,h=b+d,i=a+e,j=b+f;return{sx:null,sy:null,ex:a,ey:b,isSingle:!0,x:a,y:b,width:c,height:d,draw:function(k){if(k.beginPath(),c===d)return void k.arc(i,j,e,0,2*Math.PI,!1);var l=.5522848,m=e*l,n=f*l;k.moveTo(a,j),k.bezierCurveTo(a,j-n,i-m,b,i,b),k.bezierCurveTo(i+m,b,g,j-n,g,j),k.bezierCurveTo(g,j+n,i+m,h,i,h),k.bezierCurveTo(i-m,h,a,j+n,a,j),k.closePath()},extendFillBox:function(e){e.l=Math.min(e.l,a),e.r=Math.max(e.r,a+c),e.t=Math.min(e.t,b),e.b=Math.max(e.b,b+d)},extendStrokeBox:function(e,f){var g=f.strokeThickness/2;e.l=Math.min(e.l,a-g),e.r=Math.max(e.r,a+c+g),e.t=Math.min(e.t,b-g),e.b=Math.max(e.b,b+d+g)},getStartVector:function(){return null},getEndVector:function(){return null}}}a.ellipse=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){function c(a,b,c,e,f,g,h){return{sx:null,sy:null,isSingle:!1,rx:a,ry:b,rotationAngle:c,isLargeArcFlag:e,sweepDirectionFlag:f,ex:g,ey:h,sub:null,draw:function(a){this.sub=this.sub||d(this);for(var b=0,c=this.sub,e=c.length;e>b;b++)c[b].draw(a)},extendFillBox:function(a){this.sub=this.sub||d(this);for(var b=0,c=this.sub,e=c.length;e>b;b++)c[b].extendFillBox(a)},extendStrokeBox:function(a,b){this.sub=this.sub||d(this);for(var c=0,e=this.sub,f=e.length;f>c;c++)e[c].extendStrokeBox(a,b)},toString:function(){return"A"+a.toString()+","+b.toString()+" "+c.toString()+" "+e.toString()+" "+f.toString()+" "+g.toString()+","+h.toString()},getStartVector:function(){this.sub=this.sub||d(this);var a=this.sub[0];return a?a.getStartVector():[0,0]},getEndVector:function(){this.sub=this.sub||d(this);var a=this.sub[this.sub.length-1];return a?a.getEndVector():[0,0]}}}function d(c){var d=[],h=c.sx,i=c.sy,j=c.ex,k=c.ey,l=c.rx,m=c.ry;if(Math.abs(j-h)<e&&Math.abs(k-i)<e)return d;if(Math.abs(l)<f||Math.abs(m)<f)return d.push(b.line(j,k)),d;if(Math.abs(l)<g||Math.abs(m)<g)return d;l=Math.abs(l),m=Math.abs(m);var n=c.rotationAngle*Math.PI/180,o=Math.cos(n),p=Math.sin(n),q=(h-j)/2,r=(i-k)/2,s=o*q+p*r,t=o*r-p*q,u=s*s,v=t*t,w=l*l,x=m*m,y=u/w+v/x;if(y>1){var z=Math.sqrt(y);l*=z,m*=z,w=l*l,x=m*m}var A,B,C,D,E=w*x-w*v-x*u,F=c.isLargeArcFlag===!0,G=c.sweepDirectionFlag===a.SweepDirection.Clockwise;if(0>E){var H=Math.sqrt(1-E/(w*x));l*=H,m*=H,w=l*l,x=m*m,A=0,B=0,C=0,D=0}else E=Math.sqrt(E/(w*v+x*u)),F===G&&(E=-E),A=E*(l*t/m),B=E*(-m*s/l),C=o*A-p*B,D=p*A+o*B;C+=(h+j)/2,D+=(i+k)/2;var I=Math.atan2((t-B)/m,(s-A)/l),J=0>I?2*Math.PI+I:I,K=Math.atan2((-t-B)/m,(-s-A)/l),L=I>K?2*Math.PI-I+K:K-I;G?0>L&&(L+=2*Math.PI):L>0&&(L-=2*Math.PI);for(var M=Math.floor(Math.abs(L/(Math.PI/2)))+1,N=L/M,O=4/3*(1-Math.cos(N/2))/Math.sin(N/2),P=o*l,Q=o*m,R=p*l,S=p*m,T=Math.cos(J),U=Math.sin(J),V=0;M>V;++V){var W=J+N,X=Math.cos(W),Y=Math.sin(W),Z=h-O*(P*U+S*T),$=i+O*(Q*T-R*U),_=C+(P*X-S*Y),aa=D+(R*X+Q*Y),ba=_+O*(P*Y+S*X),ca=aa+O*(R*Y-Q*X);d.push(b.cubicBezier(Z,$,ba,ca,_,aa)),h=_,i=aa,J=W,T=X,U=Y}return d}b.ellipticalArc=c;var e=2e-6,f=19e-6,g=117e-6}(c=b.segments||(b.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return{isSingle:!1,sx:null,sy:null,x:a,y:b,ex:a,ey:b,draw:function(c){c.lineTo(a,b)},extendFillBox:function(c){c.l=Math.min(c.l,a),c.r=Math.max(c.r,a),c.t=Math.min(c.t,b),c.b=Math.max(c.b,b)},extendStrokeBox:function(a,b){this.extendFillBox(a)},toString:function(){return"L"+a.toString()+","+b.toString()},getStartVector:function(){return[a-this.sx,b-this.sy]},getEndVector:function(){return[a-this.sx,b-this.sy]}}}a.line=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return{sx:null,sy:null,ex:a,ey:b,isSingle:!1,isMove:!0,x:a,y:b,draw:function(c){c.moveTo(a,b)},extendFillBox:function(c){c.l=Math.min(c.l,a),c.r=Math.max(c.r,a),c.t=Math.min(c.t,b),c.b=Math.max(c.b,b)},extendStrokeBox:function(a,b){this.extendFillBox(a)},toString:function(){return"M"+a.toString()+","+b.toString()},getStartVector:function(){return null},getEndVector:function(){return null}}}a.move=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b,d,e){return{sx:null,sy:null,ex:d,ey:e,isSingle:!1,cpx:a,cpy:b,x:d,y:e,draw:function(c){c.quadraticCurveTo(a,b,d,e)},extendFillBox:function(f){var g=c(this.sx,a,d,this.sy,b,e);null!=g.x&&(f.l=Math.min(f.l,g.x),f.r=Math.max(f.r,g.x)),null!=g.y&&(f.t=Math.min(f.t,g.y),f.b=Math.max(f.b,g.y)),f.l=Math.min(f.l,d),f.r=Math.max(f.r,d),f.t=Math.min(f.t,e),f.b=Math.max(f.b,e)},extendStrokeBox:function(f,g){var h=g.strokeThickness/2,i=c(this.sx,a,d,this.sy,b,e);i.x&&(f.l=Math.min(f.l,i.x-h),f.r=Math.max(f.r,i.x+h)),i.y&&(f.t=Math.min(f.t,i.y-h),f.b=Math.max(f.b,i.y+h)),f.l=Math.min(f.l,d),f.r=Math.max(f.r,d),f.t=Math.min(f.t,e),f.b=Math.max(f.b,e)},toString:function(){return"Q"+a.toString()+","+b.toString()+" "+d.toString()+","+e.toString()},getStartVector:function(){return[2*(a-this.sx),2*(b-this.sy)]},getEndVector:function(){return[2*(d-a),2*(e-b)]}}}function c(a,b,c,e,f,g){return{x:d(a,b,c),y:d(e,f,g)}}function d(a,b,c){var d=(a-b)/(a-2*b+c);return 0>d||d>1?null:a*Math.pow(1-d,2)+2*b*(1-d)*d+c*Math.pow(d,2)}a.quadraticBezier=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return{sx:null,sy:null,isSingle:!0,x:a,y:b,ex:a,ey:b,width:c,height:d,draw:function(e){e.rect(a,b,c,d)},extendFillBox:function(e){e.l=Math.min(e.l,a),e.r=Math.max(e.r,a+c),e.t=Math.min(e.t,b),e.b=Math.max(e.b,b+d)},extendStrokeBox:function(e,f){var g=f.strokeThickness/2;e.l=Math.min(e.l,a-g),e.r=Math.max(e.r,a+c+g),e.t=Math.min(e.t,b-g),e.b=Math.max(e.b,b+d+g)},getStartVector:function(){return null},getEndVector:function(){return null}}}a.rect=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){function b(b,c,d,e,f,g){if(0===f&&0===g)return a.rect(b,c,d,e);var h=b,i=c,j=b+d,k=c+e;return{sx:null,sy:null,ex:b,ey:c,isSingle:!0,x:b,y:c,width:d,height:e,radiusX:f,radiusY:g,draw:function(a){a.beginPath(),a.moveTo(h+f,i),a.lineTo(j-f,i),a.quadraticCurveTo(j,i,j,i+g),a.lineTo(j,k-g),a.quadraticCurveTo(j,k,j-f,k),a.lineTo(h+f,k),a.quadraticCurveTo(h,k,h,k-g),a.lineTo(h,i+g),a.quadraticCurveTo(h,i,h+f,i),a.closePath()},extendFillBox:function(a){a.l=Math.min(a.l,b),a.r=Math.max(a.r,b+d),a.t=Math.min(a.t,c),a.b=Math.max(a.b,c+e)},extendStrokeBox:function(a,f){var g=f.strokeThickness/2;a.l=Math.min(a.l,b-g),a.r=Math.max(a.r,b+d+g),a.t=Math.min(a.t,c-g),a.b=Math.max(a.b,c+e+g)},getStartVector:function(){return null},getEndVector:function(){return null}}}a.roundedRect=b}(b=a.segments||(a.segments={}))}(b=a.path||(a.path={}))}(minerva||(minerva={})),function(a){a.perfex||(a.perfex={}),a.perfex.timer||(a.perfex.timer={all:[],reset:function(){},start:function(a){},stop:function(){}}),a.perfex.phases||(a.perfex.phases={current:null,all:[],start:function(a){}})}(window);var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.init=function(){this.setMeasurePipe(a.singleton(b.measure.ShapeMeasurePipeDef)).setArrangePipe(a.singleton(b.arrange.ShapeArrangePipeDef)).setRenderPipe(a.singleton(b.render.ShapeRenderPipeDef)).setProcessUpPipe(a.singleton(b.processup.ShapeProcessUpPipeDef)).setHitTestPipe(a.singleton(b.hittest.ShapeHitTestPipeDef));var d=this.assets;d.naturalBounds=new a.Rect,d.shapeFlags=a.ShapeFlags.None,d.shapeRect=new a.Rect,d.fill=null,d.stretch=a.Stretch.None,d.stroke=null,d.strokeThickness=1,d.strokeDashArray=[],d.strokeDashCap=a.PenLineCap.Flat,d.strokeDashOffset=0,d.strokeStartLineCap=a.PenLineCap.Flat,d.strokeEndLineCap=a.PenLineCap.Flat,d.strokeLineJoin=a.PenLineJoin.Miter,d.strokeMiterLimit=10,c.prototype.init.call(this)},d.prototype.invalidateNaturalBounds=function(){var a=this.assets.naturalBounds;a.x=a.y=a.width=a.height=0,this.invalidateMeasure(),this.updateBounds(!0)},d}(a.core.Updater);b.ShapeUpdater=c}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setRenderPipe(a.singleton(c.render.EllipseRenderPipeDef)).setHitTestPipe(a.singleton(c.hittest.EllipseHitTestPipeDef));var d=this.assets;d.stretch=a.Stretch.Fill,b.prototype.init.call(this)},d}(b.shape.ShapeUpdater);c.EllipseUpdater=d}(c=b.ellipse||(b.ellipse={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){var f=d/2,g=e/2,h=b+d,i=c+e,j=b+f,k=c+g;if(a.beginPath(),d===e)return void a.arc(j,k,f,0,2*Math.PI,!1);var l=.5522848,m=f*l,n=g*l;a.moveTo(b,k),a.bezierCurveTo(b,k-n,j-m,c,j,c),a.bezierCurveTo(j+m,c,h,k-n,h,k),a.bezierCurveTo(h,k+n,j+m,i,j,i),a.bezierCurveTo(j-m,i,b,k+n,b,k),a.closePath()}a.draw=b}(b=a.helpers||(a.helpers={}))}(b=a.ellipse||(a.ellipse={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("canHitInside",b.tapins.canHitInside).replaceTapin("insideChildren",b.tapins.insideChildren).addTapinAfter("insideObject","canHitShape",b.tapins.canHitShape).addTapinAfter("canHitShape","prepareShape",b.tapins.prepareShape).addTapinAfter("prepareShape","drawShape",b.tapins.drawShape).addTapinAfter("drawShape","finishShape",b.tapins.finishShape)}return __extends(c,a),c}(a.core.hittest.HitTestPipeDef);b.ShapeHitTestPipeDef=c}(c=b.hittest||(b.hittest={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(a){function b(){a.call(this),this.replaceTapin("drawShape",e.drawShape)}return __extends(b,a),b}(a.shape.hittest.ShapeHitTestPipeDef);c.EllipseHitTestPipeDef=d;var e;!function(a){function c(a,c,d,e){var f=a.assets.shapeRect;return b.helpers.draw(e.raw,f.x,f.y,f.width,f.height),!0}a.drawShape=c}(e=c.tapins||(c.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.ellipse||(a.ellipse={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.addTapinBefore("doRender","calcShouldDraw",b.tapins.calcShouldDraw).addTapinBefore("doRender","prepareDraw",b.tapins.prepareDraw).replaceTapin("doRender",b.tapins.doRender).addTapinAfter("doRender","fill",b.tapins.fill).addTapinAfter("fill","finishDraw",b.tapins.finishDraw).addTapinAfter("finishDraw","stroke",b.tapins.stroke)}return __extends(c,a),c.prototype.createState=function(){var b=a.prototype.createState.call(this);return b.shouldDraw=!1,b},c}(a.core.render.RenderPipeDef);b.ShapeRenderPipeDef=c}(c=b.render||(b.render={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(a){function b(){a.call(this),this.replaceTapin("doRender",e.doRender)}return __extends(b,a),b}(a.shape.render.ShapeRenderPipeDef);c.EllipseRenderPipeDef=d;var e;!function(a){function c(a,c,d,e,f){if(!c.shouldDraw)return!0;var g=a.shapeRect;return b.helpers.draw(e.raw,g.x,g.y,g.width,g.height),!0}a.doRender=c}(e=c.tapins||(c.tapins={}))}(c=b.render||(b.render={}))}(b=a.ellipse||(a.ellipse={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.PathMeasurePipeDef)).setArrangePipe(a.singleton(c.arrange.PathArrangePipeDef)).setRenderPipe(a.singleton(c.render.PathRenderPipeDef)).setHitTestPipe(a.singleton(c.hittest.PathHitTestPipeDef));var d=this.assets;d.stretch=a.Stretch.None,d.stretchXform=a.mat3.identity(),b.prototype.init.call(this)},d}(b.shape.ShapeUpdater);c.PathUpdater=d}(c=b.path||(b.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(d){function e(){d.apply(this,arguments)}return __extends(e,d),e.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.LineMeasurePipeDef));var e=this.assets;e.x1=0,e.y1=0,e.x2=0,e.y2=0,e.data=new b.path.AnonPathGeometry,d.prototype.init.call(this)},e.prototype.invalidatePath=function(){this.assets.data.old=!0,this.invalidateNaturalBounds()},e}(b.path.PathUpdater);c.LineUpdater=d}(c=b.line||(b.line={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(){b.call(this),this.addTapinBefore("doOverride","calcNaturalBounds",d.calcNaturalBounds).replaceTapin("doOverride",d.doOverride)}return __extends(c,b),c.prototype.createOutput=function(){var c=b.prototype.createOutput.call(this);return c.naturalBounds=new a.Rect,c},c.prototype.prepare=function(c,d,e){a.Rect.copyTo(c.naturalBounds,e.naturalBounds),b.prototype.prepare.call(this,c,d,e)},c.prototype.flush=function(c,d,e){b.prototype.flush.call(this,c,d,e),a.Rect.copyTo(e.naturalBounds,c.naturalBounds)},c}(a.core.measure.MeasurePipeDef);b.ShapeMeasurePipeDef=c;var d;!function(a){function b(a,b,c,d){var e=c.naturalBounds;return e.x=e.y=0,e.width=e.height=1,!0}function c(a,b,c,d){var e=c.desiredSize;return e.width=e.height=0,!0}a.calcNaturalBounds=b,a.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(a){function b(){a.call(this),this.addTapinBefore("calcNaturalBounds","buildPath",e.buildPath).replaceTapin("calcNaturalBounds",e.calcNaturalBounds).addTapinAfter("doOverride","adjustNoStretchDesired",e.adjustNoStretchDesired)}return __extends(b,a),b}(b.shape.measure.ShapeMeasurePipeDef);c.PathMeasurePipeDef=d;var e;!function(b){function c(a,b,c,d){return!0}function d(b,c,d,e){var f=d.naturalBounds;if(f.x=f.y=f.width=f.height=0,b.data){var g=b.data.GetBounds(b);a.Rect.copyTo(g,f)}return!0}function e(b,c,d,e){if(b.stretch===a.Stretch.None){var f=d.naturalBounds,g=d.desiredSize;g.width=f.width+Math.max(0,f.x),g.height=f.height+Math.max(0,f.y)}return!0}b.buildPath=c,b.calcNaturalBounds=d,b.adjustNoStretchDesired=e}(e=c.tapins||(c.tapins={}))}(d=c.measure||(c.measure={}))}(c=b.path||(b.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("buildPath",d.buildPath)}return __extends(b,a),b}(a.path.measure.PathMeasurePipeDef);b.LineMeasurePipeDef=c;var d;!function(a){function b(a,b,c,d){if(!a.data.old)return!0;var e=a.data.path;return e.reset(),e.move(a.x1,a.y1),e.line(a.x2,a.y2),a.data.old=!1,!0}a.buildPath=b}(d=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.line||(a.line={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(){this.old=!0,this.path=new a.path.Path,this.fillRule=a.FillRule.EvenOdd}return b.prototype.Draw=function(a){this.path.draw(a.raw)},b.prototype.GetBounds=function(a){return this.path.calcBounds(a)},b}();b.AnonPathGeometry=c}(c=b.path||(b.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("doOverride",d.doOverride)}return __extends(b,a),b}(a.core.arrange.ArrangePipeDef);b.ShapeArrangePipeDef=c;var d;!function(b){function c(b,c,d,e){var f,g,h=b.naturalBounds,i=c.finalSize;switch(b.stretch){case a.Stretch.None:f=g=0;break;default:case a.Stretch.Fill:f=i.width/h.width,g=i.height/h.height;break;case a.Stretch.Uniform:f=g=Math.min(i.width/h.width,i.height/h.height);break;case a.Stretch.UniformToFill:f=g=Math.max(i.width/h.width,i.height/h.height)}var j=c.arrangedSize;return j.width=h.width*f||0,j.height=h.height*g||0,!0}b.doOverride=c}(d=b.tapins||(b.tapins={}))}(c=b.arrange||(b.arrange={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d;!function(c){var d=function(b){function c(){b.call(this),this.addTapinAfter("doOverride","adjustNoStretchArranged",e.adjustNoStretchArranged).addTapinAfter("buildRenderSize","buildStretchXform",e.buildStretchXform)}return __extends(c,b),c.prototype.createOutput=function(){var c=b.prototype.createOutput.call(this);return c.stretchXform=a.mat3.identity(),c},c.prototype.prepare=function(c,d,e){a.mat3.copyTo(c.stretchXform,e.stretchXform),b.prototype.prepare.call(this,c,d,e)},c.prototype.flush=function(c,d,e){b.prototype.flush.call(this,c,d,e),a.mat3.copyTo(e.stretchXform,c.stretchXform)},c}(b.shape.arrange.ShapeArrangePipeDef);c.PathArrangePipeDef=d;var e;!function(b){function c(b,c,d,e){if(b.stretch===a.Stretch.None){var f=b.naturalBounds,g=c.arrangedSize;g.width=f.width+Math.max(0,f.x),g.height=f.height+Math.max(0,f.y)}return!0}function d(b,c,d,e){if(b.stretch===a.Stretch.None)return!0;var f=d.stretchXform,g=b.naturalBounds,h=d.renderSize;return a.mat3.createTranslate(-g.x,-g.y,f),a.mat3.scale(f,h.width/g.width,h.height/g.height),!0}b.adjustNoStretchArranged=c,b.buildStretchXform=d}(e=c.tapins||(c.tapins={}))}(d=c.arrange||(c.arrange={}))}(c=b.path||(b.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("drawShape",d.drawShape)}return __extends(b,a),b}(a.shape.hittest.ShapeHitTestPipeDef);b.PathHitTestPipeDef=c;var d;!function(a){function b(a,b,c,d){var e=a.assets;return d.pretransformMatrix(e.stretchXform),e.data.Draw(d),!0}a.drawShape=b}(d=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.path||(a.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function c(){a.call(this),this.replaceTapin("doRender",b.tapins.doRender).replaceTapin("fill",b.tapins.fill)}return __extends(c,a),c}(a.shape.render.ShapeRenderPipeDef);b.PathRenderPipeDef=c}(c=b.render||(b.render={}))}(b=a.path||(a.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return b.shouldDraw?(d.pretransformMatrix(a.stretchXform),a.data.Draw(d),!0):!0}a.doRender=b}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.path||(a.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){return c.shouldDraw?(b.fill&&e.fillEx(b.fill,b.shapeRect,b.data?b.data.fillRule:a.FillRule.EvenOdd),!0):!0}b.fill=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.path||(b.path={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(d){function e(){d.apply(this,arguments)}return __extends(e,d),e.prototype.init=function(){this.setMeasurePipe(a.singleton(c.measure.PolylineMeasurePipeDef));var e=this.assets;e.data=new b.path.AnonPathGeometry,e.isClosed=!1,d.prototype.init.call(this)},e.prototype.invalidateFillRule=function(){this.assets.data.fillRule=this.assets.fillRule,this.invalidate()},e.prototype.invalidatePath=function(){this.assets.data.old=!0,this.invalidateNaturalBounds()},e}(b.path.PathUpdater);c.PolylineUpdater=d}(c=b.polyline||(b.polyline={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(){a.prototype.init.call(this),this.assets.isClosed=!0},b}(a.polyline.PolylineUpdater);b.PolygonUpdater=c}(b=a.polygon||(a.polygon={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(b){var c=function(a){function b(){a.call(this),this.replaceTapin("buildPath",d.buildPath)}return __extends(b,a),b}(a.path.measure.PathMeasurePipeDef);b.PolylineMeasurePipeDef=c;var d;!function(a){function b(a,b,d,e){if(!a.data.old)return!0;var f=a.data.path;f.reset();var g=a.points;if(g.length<2)return!0;var h=g[0],i=g[1];if(2===g.length)c(h,i,a.strokeThickness),f.move(h.x,h.y),f.line(i.x,i.y);else{f.move(h.x,h.y);for(var j=1;j<g.length;j++){var i=g[j];f.line(i.x,i.y)}}return a.isClosed&&f.close(),a.data.old=!1,!0}function c(a,b,c){var d=5*c,e=a.x-b.x,f=a.y-b.y;if(0===f)d-=c/2,e>0?(a.x+=d,b.x-=d):(a.x-=d,b.x+=d);else if(0===e)d-=c/2,f>0?(a.y+=d,b.y-=d):(a.y-=d,b.y+=d);else{var g=Math.atan2(f,e),h=Math.abs(Math.sin(g)*d);e>0?(a.x+=h,b.x-=h):(a.x-=h,b.x+=h);var i=Math.abs(Math.sin(Math.PI/2-g))*d;f>0?(a.y+=i,b.y-=i):(a.y-=i,b.y+=i)}}a.buildPath=b}(d=b.tapins||(b.tapins={}))}(c=b.measure||(b.measure={}))}(b=a.polyline||(a.polyline={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(b){function d(){b.apply(this,arguments)}return __extends(d,b),d.prototype.init=function(){this.setRenderPipe(a.singleton(c.render.RectangleRenderPipeDef)).setHitTestPipe(a.singleton(c.hittest.RectangleHitTestPipeDef));var d=this.assets;d.stretch=a.Stretch.Fill,d.radiusX=0,d.radiusY=0,b.prototype.init.call(this)},d}(b.shape.ShapeUpdater);c.RectangleUpdater=d}(c=b.rectangle||(b.rectangle={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e,f,g){var h=b+d,i=c+e;return f||g?(a.beginPath(),a.moveTo(b+f,c),a.lineTo(h-f,c),a.quadraticCurveTo(h,c,h,c+g),a.lineTo(h,i-g),a.quadraticCurveTo(h,i,h-f,i),a.lineTo(b+f,i),a.quadraticCurveTo(b,i,b,i-g),a.lineTo(b,c+g),a.quadraticCurveTo(b,c,b+f,c),void a.closePath()):(a.beginPath(),void a.rect(b,c,h-b,i-c))}a.draw=b}(b=a.helpers||(a.helpers={}))}(b=a.rectangle||(a.rectangle={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(a){function b(){a.call(this),this.replaceTapin("drawShape",e.drawShape);
}return __extends(b,a),b}(a.shape.hittest.ShapeHitTestPipeDef);c.RectangleHitTestPipeDef=d;var e;!function(a){function c(a,c,d,e){var f=a.assets,g=f.shapeRect,h=Math.min(Math.abs(f.radiusX),g.width/2);isNaN(h)&&(h=0);var i=Math.min(Math.abs(f.radiusY),g.height/2);return isNaN(i)&&(i=0),b.helpers.draw(e.raw,g.x,g.y,g.width,g.height,h,i),!0}a.drawShape=c}(e=c.tapins||(c.tapins={}))}(c=b.hittest||(b.hittest={}))}(b=a.rectangle||(a.rectangle={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(a){function b(){a.call(this),this.replaceTapin("doRender",e.doRender)}return __extends(b,a),b}(a.shape.render.ShapeRenderPipeDef);c.RectangleRenderPipeDef=d;var e;!function(a){function c(a,c,d,e,f){if(!c.shouldDraw)return!0;var g=a.shapeRect,h=Math.min(Math.abs(a.radiusX),g.width/2);isNaN(h)&&(h=0);var i=Math.min(Math.abs(a.radiusY),g.height/2);return isNaN(i)&&(i=0),b.helpers.draw(e.raw,g.x,g.y,g.width,g.height,h,i),!0}a.doRender=c}(e=c.tapins||(c.tapins={}))}(c=b.render||(b.render={}))}(b=a.rectangle||(a.rectangle={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return a.assets.fill||a.assets.stroke?!0:(c.shift(),d.restore(),!1)}a.canHitInside=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){return(b.assets.shapeFlags&a.ShapeFlags.Empty)===a.ShapeFlags.Empty?(d.shift(),e.restore(),!1):!0}b.canHitShape=c}(c=b.tapins||(b.tapins={}))}(c=b.hittest||(b.hittest={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return!0}a.drawShape=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){var e=a.assets,f=!!e.fill&&d.raw.isPointInPath(b.x,b.y)||!!e.stroke&&d.isPointInStrokeEx(e,b.x,b.y);return d.restore(),f?!0:(c.shift(),d.restore(),!1)}a.finishShape=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return c.unshift(a.updater),a.hitChildren=!1,!0}a.insideChildren=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d){return d.save(),!0}a.prepareShape=b}(b=a.tapins||(a.tapins={}))}(b=a.hittest||(a.hittest={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(c){function d(){c.call(this),this.replaceTapin("calcExtents",b.tapins.calcExtents).addTapinAfter("calcExtents","calcShapeRect",b.tapins.calcShapeRect)}return __extends(d,c),d.prototype.createOutput=function(){var b=c.prototype.createOutput.call(this);return b.shapeFlags=a.ShapeFlags.None,b.shapeRect=new a.Rect,b},d.prototype.prepare=function(b,d,e){e.shapeFlags=b.shapeFlags,a.Rect.copyTo(b.shapeRect,e.shapeRect),c.prototype.prepare.call(this,b,d,e)},d.prototype.flush=function(b,d,e){c.prototype.flush.call(this,b,d,e),a.Rect.copyTo(e.shapeRect,b.shapeRect),b.shapeFlags=e.shapeFlags},d}(a.core.processup.ProcessUpPipeDef);b.ShapeProcessUpPipeDef=c}(c=b.processup||(b.processup={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=d.extents,g=d.extentsWithChildren;f.x=g.x=0,f.y=g.y=0;var h=c.actualSize;return f.width=g.width=h.width,f.height=g.height=h.height,!0}b.calcExtents=c}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e){if(0===(b.dirtyFlags&a.DirtyFlags.Bounds))return!0;var f=d.shapeRect;if(a.Rect.copyTo(d.extents,f),d.shapeFlags=a.ShapeFlags.Empty,a.Rect.isEmpty(f))return!0;var g=b.stroke?b.strokeThickness:0;g>=f.width||g>=f.height?(f.width=Math.max(f.width,g+.001*g),f.height=Math.max(f.height,g+.001*g),d.shapeFlags=a.ShapeFlags.Degenerate):d.shapeFlags=a.ShapeFlags.Normal;var h=g/2;return a.Rect.shrink(f,h,h,h,h),!0}b.calcShapeRect=c}(c=b.tapins||(b.tapins={}))}(c=b.processup||(b.processup={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f){return c.shouldDraw=!1,b.shapeFlags===a.ShapeFlags.Empty?!0:b.fill||b.stroke?(c.shouldDraw=!0,!0):!0}b.calcShouldDraw=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return b.shouldDraw?!0:!0}a.doRender=b}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return b.shouldDraw?(a.fill&&d.fillEx(a.fill,a.shapeRect,a.fillRule),!0):!0}a.fill=b}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c,d,e){return b.shouldDraw?(d.restore(),!0):!0}a.finishDraw=b}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){function c(b,c,d,e,f,g){return c.shouldDraw?(e.save(),a.core.helpers.renderLayoutClip(e,b,g),!0):!0}b.prepareDraw=c}(c=b.tapins||(b.tapins={}))}(c=b.render||(b.render={}))}(c=b.shape||(b.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a,b,e,f,g){if(!b.shouldDraw)return!0;var h=a.stroke;if(!(h&&a.strokeThickness>0))return!0;var i=f.raw;return i.lineWidth=a.strokeThickness,i.lineCap=c[a.strokeStartLineCap||a.strokeEndLineCap||0]||c[0],i.lineJoin=d[a.strokeLineJoin||0]||d[0],i.miterLimit=a.strokeMiterLimit,h.setupBrush(i,a.shapeRect),i.strokeStyle=h.toHtml5Object(),i.stroke(),!0}var c=["butt","square","round","butt"],d=["miter","bevel","round"];a.stroke=b}(b=a.tapins||(a.tapins={}))}(b=a.render||(a.render={}))}(b=a.shape||(a.shape={}))}(b=a.shapes||(a.shapes={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){function c(a){return isFinite(a.availableWidth)?a.availableWidth:isFinite(a.maxWidth)?Math.min(a.actualWidth,a.maxWidth):a.actualWidth}var d=function(){function d(){}return d.prototype.createAssets=function(){return{availableWidth:Number.POSITIVE_INFINITY,actualWidth:NaN,actualHeight:NaN,maxWidth:Number.POSITIVE_INFINITY,maxHeight:Number.POSITIVE_INFINITY,lines:[],selCached:!1}},d.prototype.layout=function(a,b,c,d){if(!isNaN(b.actualWidth))return!1;b.maxWidth=c.width,b.actualWidth=0,b.actualHeight=0,b.lines=[];for(var e=0;d.step();)e+=d.current.layout(a,b);return!0},d.prototype.render=function(a,c,d){var e=this;this.splitSelection(c,d),a.save(),d.lines.forEach(function(f){var g=e.getHorizontalAlignmentX(c,d,f.width);a.translate(g,0),f.runs.forEach(function(c){c.pre&&(b.layout.Cluster.render(c.pre,c.attrs,a),a.translate(c.pre.width,0)),c.sel&&(b.layout.Cluster.render(c.sel,c.attrs,a),a.translate(c.sel.width,0)),c.post&&(b.layout.Cluster.render(c.post,c.attrs,a),a.translate(c.post.width,0))}),a.translate(-f.width-g,f.height)}),a.restore()},d.prototype.getCursorFromPoint=function(a,b,c){var d=c.lines[0];if(!d)return 0;var e=0;if(a.y>0)for(var f=0,g=c.lines,h=0,i=g.length;i>h&&(d=g[h],!(a.y<=f+d.height));h++)e+=d.runs.reduce(function(a,b){return a+b.length},0),f+=d.height;var j=a.x-this.getHorizontalAlignmentX(b,c,d.width);if(0>j)return e;for(var k=0,h=0,l=d.runs,i=l.length;i>h;h++){var m=l[h];if(j<=k+m.width)break;e+=m.length,k+=m.width}var m=l[h];if(!m)return e;for(var n,o=Math.max(0,Math.min(m.text.length,Math.ceil((j-k)/m.width*m.text.length))),p=m.text.substr(0,o);o>0&&(n=this.measureTextWidth(p,m.attrs.font))>j;)o--,p=m.text.substr(0,o);for(var q=o;o<m.text.length&&(n=this.measureTextWidth(p,m.attrs.font))<j;)q=o,o++,p=m.text.substr(0,o);return e+q},d.prototype.getCaretFromCursor=function(b,c){for(var d=b.selectionStart,e=0,f=new a.Rect(0,0,1,0),g=0,h=c.lines,i=0,j=h.length;j>i;i++){var k=h[i];f.x=this.getHorizontalAlignmentX(b,c,k.width),f.height=k.height;for(var l=k.runs,m=0,n=l.length;n>m;m++){var o=l[m];if(e+o.length>d)return f.x+=this.measureTextWidth(o.text.substr(0,d-e),o.attrs.font),f;e+=o.length,f.x+=k.width}f.y+=k.height,g=k.height}return f.y-=g,f},d.prototype.splitSelection=function(a,c){var d=this;if(!c.selCached){var e=a.selectionStart;c.lines.forEach(function(c){return c.runs.forEach(function(c){b.layout.Run.splitSelection(c,e,e+a.selectionLength,function(a,b){return d.measureTextWidth(a,b.font)}),e-=c.length})}),c.selCached=!0}},d.prototype.getHorizontalAlignmentX=function(b,d,e){if(b.textAlignment===a.TextAlignment.Left||b.textAlignment===a.TextAlignment.Justify)return 0;var f=c(d);return e>=f?0:b.textAlignment===a.TextAlignment.Center?(f-e)/2:f-e},d.prototype.measureTextWidth=function(b,c){return a.engine.Surface.measureWidth(b,c)},d}();b.DocumentLayoutDef=d}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){function b(a){return{def:a,assets:a.createAssets()}}a.createDocumentLayout=b}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c=function(){function c(){this.assets={fontFamily:a.Font.DEFAULT_FAMILY,fontSize:a.Font.DEFAULT_SIZE,fontStretch:a.Font.DEFAULT_STRETCH,fontStyle:a.Font.DEFAULT_STYLE,fontWeight:a.Font.DEFAULT_WEIGHT,textDecorations:a.TextDecorations.None,language:"",background:null,selectionBackground:null,foreground:null,selectionForeground:null,isUnderlined:!1,font:new a.Font,text:""},this.init()}return c.prototype.init=function(){this.setTextLayout()},c.prototype.setTextLayout=function(a){return this.$$textlayout?this:(this.$$textlayout=a||new b.run.RunLayoutDef,this)},c.prototype.layout=function(a,b){return this.$$textlayout.layout(a,b,this.assets),this.assets.text.length},c.prototype.invalidateFont=function(){var b=this.assets;return a.Font.mergeInto(b.font,b.fontFamily,b.fontSize,b.fontStretch,b.fontStyle,b.fontWeight)},c}();b.TextUpdater=c}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(b){var c=/firefox/i.test(navigator.userAgent),d=function(){function b(){this.isSelected=!1,this.text=null,this.width=0}return b.render=function(d,e,f){var g=e.font.getHeight(),h=new a.Rect(0,0,d.width,g),i=f.raw,j=d.isSelected?e.selectionBackground||b.DEFAULT_SELECTION_BG:e.background;j&&(i.beginPath(),i.rect(h.x,h.y,h.width,h.height),f.fillEx(j,h));var k=d.isSelected?e.selectionForeground||b.DEFAULT_SELECTION_FG:e.foreground,l="#000000";k&&(k.setupBrush(i,h),l=k.toHtml5Object()),i.fillStyle=l,i.font=e.font.toHtml5Object(),i.textAlign="left",c?(i.textBaseline="bottom",i.fillText(d.text,0,g)):(i.textBaseline="top",i.fillText(d.text,0,0)),e.isUnderlined&&(i.beginPath(),i.moveTo(0,g),i.lineTo(d.width,g),i.lineWidth=2,i.strokeStyle=l,i.stroke())},b.DEFAULT_SELECTION_BG=new a.FakeBrush("#444444"),b.DEFAULT_SELECTION_FG=new a.FakeBrush("#FFFFFF"),b}();b.Cluster=d}(c=b.layout||(b.layout={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.runs=[],this.width=0,this.height=0}return a.getLineFromY=function(a,b){for(var c,d=0,e=0;d<a.length;d++)if(c=a[d],e+=c.height,e>b)return c;return a[a.length-1]},a}();a.Line=b}(b=a.layout||(a.layout={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(){this.text="",this.start=0,this.length=0,this.width=0}return b.splitSelection=function(b,c,d,e){b.pre=b.sel=b.post=null;var f=b.start,g=f+b.length,h=Math.min(b.length,Math.max(0,c-f));if(h>0){var i=b.pre=new a.Cluster;i.text=b.text.substr(0,h),i.width=e(i.text,b.attrs)}var j=Math.min(b.length,Math.max(0,g-d));if(j>0){var k=b.post=new a.Cluster;k.text=b.text.substr(b.length-j),k.width=e(k.text,b.attrs)}var l=Math.min(g,Math.max(f,c)),m=Math.max(f,Math.min(g,d)),n=Math.max(0,m-l);if(n>0){var o=b.sel=new a.Cluster;o.isSelected=!0,o.text=b.text.substr(l-f,n),o.width=e(o.text,b.attrs)}},b}();a.Run=b}(b=a.layout||(a.layout={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){var d=function(){function d(){}return d.prototype.layout=function(d,e,f){var g=f.text;if(!g){var h=new b.layout.Line;h.height=f.font.getHeight(),e.lines.push(h);var i=new b.layout.Run;return i.attrs=f,h.runs.push(i),e.actualHeight=h.height,!1}return d.textWrapping===a.TextWrapping.NoWrap?c.doLayoutNoWrap(d,e,f):c.doLayoutWrap(d,e,f),e.selCached=!1,!0},d}();c.RunLayoutDef=d}(c=b.run||(b.run={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){function d(a,c,d){var f={text:d.text,index:0,max:d.text.length},g=d.font,h=new b.layout.Line;h.height=g.getHeight(),c.actualHeight+=h.height,c.lines.push(h);var i=new b.layout.Run;for(i.attrs=d,h.runs.push(i);f.index<f.max;){var j=e(i,f,g);j&&(c.actualWidth=Math.max(c.actualWidth,i.width),h.width=i.width,h=new b.layout.Line,h.height=g.getHeight(),c.actualHeight+=h.height,c.lines.push(h),i=new b.layout.Run,i.attrs=d,h.runs.push(i))}h.width=i.width,c.actualWidth=Math.max(c.actualWidth,i.width)}function e(a,b,c){var d=b.text.substr(b.index),e=d.indexOf("\r"),g=d.indexOf("\n");return 0>e&&0>g?(a.length=d.length,a.text=d,a.width=f(a.text,c),b.index+=a.length,!1):e>-1&&e+1===g?(a.length=g+1,a.text=d.substr(0,a.length),a.width=f(a.text,c),b.index+=a.length,!0):e>-1&&g>e?(a.length=e+1,a.text=d.substr(0,a.length),a.width=f(a.text,c),b.index+=a.length,!0):(a.length=g+1,a.text=d.substr(0,a.length),a.width=f(a.text,c),b.index+=a.length,!0)}function f(b,c){return a.engine.Surface.measureWidth(b,c)}c.doLayoutNoWrap=d}(c=b.run||(b.run={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));var minerva;!function(a){var b;!function(b){var c;!function(c){function d(a,c,d){var g={text:d.text,index:0,max:d.text.length},h=d.font,i=new b.layout.Line;i.height=h.getHeight(),c.actualHeight+=i.height,c.lines.push(i);var j=new b.layout.Run;for(j.attrs=d,i.runs.push(j);g.index<g.max;){var k=isFinite(c.maxWidth)?f(j,g,h,c.maxWidth):e(j,g,h);k&&(c.actualWidth=Math.max(c.actualWidth,j.width),i.width=j.width,i=new b.layout.Line,i.height=h.getHeight(),c.actualHeight+=i.height,c.lines.push(i),j=new b.layout.Run,j.attrs=d,i.runs.push(j))}i.width=j.width,c.actualWidth=Math.max(c.actualWidth,j.width)}function e(a,b,c){var d=b.text.substr(b.index),e=d.indexOf("\r"),f=d.indexOf("\n");return 0>e&&0>f?(a.length=d.length,a.text=d,a.width=g(a.text,c),b.index+=a.length,!1):e>-1&&e+1===f?(a.length=f+1,a.text=d.substr(0,a.length),a.width=g(a.text,c),b.index+=a.length,!0):e>-1&&f>e?(a.length=e+1,a.text=d.substr(0,a.length),a.width=g(a.text,c),b.index+=a.length,!0):(a.length=f+1,a.text=d.substr(0,a.length),a.width=g(a.text,c),b.index+=a.length,!0)}function f(a,b,c,d){for(var e,f=b.text,h=b.index,i=-1,j="",k=0;b.index<b.max;){if(e=f.charAt(b.index),j+=e,k=g(j,c),"\n"===e)return a.length=b.index-h+1,a.text=f.substr(h,a.length),a.width=g(a.text,c),b.index++,!0;if("\r"===e)return a.length=b.index-h+1,b.index++,"\n"===f.charAt(b.index)&&(a.length++,b.index++),a.text=f.substr(h,a.length),a.width=g(a.text,c),!0;if(k>d){var l=i>-1?i+1:b.index;return a.length=l-h||1,a.text=f.substr(h,a.length),a.width=g(a.text,c),b.index=l,!0}" "===e&&(i=b.index),b.index++}return a.text=f.substr(h),a.length=a.text.length,a.width=g(a.text,c),!1}function g(b,c){return a.engine.Surface.measureWidth(b,c)}c.doLayoutWrap=d}(c=b.run||(b.run={}))}(b=a.text||(a.text={}))}(minerva||(minerva={}));
//# sourceMappingURL=minerva.min.js.map